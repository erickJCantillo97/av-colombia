import{al as I,am as M,C as H,d as k,af as W,o as i,c as U,w,a as e,k as j,u as f,v as z,f as u,F as O,i as T,t as l,b as d,h as F,g as _,W as q,T as Q,A as P}from"./app-1PjsTmNv.js";import{s as X}from"./index-CuOo237z.js";import{s as Y}from"./index-BaSfU4OQ.js";import{s as R}from"./index-ggGxE-RV.js";import{S as E,a as Z}from"./toasts-CuGasqAw.js";import{a as L,_ as A}from"./Modal-MRESf2Tk.js";import{_ as ee}from"./logo-BdNSUA__.js";import{_ as te}from"./Loading-CPTXhmSh.js";const se={class:"p-2"},oe={class:"mb-4 flex flex-col"},le={class:"grid grid-cols-5 border-y items-center border text-right gap-x-4"},ne={class:"col-span-1"},ae={class:"col-span-1 text-nowrap truncate"},ie={class:"col-span-1"},re={class:"col-span-1"},de=["onUpdate:modelValue"],ue={class:"flex justify-end p-6 space-x-4"},ce={__name:"ServiceCancel",props:I({service:Object},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const $=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}),v=M(o,"modelValue"),c=o,b=H({date:"",proveedors:[]}),x=k([]);W(()=>{x.value=c.service.proveedors.map(r=>{var s=r.proveedor;return{proveedor_id:r.id,concept:s.concept,proveedor:r,pasajeros:c.service.adults,cost:r.cost,proveedor_name:s.proveedor.nombre,costo_penalidad:s.proveedor.type_penalidad_cost=="Porcentaje"?s.proveedor.penalidad_cancelacion/100*r.cost:s.proveedor.penalidad_cancelacion*c.service.adults}})});const C=()=>{b.proveedors=x.value,b.post(route("cancelar.servicio",c.service.id),{onSuccess:()=>{v.value=!1,console.log("Cancelado")}})};return(r,s)=>{const g=R;return i(),U(L,{title:`Cancelar Servicio ${o.service.service}`,modelValue:v.value,"onUpdate:modelValue":s[2]||(s[2]=a=>v.value=a),width:"70vw",onClose:s[3]||(s[3]=a=>v.value=!1),"close-on-escape":""},{default:w(()=>[e("div",se,[e("div",oe,[s[4]||(s[4]=e("label",{for:"",class:"font-bold"},"Fecha de Cancelaci贸n",-1)),j(e("input",{label:"Fecha de Cancelaci贸n",type:"date",class:"rounded-lg shadow-sm border-gray-300 p-2","onUpdate:modelValue":s[0]||(s[0]=a=>f(b).date=a)},null,512),[[z,f(b).date]])]),s[5]||(s[5]=e("div",{class:"grid grid-cols-5 font-bold uppercase bg-gray-300 p-2 text-center"},[e("div",{class:"col-span-1"},"Proveedor"),e("div",{class:"col-span-1"},"Concepto"),e("div",{class:"col-span-1"},"Pasajeros"),e("div",{class:"col-span-1"},"Costo"),e("div",{class:"col-span-1"},"Penalidad Total")],-1)),(i(!0),u(O,null,T(x.value,a=>(i(),u("div",le,[e("div",ne,l(a.proveedor_name),1),e("div",ae,l(a.concept),1),e("div",ie,l(a.pasajeros),1),e("div",re,l(f($).format(a.cost)),1),j(e("input",{class:"col-span-1 rounded-md border border-gray-300 p-2","onUpdate:modelValue":S=>a.costo_penalidad=S,type:"number",mode:"currency"},null,8,de),[[z,a.costo_penalidad]])]))),256))]),e("div",ue,[d(g,{onClick:s[1]||(s[1]=a=>v.value=!1)},{default:w(()=>s[6]||(s[6]=[F("No, Cerrar")])),_:1}),d(g,{severity:"danger",onClick:C},{default:w(()=>s[7]||(s[7]=[F("Si, Cancelar Servicio")])),_:1})])]),_:1},8,["title","modelValue"])}}},ve={class:"p-2"},me={class:"mb-4 flex flex-col"},pe={class:"font-extrabold text-2xl text-center",for:""},fe={class:"grid grid-cols-5 border-y items-center border text-right gap-x-4"},be={class:"col-span-1"},xe={class:"col-span-1 text-nowrap truncate"},ye={class:"col-span-1"},ge={class:"col-span-1"},we={class:"flex justify-end p-6 space-x-4"},Ce={__name:"ServiceNoShow",props:I({service:Object},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const $=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}),v=M(o,"modelValue"),c=o,b=H({cantidad:"",proveedors:[]}),x=k([]);W(()=>{x.value=c.service.proveedors.map(r=>{var s=r.proveedor;return{proveedor_id:r.id,concept:s.concept,proveedor:r,pasajeros:c.service.adults,cost:r.cost,proveedor_name:s.proveedor.nombre,costo_penalidad:s.proveedor.type_penalidad_cost=="Porcentaje"?s.proveedor.penalidad_noshow/100*r.cost:s.proveedor.penalidad_noshow*c.service.adults}})});const C=()=>{b.proveedors=x.value,b.post(route("noshow.servicio",c.service.id),{onSuccess:()=>{v.value=!1,console.log("Cancelado")}})};return(r,s)=>{const g=R;return i(),U(L,{title:`Marcar como No SHOW ${o.service.service}`,modelValue:v.value,"onUpdate:modelValue":s[2]||(s[2]=a=>v.value=a),width:"70vw",onClose:s[3]||(s[3]=a=>v.value=!1),"close-on-escape":""},{default:w(()=>[e("div",ve,[e("div",me,[e("h1",pe,l(o.service.cliente_name),1),s[4]||(s[4]=e("label",{for:"",class:"font-bold"},"Cuantos no se presentaron?",-1)),d(A,{type:"number",min:"1",max:o.service.adults,class:"rounded-lg border-gray-300",modelValue:f(b).cantidad,"onUpdate:modelValue":s[0]||(s[0]=a=>f(b).cantidad=a)},null,8,["max","modelValue"])]),d(A,{type:"textarea",label:"驴Porque no se presentaron?",class:"text-red-500"}),s[5]||(s[5]=e("div",{class:"grid grid-cols-5 font-bold uppercase bg-gray-300 p-2 text-center"},[e("div",{class:"col-span-1"},"Proveedor"),e("div",{class:"col-span-1"},"Concepto"),e("div",{class:"col-span-1"},"Pasajeros"),e("div",{class:"col-span-1"},"Costo"),e("div",{class:"col-span-1"},"Pago Total")],-1)),(i(!0),u(O,null,T(x.value,a=>(i(),u("div",fe,[e("div",be,l(a.proveedor_name),1),e("div",xe,l(a.concept),1),e("div",ye,l(a.pasajeros),1),e("div",ge,l(f($).format(a.cost)),1),d(A,{class:"col-span-1 rounded-md border-gray-300 p-2",modelValue:a.costo_penalidad,"onUpdate:modelValue":S=>a.costo_penalidad=S,type:"number",mode:"currency"},null,8,["modelValue","onUpdate:modelValue"])]))),256))]),e("div",we,[d(g,{onClick:s[1]||(s[1]=a=>v.value=!1)},{default:w(()=>s[6]||(s[6]=[F("No, Cerrar")])),_:1}),d(g,{severity:"danger",onClick:C},{default:w(()=>s[7]||(s[7]=[F("Si, Cancelar Servicio")])),_:1})])]),_:1},8,["title","modelValue"])}}},Ve={class:"flex items-center gap-2"},$e={class:"font-bold text-lg"},ke={class:"flex flex-col gap-y-1.5 text-sm"},he={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Se={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},je={key:0,class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},_e={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Oe={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Ae={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},De={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Be=["href"],Ne={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Ue={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Fe={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Pe={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Ee={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Ie={key:1,class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Me={key:2,class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Te={key:3,class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Re={class:"flex flex-col border py-1 bg-white/30 rounded-md px-2"},Le={class:"text-lg flex w-full justify-between items-center mt-2"},He={class:"rounded-full bg-green-800 text-white px-1.5 py-0.5 text-xs fles items-center justify-center"},We={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Ge={key:0,class:"flex flex-col items-center"},ze={class:"grid grid-cols-3 md:grid-cols-6 gap-2"},qe={key:1,class:"flex items-center w-full justify-center"},Je={class:"bg-black text-white rounded-lg p-4 uppercase shadow-2xl"},Ke={class:"flex flex-col gap-y-2"},Qe={class:"flex flex-col gap-y-1"},Xe={key:0,class:"flex items-center gap-x-2"},Ye={key:1},Ze={class:"flex items-center gap-2"},et={class:"flex justify-end gap-2"},kt={__name:"viewBooking",props:I({service:Object,proveedors:Array},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const{toast:$}=Z(),v=o,c=k(null),b=M(o,"modelValue"),x=k(!1),C=k(!1),r=k(!1),s=H({service:v.service.id,current_id:"",new_id:"",state:"REUBICAR",note:"",terminated:!0,value:""}),g=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}),a=()=>{x.value=!0},S=(p,t)=>{E.fire({title:p,text:"Estas seguro de realizar esta acci贸n?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si"}).then(h=>{h.isConfirmed&&(E.fire({title:p,text:"Esta reserva ha sido "+p+".",icon:"success"}),q.post(route("set.states"),{service:v.service.id,state:p,terminated:t},{onSuccess:()=>{$("success","Reserva "+p)}}))})},D=()=>{E.fire({title:"Cambio de Fecha",input:"date",inputLabel:"Nueva Fecha",showCancelButton:!0,confirmButtonText:"Cambiar Fecha",showLoaderOnConfirm:!0,preConfirm:async p=>{await q.post(route("set.states"),{service:v.service.id,state:"CAMBIO DE FECHA",date:p,terminated:!1})},allowOutsideClick:()=>!E.isLoading()}).then(p=>{p.isConfirmed&&$("success","Fecha Cambiada")})},V=p=>{if(p==null||p==null)return"Sin definir";var t=new Date(new Date(p).getTime()+new Date(p).getTimezoneOffset()*6e4).toLocaleString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"});return t=="30/11/2"?"INDEFINIDO":t},m=()=>{if(!c.value||!s.new_id||!s.value)return $("error","Rellene todos los Campos"),0;s.current_id=c.value.id,s.state="REUBICADO",s.terminated=!0,s.post(route("set.states"),{onSuccess:()=>{r.value=!1,s.reset(),$("success","Servicio REUBICADO")}}),console.log(s.current_id)},B=()=>{s.reset(),r.value=!0},y={reservado:"blue","CAMBIO DE FECHA":"gray","NO SHOW":"amber",REUBICADO:"orange",CANCELADA:"green"};return(p,t)=>{const h=R,J=Y,K=X,N=Q;return i(),u(O,null,[d(J,{visible:b.value,"onUpdate:visible":t[6]||(t[6]=n=>b.value=n),"pt:root:class":`!bg-${y[o.service.status]}-200`,header:"Detalles de la actividad",position:"right"},{header:w(()=>[e("div",Ve,[e("span",$e,l(o.service.service),1)])]),footer:w(()=>[o.service.status=="reservado"||o.service.status=="PROBLEMATICA"||o.service.status=="REUBICADO"||o.service.status=="CAMBIO DE FECHA"?(i(),u("div",Ge,[e("div",ze,[j(d(h,{onClick:t[0]||(t[0]=n=>S("reservado",!0)),icon:"fa-solid fa-circle-check",severity:"info"},null,512),[[N,"Reservada",void 0,{top:!0}]]),j(d(h,{onClick:t[1]||(t[1]=n=>C.value=!0),icon:"fa-solid fa-eye-slash",class:"!text-white !bg-yellow-600"},null,512),[[N,"Servicio No show",void 0,{top:!0}]]),j(d(h,{onClick:t[2]||(t[2]=n=>D()),icon:"fa-solid fa-calendar-week",class:"!bg-gray-600 !text-white"},null,512),[[N,"Cambio de Fecha",void 0,{top:!0}]]),j(d(h,{onClick:t[3]||(t[3]=n=>B()),icon:"fa-solid fa-people-arrows",severity:"warn"},null,512),[[N,"Cambio de proveedor",void 0,{top:!0}]]),j(d(h,{onClick:t[4]||(t[4]=n=>a()),icon:"fa-solid fa-xmark-circle",severity:"danger"},null,512),[[N,"Cancelar Servicio",void 0,{top:!0}]]),j(d(h,{onClick:t[5]||(t[5]=n=>S("PROBLEMATICA",!1)),icon:"fa-solid fa-person-dress-burst",class:"flex-auto",severity:"danger"},null,512),[[N,"Servicio Problematico",void 0,{top:!0}]])])])):(i(),u("div",qe,[e("div",Je," Reserva "+l(o.service.status),1)]))]),default:w(()=>{var n;return[e("div",ke,[e("div",he,[t[16]||(t[16]=e("strong",null,"Fecha del Servicio:",-1)),e("p",null,l(V(o.service.date)),1)]),e("div",Se,[t[17]||(t[17]=e("strong",null,"Hora del Servicio:",-1)),e("p",null,l(o.service.hour),1)]),o.service.time_service?(i(),u("div",je,[t[18]||(t[18]=e("strong",null,"Duraci贸n del Servicio:",-1)),e("p",null,l(o.service.time_service),1)])):_("",!0),e("div",_e,[t[19]||(t[19]=e("strong",null,"Canal de Venta:",-1)),e("p",null,l(o.service.channel.name),1)]),e("div",Oe,[t[20]||(t[20]=e("strong",null,"Cliente:",-1)),e("p",null,l(o.service.cliente_name),1)]),e("div",Ae,[t[21]||(t[21]=e("strong",null,"Ciudad:",-1)),e("p",null,l(o.service.cliente_city),1)]),e("div",De,[t[22]||(t[22]=e("strong",null,"Telelfono:",-1)),e("a",{target:"_blank",href:`https://wa.me/${o.service.cliente_phone}?text=Hola%20,%20mi%20nombre%20es%20*Sandra Gil*,%20Le%20escribo%20desde%20*AV%20COLOMBIA*`},l(o.service.cliente_phone),9,Be)]),e("div",Ne,[t[23]||(t[23]=e("strong",null,"Edificio:",-1)),e("p",null,l(o.service.cliente_building),1)]),e("div",Ue,[t[24]||(t[24]=e("strong",null,"Adultos:",-1)),e("p",null,l(o.service.adults),1)]),e("div",Fe,[t[25]||(t[25]=e("strong",null,"Ni帽os:",-1)),e("p",null,l(o.service.boys),1)]),e("div",Pe,[t[26]||(t[26]=e("strong",null,"Total:",-1)),e("p",null,l(f(g).format(o.service.total)),1)]),e("div",Ee,[t[27]||(t[27]=e("strong",null,"Total Real:",-1)),e("p",null,l(f(g).format(o.service.total_real)),1)]),o.service.user?(i(),u("div",Ie,[t[28]||(t[28]=e("strong",null,"Usuario:",-1)),e("p",null,l((n=o.service.user)==null?void 0:n.name),1)])):_("",!0),o.service.user?(i(),u("div",Me,[t[29]||(t[29]=e("strong",null,"Fecha de reserva:",-1)),e("p",null,l(new Date(o.service.created_at).toLocaleDateString("es-CO")),1)])):_("",!0),o.service.fecha_cancelacion?(i(),u("div",Te,[t[30]||(t[30]=e("strong",null,"Fecha de Cancelaci贸n:",-1)),e("p",null,l(new Date(o.service.fecha_cancelacion).toLocaleDateString("es-CO")),1)])):_("",!0),e("div",Re,[t[31]||(t[31]=e("strong",null,"Observacion:",-1)),e("p",null,l(o.service.observations),1)]),e("div",Le,[t[32]||(t[32]=e("p",{class:"font-bold"},"Proveedores",-1)),e("p",He,l(o.service.proveedors.length),1)]),(i(!0),u(O,null,T(o.service.proveedors,G=>(i(),u("div",We,[e("p",null,l(G.proveedor.proveedor.nombre),1),e("p",null,l(f(g).format(G.cost)),1)]))),256))])]}),_:1},8,["visible","pt:root:class"]),d(L,{modelValue:r.value,"onUpdate:modelValue":t[13]||(t[13]=n=>r.value=n),title:"Cambio de proveedor","close-on-escape":""},{default:w(()=>[e("div",Ke,[e("span",Qe,[t[35]||(t[35]=e("label",{for:"",class:"font-bold"}," Proveedor Actual",-1)),d(K,{placeholder:"Proveedor Actual",options:o.service.proveedors,label:"Proveedor Actual",modelValue:c.value,"onUpdate:modelValue":t[7]||(t[7]=n=>c.value=n),"option-label":"proveedor.name"},{value:w(n=>[n.value?(i(),u("div",Xe,[e("div",null,l(c.value.proveedor.proveedor.nombre),1),t[33]||(t[33]=e("span",null,"-",-1)),e("div",null,l(f(g).format(c.value.cost)),1)])):(i(),u("span",Ye,l(n.placeholder),1))]),option:w(({option:n})=>[e("div",Ze,[e("span",null,l(n.proveedor.proveedor.nombre),1),t[34]||(t[34]=e("span",null,"-",-1)),e("span",null,l(f(g).format(n.cost)),1)])]),_:1},8,["options","modelValue"])]),d(A,{"option-label":"nombre",type:"dropdown",label:"Nuevo Proveedor",modelValue:f(s).new_id,"onUpdate:modelValue":t[8]||(t[8]=n=>f(s).new_id=n),options:o.proveedors},null,8,["modelValue","options"]),d(A,{label:"Valor",modelValue:f(s).value,"onUpdate:modelValue":t[9]||(t[9]=n=>f(s).value=n),type:"number",mode:"currency"},null,8,["modelValue"]),d(A,{label:"Nota",modelValue:f(s).note,"onUpdate:modelValue":t[10]||(t[10]=n=>f(s).note=n),type:"textarea",mode:"currency"},null,8,["modelValue"]),e("div",et,[d(h,{onClick:t[11]||(t[11]=n=>r.value=!1),label:"Cancelar",severity:"danger",icon:"fa-solid fa-xmark"}),d(h,{onClick:t[12]||(t[12]=n=>m()),label:"Guardar",severity:"success",icon:"fa-solid fa-save"})])])]),_:1},8,["modelValue"]),x.value?(i(),U(ce,{key:0,modelValue:x.value,"onUpdate:modelValue":t[14]||(t[14]=n=>x.value=n),service:o.service},null,8,["modelValue","service"])):_("",!0),C.value?(i(),U(Ce,{key:1,modelValue:C.value,"onUpdate:modelValue":t[15]||(t[15]=n=>C.value=n),service:o.service},null,8,["modelValue","service"])):_("",!0)],64)}}},tt={class:"w-full flex flex-col gap-y-5 p-2"},st={class:"h-[30vh] overflow-y-auto flex flex-col gap-y-2"},ot={key:0,class:"flex w-full"},lt={class:"w-1/2 flex py-1 px-3 rounded-md items-center justify-between bg-sky-100"},nt={class:"flex flex-col"},at={class:"text-lg font-bold first-letter:uppercase"},it={class:"italic text-xs"},rt={key:1,class:"flex w-full"},dt={class:"w-1/2 flex py-1 px-3 rounded-md items-center border justify-between bg-gray-300"},ut={class:"flex flex-col"},ct={class:"text-lg font-bold first-letter:uppercase"},vt={class:"italic text-xs"},mt={key:0,class:"flex justify-center items-center"},pt={key:0,class:"flex justify-center flex-col items-center"},ft={class:"flex gap-x-2 px-2"},ht={__name:"Notas",props:I({todayActivity:Boolean,notes:Array,note:String,service:Array},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(o){const $=M(o,"modelValue"),v=o,c=k(v.notes),b=k(!1),x=k(null),C=k(!1),r=k(""),s=()=>{P.post(route("notes.store"),{note:r.value,booking_service_id:v.service.id}).then(V=>{r.value="",D()})},g=V=>{P.delete(route("notes.destroy",V.id)).then(m=>{D()})},a=V=>{r.value=V.note,b.value=!0,x.value=V},S=()=>{P.put(route("notes.update",x.value.id),{note:r.value}).then(V=>{D(),r.value="",b.value=!1,x.value=null})},D=()=>{C.value=!0,P.get(route("notes.index",{booking_service_id:v.service.id})).then(V=>{c.value=V.data.notes,C.value=!1})};return W(()=>{D()}),(V,m)=>{const B=R;return i(),u(O,null,[m[6]||(m[6]=F(" asndlands ")),d(L,{modelValue:$.value,"onUpdate:modelValue":m[1]||(m[1]=y=>$.value=y),"close-on-escape":"",title:"Notas",width:"60vw"},{default:w(()=>[e("div",tt,[m[5]||(m[5]=e("h3",{class:"text-xl font-bold"},"Notas de la Actividad",-1)),e("div",st,[(i(!0),u(O,null,T(c.value,y=>(i(),u("div",{class:"flex p-2 rounded-md items-center justify-between w-full",key:y.id},[y.user_id==V.$page.props.auth.user.id?(i(),u("div",ot,[m[2]||(m[2]=e("div",{class:"w-1/2"},null,-1)),e("div",lt,[e("span",nt,[e("p",at,l(y.note),1),e("p",it,l(new Date(y.created_at).toISOString().split("T")[0]),1)]),e("div",null,[d(B,{icon:"fa-solid fa-pencil",text:"",severity:"info",onClick:p=>a(y)},null,8,["onClick"]),d(B,{icon:"fa-solid fa-trash",text:"",severity:"danger",onClick:p=>g(y)},null,8,["onClick"])])])])):(i(),u("div",rt,[e("div",dt,[e("span",ut,[e("p",ct,l(y.note),1),e("p",vt,l(y.user.name)+" - "+l(new Date(y.created_at).toISOString().split("T")[0]),1)])]),m[3]||(m[3]=e("div",{class:"w-1/2"},null,-1))]))]))),128)),C.value?(i(),u("div",mt,[d(te)])):(i(),u(O,{key:1},[c.value.length==0?(i(),u("div",pt,[d(ee),m[4]||(m[4]=e("p",{class:"font-semibold text-xl"},"Serivicio sin notas",-1))])):_("",!0)],64))]),e("div",ft,[d(A,{type:"textarea",class:"w-full",rowsTextarea:2,modelValue:r.value,"onUpdate:modelValue":m[0]||(m[0]=y=>r.value=y)},null,8,["modelValue"]),b.value?(i(),U(B,{key:1,label:"Editar",severity:"info",icon:"pi pi-send",class:"!h-12",onClick:S})):(i(),U(B,{key:0,label:"Guardar",severity:"success",class:"!h-12",icon:"pi pi-send",onClick:s}))])])]),_:1},8,["modelValue"])],64)}}};export{ht as _,kt as a};
