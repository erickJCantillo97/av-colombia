var x=Object.defineProperty;var w=(m,e,n)=>e in m?x(m,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):m[e]=n;var u=(m,e,n)=>w(m,typeof e!="symbol"?e+"":e,n);import{s as S}from"./index-DsPtxUps.js";import{d as f,C,y,q as h,z as U,f as R,a as d,b as s,u as t,t as g,j as M,o as O}from"./app-BXOTtdN6.js";import{_ as i}from"./Input-kr4WJDyd.js";import{a as p,g as E}from"./Toats-DWscwGKH.js";import{u as j}from"./useCommonUtilities-hipAPSUL.js";import{S as k}from"./Service-BFxziYQr.js";const{currencyFormat:V}=j();class A{constructor(e){u(this,"loading",f(!1));u(this,"statuesOptions",[{text:"RESERVADO",color:"blue"},{text:"COMPLETADA",color:"teal"},{text:"CAMBIO DE FECHA",color:"gray"},{text:"NO SHOW",color:"amber"},{text:"REUBICADO",color:"orange"},{text:"CANCELADA",color:"green"},{text:"SIN CONFIRMAR",color:"red"}]);u(this,"channels",f([]));u(this,"bookingService",f());u(this,"form",C({id:"",service_id:"",date:"",adults:1,time_service:"",boys:0,cliente_name:"",cliente_phone:"",cliente_city:"",cliente_building:"",reserva:0,method_id:"",channel_id:"9d99a95f-6c3d-48fd-aa7d-6ef4e6860123",saldo:0,total:0,total_real:0,percent_channel:0,observations:"",code_booking:""}));u(this,"valorReal",h(()=>{let e=this.channels.value.find(c=>c.id==this.form.channel_id),n=e?e.percent/100:0;return this.form.total-this.form.total*n}));u(this,"valorRealFormat",h(()=>V(this.valorReal.value)));u(this,"valuePasajeros",h(()=>V(this.form.total/this.form.adults)));u(this,"valueCanalVenta",h(()=>{let e=this.channels.value.find(c=>c.id==this.form.channel_id),n=e?e.percent/100:0;return V(this.form.total*n)}));this.bookingService=e,e&&(Object.keys(this.form).forEach(n=>{e[n]!==void 0&&(this.form[n]=e[n])}),this.form.date=this.formatDateTime(e.date,e.hour))}formatDateTime(e,n){const[c,v,b]=e.split("-"),[r,o]=n.split(":");return`${c}-${v}-${b},${r}:${o}`}async create(){if(!this.form.service_id)return p("Selecciona un Servicio");if(!this.form.date)return p("Selecciona una fecha");if(!this.form.method_id)return p("Selecciona un metodo de pago");if(!this.form.channel_id)return p("Selecciona un canal");if(!this.form.cliente_name)return p("Ingresa el nombre del cliente");if(!this.form.cliente_phone)return p("Ingresa el telefono del cliente");if(!this.form.cliente_city)return p("Ingresa la ciudad del cliente");if(!this.form.cliente_building)return p("Ingresa el edificio del cliente");this.form.total_real=this.valorReal.value,this.form.percent_channel=this.channels.value.find(e=>e.id==this.form.channel_id).percent,this.loading.value=!0,this.form.post(route("BookingServices.store")),this.loading.value=!1}async update(){this.form.total_real=this.valorReal.value,this.form.percent_channel=this.channels.value.find(e=>e.id==this.form.channel_id).percent,this.loading.value=!0,this.form.put(route("BookingServices.update",this.bookingService.id)),E("Reserva actualizada Exitosamente"),this.loading.value=!1}async getChannels(){const{data:e}=await y.get(route("channels.index"));return this.channels.value=e,e}async getMethods(){const{data:e}=await y.get(route("paymentMethods.index"));return e}getColorStatus(){return console.log(this.bookingService.status),this.statuesOptions.find(e=>e.text==this.bookingService.status.toUpperCase()).color}submit(){return this.bookingService?this.update():this.create()}}const F={class:""},B={class:"flex justify-between w-full gap-x-4 col-span-2"},P={class:"p-2 border rounded-md shadow-md w-full text-center"},D={class:"text-xl font-bold"},H={class:"p-2 border rounded-md shadow-md w-full text-center"},I={class:"text-xl font-bold"},N={class:"p-2 border rounded-md shadow-md w-full text-center"},T={class:"text-xl font-bold"},$={__name:"FormFirst",props:{bookingService:Object},setup(m){const e=f([]),n=f([]),c=f([]),v=m,b=new k,r=new A(v.bookingService),o=r.form;return U(async()=>{e.value=await b.getServices(),n.value=await r.getChannels(),c.value=await r.getMethods()}),(z,l)=>{const _=S;return O(),R("div",F,[d("form",{class:"grid grid-cols-1 md:grid-cols-2 gap-2 items-center",onSubmit:l[14]||(l[14]=M((...a)=>t(r).submit&&t(r).submit(...a),["prevent"]))},[s(i,{modelValue:t(o).service_id,"onUpdate:modelValue":l[0]||(l[0]=a=>t(o).service_id=a),class:"col-span-2",type:"dropdown",label:"Servicio","option-label":"title","option-value":"id",options:e.value},null,8,["modelValue","options"]),s(i,{label:"Fecha de Reserva",modelValue:t(o).date,"onUpdate:modelValue":l[1]||(l[1]=a=>t(o).date=a),enableTimePicker:!0,class:"w-full",type:"datetime"},null,8,["modelValue"]),s(i,{label:"Valor Total",type:"number",mode:"currency",required:!0,modelValue:t(o).total,"onUpdate:modelValue":l[2]||(l[2]=a=>t(o).total=a)},null,8,["modelValue"]),s(i,{label:"Tiempo del Servicio",type:"dropdown",modelValue:t(o).time_service,"onUpdate:modelValue":l[3]||(l[3]=a=>t(o).time_service=a),options:["20 Minutos","30 Minutos","40 Minutos","1 Hora","2 Horas","6 Horas","12 Horas","24 Horas"]},null,8,["modelValue"]),s(i,{label:"Pasajeros",type:"number",modelValue:t(o).adults,"onUpdate:modelValue":l[4]||(l[4]=a=>t(o).adults=a)},null,8,["modelValue"]),s(i,{label:"NiÃ±os",type:"number",modelValue:t(o).boys,"onUpdate:modelValue":l[5]||(l[5]=a=>t(o).boys=a)},null,8,["modelValue"]),s(i,{label:"Nombre del Pasajero",required:!0,modelValue:t(o).cliente_name,"onUpdate:modelValue":l[6]||(l[6]=a=>t(o).cliente_name=a),class:"w-full"},null,8,["modelValue"]),s(i,{label:"Telefono",class:"w-full",type:"number",modelValue:t(o).cliente_phone,"onUpdate:modelValue":l[7]||(l[7]=a=>t(o).cliente_phone=a)},null,8,["modelValue"]),s(i,{label:"Ciudad de donde Proviene",class:"w-full",modelValue:t(o).cliente_city,"onUpdate:modelValue":l[8]||(l[8]=a=>t(o).cliente_city=a)},null,8,["modelValue"]),s(i,{label:"Edificio u Hotel",class:"w-full",modelValue:t(o).cliente_building,"onUpdate:modelValue":l[9]||(l[9]=a=>t(o).cliente_building=a)},null,8,["modelValue"]),s(i,{class:"w-full",type:"dropdown","option-label":"name","option-value":"id",options:c.value,modelValue:t(o).method_id,"onUpdate:modelValue":l[10]||(l[10]=a=>t(o).method_id=a),label:"Medio de Pago"},null,8,["options","modelValue"]),s(i,{class:"w-full",type:"dropdown","option-label":"name","option-value":"id",options:n.value,modelValue:t(o).channel_id,"onUpdate:modelValue":l[11]||(l[11]=a=>t(o).channel_id=a),label:"Canal de Venta"},null,8,["options","modelValue"]),s(i,{class:"w-full",label:"Saldo",type:"number",mode:"currency",modelValue:t(o).saldo,"onUpdate:modelValue":l[12]||(l[12]=a=>t(o).saldo=a)},null,8,["modelValue"]),s(i,{class:"w-full col-span-1 md:col-span-2","rows-textarea":2,label:"Observaciones",modelValue:t(o).observations,"onUpdate:modelValue":l[13]||(l[13]=a=>t(o).observations=a),type:"textarea"},null,8,["modelValue"]),d("div",B,[d("div",P,[l[15]||(l[15]=d("p",{class:"text-md font-extralight"},"Valor Pasajero",-1)),d("h1",D,g(t(r).valuePasajeros),1)]),d("div",H,[l[16]||(l[16]=d("p",{class:"text-md font-extralight"},"Comisiones Canal de venta",-1)),d("h1",I,g(t(r).valueCanalVenta),1)]),d("div",N,[l[17]||(l[17]=d("p",{class:"text-md font-extralight"},"Valor total Real",-1)),d("h1",T,g(t(r).valorRealFormat),1)])]),s(_,{class:"col-span-2",type:"submit",severity:"success",label:m.bookingService?"Actualizar Reserva":"Crear Reserva",loading:t(r).loading.value},null,8,["label","loading"])],32)])}}},X=Object.freeze(Object.defineProperty({__proto__:null,default:$},Symbol.toStringTag,{value:"Module"}));export{A as B,X as F,$ as _};
