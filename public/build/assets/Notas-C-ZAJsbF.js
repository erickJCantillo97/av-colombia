import{al as T,am as P,C as G,d as V,af as W,o as r,c as F,w as C,a as e,k,u as p,v as L,f as u,F as O,i as E,t as o,b as a,h as U,g as j,W as H,T as J,A as B}from"./app-Bo28TQEx.js";import{s as K}from"./index-De23883Q.js";import{s as Q}from"./index-B0mzR3aU.js";import{s as I}from"./index-CB_GW8FO.js";import{S as N,a as X}from"./toasts-CuGasqAw.js";import{a as M,_ as A}from"./Modal-DdJsG76n.js";import{_ as Y}from"./logo-a1gklBsZ.js";import{_ as Z}from"./Loading-BdRarfBB.js";const ee={class:"p-2"},te={class:"mb-4 flex flex-col"},se={class:"grid grid-cols-5 border-y items-center border text-right gap-x-4"},oe={class:"col-span-1"},le={class:"col-span-1 text-nowrap truncate"},ne={class:"col-span-1"},ie={class:"col-span-1"},re=["onUpdate:modelValue"],ae={class:"flex justify-end p-6 space-x-4"},de={__name:"ServiceCancel",props:T({service:Object},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const $=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}),m=P(s,"modelValue"),f=s,g=G({date:"",proveedors:[]}),b=V([]);W(()=>{b.value=f.service.proveedors.map(l=>{var n=l.proveedor;return{proveedor_id:l.id,concept:n.concept,proveedor:l,pasajeros:f.service.adults,cost:l.cost,proveedor_name:n.proveedor.nombre,costo_penalidad:n.proveedor.type_penalidad_cost=="Porcentaje"?n.proveedor.penalidad_cancelacion/100*l.cost:n.proveedor.penalidad_cancelacion*f.service.adults}})});const w=()=>{g.proveedors=b.value,g.post(route("cancelar.servicio",f.service.id),{onSuccess:()=>{m.value=!1,console.log("Cancelado")}})};return(l,n)=>{const h=I;return r(),F(M,{title:`Cancelar Servicio ${s.service.service}`,modelValue:m.value,"onUpdate:modelValue":n[2]||(n[2]=c=>m.value=c),width:"70vw",onClose:n[3]||(n[3]=c=>m.value=!1),"close-on-escape":""},{default:C(()=>[e("div",ee,[e("div",te,[n[4]||(n[4]=e("label",{for:"",class:"font-bold"},"Fecha de Cancelaci贸n",-1)),k(e("input",{label:"Fecha de Cancelaci贸n",type:"date",class:"rounded-lg shadow-sm border-gray-300 p-2","onUpdate:modelValue":n[0]||(n[0]=c=>p(g).date=c)},null,512),[[L,p(g).date]])]),n[5]||(n[5]=e("div",{class:"grid grid-cols-5 font-bold uppercase bg-gray-300 p-2 text-center"},[e("div",{class:"col-span-1"},"Proveedor"),e("div",{class:"col-span-1"},"Concepto"),e("div",{class:"col-span-1"},"Pasajeros"),e("div",{class:"col-span-1"},"Costo"),e("div",{class:"col-span-1"},"Penalidad Total")],-1)),(r(!0),u(O,null,E(b.value,c=>(r(),u("div",se,[e("div",oe,o(c.proveedor_name),1),e("div",le,o(c.concept),1),e("div",ne,o(c.pasajeros),1),e("div",ie,o(p($).format(c.cost)),1),k(e("input",{class:"col-span-1 rounded-md border border-gray-300 p-2","onUpdate:modelValue":D=>c.costo_penalidad=D,type:"number",mode:"currency"},null,8,re),[[L,c.costo_penalidad]])]))),256))]),e("div",ae,[a(h,{onClick:n[1]||(n[1]=c=>m.value=!1)},{default:C(()=>n[6]||(n[6]=[U("No, Cerrar")])),_:1}),a(h,{severity:"danger",onClick:w},{default:C(()=>n[7]||(n[7]=[U("Si, Cancelar Servicio")])),_:1})])]),_:1},8,["title","modelValue"])}}},ue={class:"flex items-center gap-2"},ce={class:"font-bold text-lg"},ve={class:"flex flex-col gap-y-1.5 text-sm"},fe={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},pe={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},me={key:0,class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},be={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},xe={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},ye={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},ge={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},we=["href"],Ce={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},$e={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Ve={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},ke={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},he={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Se={key:1,class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},_e={key:2,class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},je={key:3,class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Oe={class:"flex flex-col border py-1 bg-white/30 rounded-md px-2"},De={class:"text-lg flex w-full justify-between items-center mt-2"},Be={class:"rounded-full bg-green-800 text-white px-1.5 py-0.5 text-xs fles items-center justify-center"},Ne={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Ae={class:"flex flex-col items-center"},Fe={class:"grid grid-cols-3 md:grid-cols-6 gap-2"},Ue={class:"flex flex-col gap-y-2"},Te={class:"flex flex-col gap-y-1"},Pe={key:0,class:"flex items-center gap-x-2"},Ee={key:1},Ie={class:"flex items-center gap-2"},Me={class:"flex justify-end gap-2"},ut={__name:"viewBooking",props:T({service:Object,proveedors:Array},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const{toast:$}=X(),m=s,f=V(null),g=P(s,"modelValue"),b=V(!1),w=V(!1),l=G({service:m.service.id,current_id:"",new_id:"",state:"REUBICAR",note:"",terminated:!0,value:""}),n=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}),h=()=>{b.value=!0},c=(d,t)=>{N.fire({title:d,text:"Estas seguro de realizar esta acci贸n?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si"}).then(y=>{y.isConfirmed&&(N.fire({title:d,text:"Esta reserva ha sido "+d+".",icon:"success"}),H.post(route("set.states"),{service:m.service.id,state:d,terminated:t},{onSuccess:()=>{$("success","Reserva "+d)}}))})},D=()=>{N.fire({title:"Cambio de Fecha",input:"date",inputLabel:"Nueva Fecha",showCancelButton:!0,confirmButtonText:"Cambiar Fecha",showLoaderOnConfirm:!0,preConfirm:async d=>{await H.post(route("set.states"),{service:m.service.id,state:"CAMBIO DE FECHA",date:d,terminated:!1})},allowOutsideClick:()=>!N.isLoading()}).then(d=>{d.isConfirmed&&$("success","Fecha Cambiada")})},S=d=>{if(d==null||d==null)return"Sin definir";var t=new Date(new Date(d).getTime()+new Date(d).getTimezoneOffset()*6e4).toLocaleString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"});return t=="30/11/2"?"INDEFINIDO":t},x=()=>{if(!f.value||!l.new_id||!l.value)return $("error","Rellene todos los Campos"),0;l.current_id=f.value.id,l.state="REUBICADO",l.terminated=!0,l.post(route("set.states"),{onSuccess:()=>{w.value=!1,l.reset(),$("success","Servicio REUBICADO")}}),console.log(l.current_id)},v=()=>{l.reset(),w.value=!0};return(d,t)=>{const y=I,z=Q,q=K,_=J;return r(),u(O,null,[a(z,{visible:g.value,"onUpdate:visible":t[6]||(t[6]=i=>g.value=i),"pt:root:class":"!bg-blue-100",header:"Detalles de la actividad",position:"right"},{header:C(()=>[e("div",ue,[e("span",ce,o(s.service.service),1)])]),footer:C(()=>[e("div",Ae,[e("div",Fe,[k(a(y,{onClick:t[0]||(t[0]=i=>c("reservado",!0)),icon:"fa-solid fa-circle-check",severity:"info"},null,512),[[_,"Reservada",void 0,{top:!0}]]),k(a(y,{onClick:t[1]||(t[1]=i=>c("NO SHOW",!0)),icon:"fa-solid fa-eye-slash",class:"!text-white !bg-yellow-600"},null,512),[[_,"Servicio No show",void 0,{top:!0}]]),k(a(y,{onClick:t[2]||(t[2]=i=>D()),icon:"fa-solid fa-calendar-week",class:"!bg-gray-600 !text-white"},null,512),[[_,"Cambio de Fecha",void 0,{top:!0}]]),k(a(y,{onClick:t[3]||(t[3]=i=>v()),icon:"fa-solid fa-people-arrows",severity:"warn"},null,512),[[_,"Cambio de proveedor",void 0,{top:!0}]]),k(a(y,{onClick:t[4]||(t[4]=i=>h()),icon:"fa-solid fa-xmark-circle",severity:"danger"},null,512),[[_,"Cancelar Servicio",void 0,{top:!0}]]),k(a(y,{onClick:t[5]||(t[5]=i=>c("PROBLEMATICA",!1)),icon:"fa-solid fa-person-dress-burst",class:"flex-auto",severity:"danger"},null,512),[[_,"Servicio Problematico",void 0,{top:!0}]])])])]),default:C(()=>{var i;return[e("div",ve,[e("div",fe,[t[15]||(t[15]=e("strong",null,"Fecha del Servicio:",-1)),e("p",null,o(S(s.service.date)),1)]),e("div",pe,[t[16]||(t[16]=e("strong",null,"Hora del Servicio:",-1)),e("p",null,o(s.service.hour),1)]),s.service.time_service?(r(),u("div",me,[t[17]||(t[17]=e("strong",null,"Duraci贸n del Servicio:",-1)),e("p",null,o(s.service.time_service),1)])):j("",!0),e("div",be,[t[18]||(t[18]=e("strong",null,"Canal de Venta:",-1)),e("p",null,o(s.service.channel.name),1)]),e("div",xe,[t[19]||(t[19]=e("strong",null,"Cliente:",-1)),e("p",null,o(s.service.cliente_name),1)]),e("div",ye,[t[20]||(t[20]=e("strong",null,"Ciudad:",-1)),e("p",null,o(s.service.cliente_city),1)]),e("div",ge,[t[21]||(t[21]=e("strong",null,"Telelfono:",-1)),e("a",{target:"_blank",href:`https://wa.me/${s.service.cliente_phone}?text=Hola%20,%20mi%20nombre%20es%20*Sandra Gil*,%20Le%20escribo%20desde%20*AV%20COLOMBIA*`},o(s.service.cliente_phone),9,we)]),e("div",Ce,[t[22]||(t[22]=e("strong",null,"Edificio:",-1)),e("p",null,o(s.service.cliente_building),1)]),e("div",$e,[t[23]||(t[23]=e("strong",null,"Adultos:",-1)),e("p",null,o(s.service.adults),1)]),e("div",Ve,[t[24]||(t[24]=e("strong",null,"Ni帽os:",-1)),e("p",null,o(s.service.boys),1)]),e("div",ke,[t[25]||(t[25]=e("strong",null,"Total:",-1)),e("p",null,o(p(n).format(s.service.total)),1)]),e("div",he,[t[26]||(t[26]=e("strong",null,"Total Real:",-1)),e("p",null,o(p(n).format(s.service.total_real)),1)]),s.service.user?(r(),u("div",Se,[t[27]||(t[27]=e("strong",null,"Usuario:",-1)),e("p",null,o((i=s.service.user)==null?void 0:i.name),1)])):j("",!0),s.service.user?(r(),u("div",_e,[t[28]||(t[28]=e("strong",null,"Fecha de reserva:",-1)),e("p",null,o(new Date(s.service.created_at).toLocaleDateString("es-CO")),1)])):j("",!0),s.service.fecha_cancelacion?(r(),u("div",je,[t[29]||(t[29]=e("strong",null,"Fecha de Cancelaci贸n:",-1)),e("p",null,o(new Date(s.service.fecha_cancelacion).toLocaleDateString("es-CO")),1)])):j("",!0),e("div",Oe,[t[30]||(t[30]=e("strong",null,"Observacion:",-1)),e("p",null,o(s.service.observations),1)]),e("div",De,[t[31]||(t[31]=e("p",{class:"font-bold"},"Proveedores",-1)),e("p",Be,o(s.service.proveedors.length),1)]),(r(!0),u(O,null,E(s.service.proveedors,R=>(r(),u("div",Ne,[e("p",null,o(R.proveedor.proveedor.nombre),1),e("p",null,o(p(n).format(R.cost)),1)]))),256))])]}),_:1},8,["visible"]),a(M,{modelValue:w.value,"onUpdate:modelValue":t[13]||(t[13]=i=>w.value=i),title:"Cambio de proveedor","close-on-escape":""},{default:C(()=>[e("div",Ue,[e("span",Te,[t[34]||(t[34]=e("label",{for:"",class:"font-bold"}," Proveedor Actual",-1)),a(q,{placeholder:"Proveedor Actual",options:s.service.proveedors,label:"Proveedor Actual",modelValue:f.value,"onUpdate:modelValue":t[7]||(t[7]=i=>f.value=i),"option-label":"proveedor.name"},{value:C(i=>[i.value?(r(),u("div",Pe,[e("div",null,o(f.value.proveedor.proveedor.nombre),1),t[32]||(t[32]=e("span",null,"-",-1)),e("div",null,o(p(n).format(f.value.cost)),1)])):(r(),u("span",Ee,o(i.placeholder),1))]),option:C(({option:i})=>[e("div",Ie,[e("span",null,o(i.proveedor.proveedor.nombre),1),t[33]||(t[33]=e("span",null,"-",-1)),e("span",null,o(p(n).format(i.cost)),1)])]),_:1},8,["options","modelValue"])]),a(A,{"option-label":"nombre",type:"dropdown",label:"Nuevo Proveedor",modelValue:p(l).new_id,"onUpdate:modelValue":t[8]||(t[8]=i=>p(l).new_id=i),options:s.proveedors},null,8,["modelValue","options"]),a(A,{label:"Valor",modelValue:p(l).value,"onUpdate:modelValue":t[9]||(t[9]=i=>p(l).value=i),type:"number",mode:"currency"},null,8,["modelValue"]),a(A,{label:"Nota",modelValue:p(l).note,"onUpdate:modelValue":t[10]||(t[10]=i=>p(l).note=i),type:"textarea",mode:"currency"},null,8,["modelValue"]),e("div",Me,[a(y,{onClick:t[11]||(t[11]=i=>w.value=!1),label:"Cancelar",severity:"danger",icon:"fa-solid fa-xmark"}),a(y,{onClick:t[12]||(t[12]=i=>x()),label:"Guardar",severity:"success",icon:"fa-solid fa-save"})])])]),_:1},8,["modelValue"]),b.value?(r(),F(de,{key:0,modelValue:b.value,"onUpdate:modelValue":t[14]||(t[14]=i=>b.value=i),service:s.service},null,8,["modelValue","service"])):j("",!0)],64)}}},Re={class:"w-full flex flex-col gap-y-5 p-2"},Le={class:"h-[30vh] overflow-y-auto flex flex-col gap-y-2"},He={key:0,class:"flex w-full"},Ge={class:"w-1/2 flex py-1 px-3 rounded-md items-center justify-between bg-sky-100"},We={class:"flex flex-col"},ze={class:"text-lg font-bold first-letter:uppercase"},qe={class:"italic text-xs"},Je={key:1,class:"flex w-full"},Ke={class:"w-1/2 flex py-1 px-3 rounded-md items-center border justify-between bg-gray-300"},Qe={class:"flex flex-col"},Xe={class:"text-lg font-bold first-letter:uppercase"},Ye={class:"italic text-xs"},Ze={key:0,class:"flex justify-center items-center"},et={key:0,class:"flex justify-center flex-col items-center"},tt={class:"flex gap-x-2 px-2"},ct={__name:"Notas",props:T({todayActivity:Boolean,notes:Array,note:String,service:Array},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const $=P(s,"modelValue"),m=s,f=V(m.notes),g=V(!1),b=V(null),w=V(!1),l=V(""),n=()=>{B.post(route("notes.store"),{note:l.value,booking_service_id:m.service.id}).then(x=>{l.value="",S()})},h=x=>{B.delete(route("notes.destroy",x.id)).then(v=>{S()})},c=x=>{l.value=x.note,g.value=!0,b.value=x},D=()=>{B.put(route("notes.update",b.value.id),{note:l.value}).then(x=>{S(),l.value="",g.value=!1,b.value=null})},S=()=>{w.value=!0,B.get(route("notes.index",{booking_service_id:m.service.id})).then(x=>{f.value=x.data.notes,w.value=!1})};return W(()=>{S()}),(x,v)=>{const d=I;return r(),u(O,null,[v[6]||(v[6]=U(" asndlands ")),a(M,{modelValue:$.value,"onUpdate:modelValue":v[1]||(v[1]=t=>$.value=t),"close-on-escape":"",title:"Notas",width:"60vw"},{default:C(()=>[e("div",Re,[v[5]||(v[5]=e("h3",{class:"text-xl font-bold"},"Notas de la Actividad",-1)),e("div",Le,[(r(!0),u(O,null,E(f.value,t=>(r(),u("div",{class:"flex p-2 rounded-md items-center justify-between w-full",key:t.id},[t.user_id==x.$page.props.auth.user.id?(r(),u("div",He,[v[2]||(v[2]=e("div",{class:"w-1/2"},null,-1)),e("div",Ge,[e("span",We,[e("p",ze,o(t.note),1),e("p",qe,o(new Date(t.created_at).toISOString().split("T")[0]),1)]),e("div",null,[a(d,{icon:"fa-solid fa-pencil",text:"",severity:"info",onClick:y=>c(t)},null,8,["onClick"]),a(d,{icon:"fa-solid fa-trash",text:"",severity:"danger",onClick:y=>h(t)},null,8,["onClick"])])])])):(r(),u("div",Je,[e("div",Ke,[e("span",Qe,[e("p",Xe,o(t.note),1),e("p",Ye,o(t.user.name)+" - "+o(new Date(t.created_at).toISOString().split("T")[0]),1)])]),v[3]||(v[3]=e("div",{class:"w-1/2"},null,-1))]))]))),128)),w.value?(r(),u("div",Ze,[a(Z)])):(r(),u(O,{key:1},[f.value.length==0?(r(),u("div",et,[a(Y),v[4]||(v[4]=e("p",{class:"font-semibold text-xl"},"Serivicio sin notas",-1))])):j("",!0)],64))]),e("div",tt,[a(A,{type:"textarea",class:"w-full",rowsTextarea:2,modelValue:l.value,"onUpdate:modelValue":v[0]||(v[0]=t=>l.value=t)},null,8,["modelValue"]),g.value?(r(),F(d,{key:1,label:"Editar",severity:"info",icon:"pi pi-send",class:"!h-12",onClick:D})):(r(),F(d,{key:0,label:"Guardar",severity:"success",class:"!h-12",icon:"pi pi-send",onClick:n}))])])]),_:1},8,["modelValue"])],64)}}};export{ct as _,ut as a};
