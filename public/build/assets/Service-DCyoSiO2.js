import{y as o,x as d,A as s}from"./app-DP_sni2d.js";import{a as i,g as n}from"./Toats-P8MTWC3g.js";import{s as r}from"./searchStore-CnOLmyRn.js";class g{url=null;assignMatchingKeys(e,t){Object.keys(e).forEach(a=>{a in t&&(t[a]=e[a])})}submit(e,t=null){return t?o.put(route(this.url+".update",t),e,{onSuccess:()=>{n("Actualizado Exitosamente")},onError:a=>{i(a.response.data.message||"Error al actualizar")}}):o.post(route(this.url+".store"),e,{onSuccess:()=>{n("Guardado Exitosamente")},onError:a=>{i(a.response.data.message||"Error al guardar")}})}delete(e){return o.delete(route(this.url+".destroy",e),{onSuccess:()=>{n("Eliminado Exitosamente")},onError:t=>{i(t.response.data.message||"Error al eliminar")}})}}class f extends g{loading=!1;service=[];portada=null;form=d({title:"",description:"",features:[],boys_price:0,adults_price:0,code:"",includes:[],notIncludes:[],type:"TOUR",city:"Cartagena",problematic:0,duration_type:"",destinations:"",duration:0,duration_unit:"Dias",recogidas:[],puntos:[],capacidad_min:1,is_round_trip:!0,capacidad_max:1,origen:"",destino:"",tarifa_vehiculo:"",motor:"",size:""});constructor(e){super(),this.service=e,this.url="services",e&&(this.assignMatchingKeys(e,this.form),this.form.includes=JSON.parse(e.includes),this.form.notIncludes=JSON.parse(e.notIncludes),this.form.recogidas=JSON.parse(e.recogidas),this.form.puntos=JSON.parse(e.puntos))}async getProveedorsByService(e){const{data:t}=await s.get(route("get.proveedors.by.service",e));return t.proveedors}async getServices(){const{data:e}=await s.get(route("get.all.services"));return e.services}async getAllFeatures(){const{data:e}=await s.get(route("get.all.features"));return e}async getServicePagination(e=1,t=10){const a={page:e,location:r.location.value,type:r.type.value.value,checkin:r.checkin.value,checkout:r.checkout.value,guests:r.guests.value,perPage:t},{data:c}=await s.get(route("services.get.paginated"),{params:a});return c}async submit(){const e=["includes","notIncludes","recogidas","puntos"],t={};e.forEach(a=>{t[a]=this.form[a],this.form[a]=JSON.stringify(this.form[a])}),super.submit(this.form,this.service?.id??null),e.forEach(a=>{this.form[a]=t[a]})}async setPortada(){o.post(route("set.portada",this.service.slug),{portada:this.portada},{onSuccess:()=>{n("Portada actualizada exitosamente")},onError:e=>{i("Error al actualizar la portada")}})}formatDate(e){const t=new Date(e),a=t.getFullYear(),c=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0");return`${a}-${c}-${l}`}getPrice(){const e=this.service.availabilities.find(t=>this.formatDate(t.start_date)<=this.formatDate(r.checkin.value)&&this.formatDate(t.end_date)>=this.formatDate(r.checkout.value))?.precies??[];return e.length?e.reduce((t,a)=>a.value>t.value?a:t,e[0]).value:0}}export{f as S};
