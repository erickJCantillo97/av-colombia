import{s as U}from"./index-GLcaQ0Om.js";import{d as p,u as A,a0 as w,A as b,B as M,p as E,f as j,o as v,a as l,b as n,h as t,t as g,g as _,c as C,k as O}from"./app-BjdGmPou.js";import{_ as s}from"./Input-BCM11HpD.js";import{a as m,g as B}from"./Toats-CRqRGqmn.js";import{u as N}from"./useCommonUtilities-BgDhORlD.js";import{u as I}from"./Auth-p2MYuzHp.js";import{S as F}from"./Service-utNZCu3w.js";const{hasRole:P}=I(),{currencyFormat:V}=N();class T{loading=p(!1);statuesOptions=[{text:"RESERVADO",color:"blue"},{text:"COMPLETADA",color:"teal"},{text:"CAMBIO DE FECHA",color:"gray"},{text:"NO SHOW",color:"amber"},{text:"REUBICADO",color:"orange"},{text:"CANCELADA",color:"green"},{text:"SIN CONFIRMAR",color:"purple"},{text:"PROBLEMATICA",color:"red"}];channels=p([]);bookingService=p();form=A({id:"",service_id:"",date:"",adults:1,adults_nacionales:0,adults_extranjeros:0,time_service:"",boys:0,boys_nacionales:0,boys_extranjeros:0,cliente_name:"",cliente_phone:"",cliente_city:"",cliente_building:"",reserva:0,method_id:"",channel_id:P("vendedor")?"9d75e9d5-6e8f-48c1-9f56-276fd185297e":"9d99a95f-6c3d-48fd-aa7d-6ef4e6860123",saldo:0,total:0,total_real:0,percent_channel:0,observations:"",code_booking:""});formatDateTime(r,d){const[u,f,x]=r.split("-"),[y,i]=d.split(":");return`${u}-${f}-${x},${y}:${i}`}constructor(r){this.bookingService=r,r&&(console.log(r),Object.keys(this.form).forEach(d=>{r[d]!==void 0&&(this.form[d]=r[d])}),this.form.date=this.formatDateTime(r.date,r.hour))}async create(){if(!this.form.service_id)return m("Selecciona un Servicio");if(!this.form.date)return m("Selecciona una fecha");if(!this.form.channel_id)return m("Selecciona un canal");if(!this.form.cliente_name)return m("Ingresa el nombre del cliente");if(!this.form.cliente_phone)return m("Ingresa el telefono del cliente");if(!this.form.cliente_city)return m("Ingresa la ciudad del cliente");if(!this.form.cliente_building)return m("Ingresa el edificio del cliente");this.form.total_real=this.valorReal.value,this.form.percent_channel=this.channels.value.find(r=>r.id==this.form.channel_id).percent,this.loading.value=!0,this.form.post(route("BookingServices.store")),this.loading.value=!1}async update(){this.form.total_real=this.valorReal.value,this.form.percent_channel=this.channels.value.find(r=>r.id==this.form.channel_id).percent,this.loading.value=!0,this.form.put(route("BookingServices.update",this.bookingService.id)),B("Reserva actualizada Exitosamente"),this.loading.value=!1}async getChannels(){const{data:r}=await w.get(route("channels.index"));return this.channels.value=r,r}async getMethods(){const{data:r}=await w.get(route("paymentMethods.index"));return r}getColorStatus(){return this.statuesOptions.find(r=>r.text==this.bookingService.status.toUpperCase()).color}valorReal=b(()=>{let r=this.channels.value.find(u=>u.id==this.form.channel_id),d=r?r.percent/100:0;return this.form.total-this.form.total*d});valorRealFormat=b(()=>V(this.valorReal.value));valuePasajeros=b(()=>V(this.form.total/this.form.adults));valueCanalVenta=b(()=>{let r=this.channels.value.find(u=>u.id==this.form.channel_id),d=r?r.percent/100:0;return V(this.form.total*d)});updateTotals(){this.form.adults=(parseInt(this.form.adults_nacionales)||0)+(parseInt(this.form.adults_extranjeros)||0),this.form.boys=(parseInt(this.form.boys_nacionales)||0)+(parseInt(this.form.boys_extranjeros)||0)}submit(){return this.updateTotals(),this.bookingService?this.update():this.create()}}const D={class:""},H={class:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 p-3 space-y-2"},$={class:"grid grid-cols-1 md:grid-cols-4 gap-2"},z={class:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 p-3 space-y-2"},L={class:"grid grid-cols-2 md:grid-cols-4 gap-2"},q={class:"grid grid-cols-2 gap-2 bg-blue-50 dark:bg-blue-900/20 p-2 rounded border border-blue-200 dark:border-blue-800"},W={class:"flex items-center justify-center gap-2"},G={class:"text-lg font-bold text-blue-900 dark:text-blue-100"},J={class:"flex items-center justify-center gap-2"},K={class:"text-lg font-bold text-blue-900 dark:text-blue-100"},Q={class:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 p-3 space-y-2"},X={class:"grid grid-cols-1 md:grid-cols-4 gap-2"},Y={class:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 p-3 space-y-2"},Z={class:"grid grid-cols-1 md:grid-cols-4 gap-2"},ee={key:0,class:"grid grid-cols-3 gap-2"},te={class:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 rounded p-2 border border-green-200 dark:border-green-800 text-center"},oe={class:"text-sm font-bold text-green-900 dark:text-green-100"},ae={class:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20 rounded p-2 border border-orange-200 dark:border-orange-800 text-center"},re={class:"text-sm font-bold text-orange-900 dark:text-orange-100"},le={class:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 rounded p-2 border border-blue-200 dark:border-blue-800 text-center"},se={class:"text-sm font-bold text-blue-900 dark:text-blue-100"},ne={class:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 p-3 space-y-2"},de={__name:"FormFirst",props:{bookingService:Object},setup(h){const{hasRole:r}=I(),d=p([]),u=p([]),f=p([]),x=h,y=new F,i=new T(x.bookingService),o=i.form,k=b(()=>{const c=parseInt(o.adults_nacionales)||0,e=parseInt(o.adults_extranjeros)||0;return c+e}),S=b(()=>{const c=parseInt(o.boys_nacionales)||0,e=parseInt(o.boys_extranjeros)||0;return c+e});return M([k,S],([c,e])=>{o.adults=c,o.boys=e}),E(async()=>{d.value=await y.getServices(),u.value=await i.getChannels(),f.value=await i.getMethods(),console.log(u.value)}),(c,e)=>{const R=U;return v(),j("div",D,[l("form",{class:"space-y-3",onSubmit:e[16]||(e[16]=O((...a)=>t(i).submit&&t(i).submit(...a),["prevent"]))},[l("div",H,[e[17]||(e[17]=l("h3",{class:"text-sm font-semibold text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-1.5"}," 游늶 Informaci칩n del Servicio ",-1)),l("div",$,[n(s,{modelValue:t(o).service_id,"onUpdate:modelValue":e[0]||(e[0]=a=>t(o).service_id=a),class:"md:col-span-2",type:"dropdown",label:"Servicio","option-label":"title","option-value":"id",options:d.value},null,8,["modelValue","options"]),n(s,{label:"Fecha de Reserva",modelValue:t(o).date,"onUpdate:modelValue":e[1]||(e[1]=a=>t(o).date=a),enableTimePicker:!0,type:"datetime",class:"md:col-span-1"},null,8,["modelValue"]),n(s,{label:"Tiempo del Servicio",type:"dropdown",modelValue:t(o).time_service,"onUpdate:modelValue":e[2]||(e[2]=a=>t(o).time_service=a),options:["20 Minutos","30 Minutos","40 Minutos","1 Hora","2 Horas","6 Horas","12 Horas","24 Horas"]},null,8,["modelValue"])])]),l("div",z,[e[20]||(e[20]=l("h3",{class:"text-sm font-semibold text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-1.5"}," 游논 Pasajeros ",-1)),l("div",L,[n(s,{label:"Adultos Nac.",type:"number",min:0,modelValue:t(o).adults_nacionales,"onUpdate:modelValue":e[3]||(e[3]=a=>t(o).adults_nacionales=a)},null,8,["modelValue"]),n(s,{label:"Adultos Ext.",type:"number",min:0,modelValue:t(o).adults_extranjeros,"onUpdate:modelValue":e[4]||(e[4]=a=>t(o).adults_extranjeros=a)},null,8,["modelValue"]),n(s,{label:"Ni침os Nac.",type:"number",min:0,modelValue:t(o).boys_nacionales,"onUpdate:modelValue":e[5]||(e[5]=a=>t(o).boys_nacionales=a)},null,8,["modelValue"]),n(s,{label:"Ni침os Ext.",type:"number",min:0,modelValue:t(o).boys_extranjeros,"onUpdate:modelValue":e[6]||(e[6]=a=>t(o).boys_extranjeros=a)},null,8,["modelValue"])]),l("div",q,[l("div",W,[e[18]||(e[18]=l("span",{class:"text-xs text-blue-600 dark:text-blue-400"},"Adultos:",-1)),l("span",G,g(k.value),1)]),l("div",J,[e[19]||(e[19]=l("span",{class:"text-xs text-blue-600 dark:text-blue-400"},"Ni침os:",-1)),l("span",K,g(S.value),1)])])]),l("div",Q,[e[21]||(e[21]=l("h3",{class:"text-sm font-semibold text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-1.5"}," 游녻 Datos del Cliente ",-1)),l("div",X,[n(s,{label:"Nombre del Pasajero",required:!0,modelValue:t(o).cliente_name,"onUpdate:modelValue":e[7]||(e[7]=a=>t(o).cliente_name=a),class:"md:col-span-1"},null,8,["modelValue"]),n(s,{label:"Tel칠fono",type:"number",modelValue:t(o).cliente_phone,"onUpdate:modelValue":e[8]||(e[8]=a=>t(o).cliente_phone=a)},null,8,["modelValue"]),n(s,{label:"Ciudad",modelValue:t(o).cliente_city,"onUpdate:modelValue":e[9]||(e[9]=a=>t(o).cliente_city=a)},null,8,["modelValue"]),n(s,{label:"Edificio u Hotel",modelValue:t(o).cliente_building,"onUpdate:modelValue":e[10]||(e[10]=a=>t(o).cliente_building=a),class:"md:col-span-1"},null,8,["modelValue"])])]),l("div",Y,[e[25]||(e[25]=l("h3",{class:"text-sm font-semibold text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-1.5"}," 游눱 Informaci칩n de Pago ",-1)),l("div",Z,[n(s,{label:"Valor Total",type:"number",mode:"currency",required:!0,modelValue:t(o).total,"onUpdate:modelValue":e[11]||(e[11]=a=>t(o).total=a)},null,8,["modelValue"]),n(s,{label:"Saldo en Sitio",type:"number",mode:"currency",modelValue:t(o).saldo,"onUpdate:modelValue":e[12]||(e[12]=a=>t(o).saldo=a),step:1e3,min:0,max:t(o).total},null,8,["modelValue","max"]),t(r)("vendedor")?_("",!0):(v(),C(s,{key:0,type:"dropdown","option-label":"name","option-value":"id",options:f.value,modelValue:t(o).method_id,"onUpdate:modelValue":e[13]||(e[13]=a=>t(o).method_id=a),label:"Medio de Pago"},null,8,["options","modelValue"])),t(r)("vendedor")?_("",!0):(v(),C(s,{key:1,type:"dropdown","option-label":"name","option-value":"id",options:u.value,modelValue:t(o).channel_id,"onUpdate:modelValue":e[14]||(e[14]=a=>t(o).channel_id=a),label:"Canal de Venta"},null,8,["options","modelValue"]))]),t(r)("vendedor")?_("",!0):(v(),j("div",ee,[l("div",te,[e[22]||(e[22]=l("p",{class:"text-[10px] text-green-700 dark:text-green-400"},"Valor Pasajero",-1)),l("h1",oe,g(t(i).valuePasajeros),1)]),l("div",ae,[e[23]||(e[23]=l("p",{class:"text-[10px] text-orange-700 dark:text-orange-400"},"Comisiones",-1)),l("h1",re,g(t(i).valueCanalVenta),1)]),l("div",le,[e[24]||(e[24]=l("p",{class:"text-[10px] text-blue-700 dark:text-blue-400"},"Total Real",-1)),l("h1",se,g(t(i).valorRealFormat),1)])]))]),l("div",ne,[n(s,{"rows-textarea":2,label:"游눫 Observaciones",modelValue:t(o).observations,"onUpdate:modelValue":e[15]||(e[15]=a=>t(o).observations=a),type:"textarea"},null,8,["modelValue"]),n(R,{type:"submit",severity:"success",label:h.bookingService?"Actualizar Reserva":"Crear Reserva",loading:t(i).loading.value,class:"w-full"},null,8,["label","loading"])])],32)])}}},fe=Object.freeze(Object.defineProperty({__proto__:null,default:de},Symbol.toStringTag,{value:"Module"}));export{T as B,fe as F,de as _};
