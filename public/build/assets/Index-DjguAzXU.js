import{s as w}from"./index-Qm11D7Yh.js";import{s as k}from"./index-BlRyEvBj.js";import{_ as B}from"./Datatable-Begspttk.js";import{a as u,_ as M}from"./Modal-CA7FeCCt.js";import{_ as U}from"./AppLayout-Bj5rvjux.js";import{d as n,C as N,c as $,w as c,o as p,a as s,b as i,u as l,f as _,t as r,W as T}from"./app-CcfUzGB0.js";import{S as q,a as A}from"./toasts-CuGasqAw.js";import"./index-BnFPhFTg.js";import"./index-Dykgw-M0.js";import"./index-BcwJcvj8.js";import"./index-Clt3MpBD.js";import"./index-DIdYPEJW.js";import"./index-DC9F71Rw.js";import"./index-BOgq_siy.js";import"./postcss-uErxTABa.js";import"./index-BnnUvyj1.js";import"./index-DoDPDg0s.js";import"./index-B00YhLaa.js";import"./index-9hsg0wxb.js";import"./useCommonUtilities-DO03hYfs.js";import"./moment-Cijl8gKs.js";import"./index-Blj721Zl.js";import"./index-Cva-qJ4r.js";import"./index-UzE3DAEI.js";import"./index-CgFP6YW0.js";const E={class:"h-[99vh]"},j={class:"flex flex-col gap-y-4"},z={key:0,class:"flex items-center"},L={key:1},O={class:"flex justify-between w-full items-center"},W={class:"text-xs"},D={class:"flex gap-x-4"},_e={__name:"Index",props:{payments:{type:Array,required:!0}},setup(g){const d=n(!1),{toast:m}=A(),f=n([]);n(!1);const t=N({payable_id:"",payable_type:"App\\Models\\Service",method:"",amount:"",currency:"COP",validatePay:!1}),b={action:()=>{d.value=!0}},h=[{action:a=>{q.fire({title:"Confirmar Pago?",text:"Esta seguro de Confirmar este pago?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Si, Confirmar!"}).then(o=>{o.isConfirmed&&(console.log(a),T.post(route("payment.set.state",a.id),{_method:"PUT",status:"Confirmado"},{onSuccess:()=>{m("success","Pago Confirmado con exito")}}))}),x.value=a},severity:"success",icon:"fa-solid fa-wallet text-sm",label:"Validar Pago"}],x=n(),C=a=>{if(t.validatePay&&(t.status="Confirmado"),t.amount==""||t.method==""||t.payable_id==""){m("error","Todos los campos son obligatorios");return}t.payable_id=t.payable_id.id,t.post(route("payments.store"),{onSuccess:()=>{d.value=!1,m("success","Pago Registrado con exito")}})},V=n([]);(()=>{axios.get(route("get.services")).then(a=>{V.value=a.data.services.slice(0,5)})})();const v=n([]);(()=>{axios.get(route("get.services.no.payment")).then(a=>{v.value=Object.values(a.data.bookingNoPayment)})})();const S=[{header:"Servicio",field:"payable.service",filter:!0},{header:"Cliente",field:"payable.cliente_name",filter:!0},{header:"Tipo de Pago",field:"type",filter:!0,format:a=>a.toUpperCase()},{header:"Monto",field:"amount",type:"currency",filter:!0},{header:"Metodo de Pago",field:"metohd_payment.name",filter:!0},{header:"Fecha",field:"created_at",type:"date",filter:!0},{header:"Estado",field:"status",filter:!0,sortable:!0,type:"tag",filtertype:"EQUALS",class:"text-center uppercase",severitys:[{text:"Pendiente",severity:"danger",class:""},{text:"Confirmado",severity:"success",class:""}]}];return(()=>{axios.get(route("paymentMethods.index")).then(a=>{f.value=a.data}).catch(a=>{console.log(a)})})(),(a,o)=>{const P=k,y=w;return p(),$(U,{title:"Pagos"},{default:c(()=>[s("div",E,[i(B,{add:b,columnas:S,actions:h,data:g.payments,title:"Pagos"},null,8,["data"])]),i(M,{modelValue:d.value,"onUpdate:modelValue":o[5]||(o[5]=e=>d.value=e),title:"AÃ±adir Pagos"},{footer:c(()=>[s("div",D,[i(y,{label:"Cancelar",size:"small",severity:"danger",icon:"pi pi-times",onClick:o[4]||(o[4]=e=>d.value=!1)}),i(y,{label:"Guardar",size:"small",severity:"success",icon:"pi pi-save",onClick:C})])]),default:c(()=>[s("form",null,[s("div",j,[s("div",null,[o[6]||(o[6]=s("label",{for:"",class:"font-bold"},"Servicio",-1)),i(P,{options:v.value,filter:"",showClear:"",modelValue:l(t).payable_id,"onUpdate:modelValue":o[0]||(o[0]=e=>l(t).payable_id=e),class:"w-full","option-label":"service",placeholder:"Seleccione un servicio"},{value:c(e=>[e.value?(p(),_("div",z,[s("div",null,r(e.value.service)+" - "+r(e.value.cliente_name),1)])):(p(),_("span",L,r(e.placeholder),1))]),option:c(e=>[s("div",O,[s("div",null,[s("p",null,r(e.option.service)+" - "+r(e.option.cliente_name),1),s("p",W,r(e.option.date)+" "+r(e.option.hour),1)]),s("div",null,r(e.option.total_price_sales),1)])]),_:1},8,["options","modelValue"])]),i(u,{label:"Monto",modelValue:l(t).amount,"onUpdate:modelValue":o[1]||(o[1]=e=>l(t).amount=e),mode:"currency",type:"number",required:""},null,8,["modelValue"]),i(u,{label:"Medio de Pago",class:"w-full",min:"0",type:"dropdown","option-label":"name","option-value":"id",options:f.value,modelValue:l(t).method,"onUpdate:modelValue":o[2]||(o[2]=e=>l(t).method=e),required:""},null,8,["options","modelValue"]),i(u,{checkboxLabel:"Pago Verificado",modelValue:l(t).validatePay,"onUpdate:modelValue":o[3]||(o[3]=e=>l(t).validatePay=e),type:"checkbox",required:""},null,8,["modelValue"])])])]),_:1},8,["modelValue"])]),_:1})}}};export{_e as default};
