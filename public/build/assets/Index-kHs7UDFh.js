import{_ as z}from"./Datatable-B9xeltO6.js";import{_ as G}from"./AppLayout-GG1o9e9g.js";import{a1 as N,a2 as V,d as s,a3 as Y,A as O,f as A,o as g,a as r,b as y,w as I,g as $,h as C,F as D,j as Q,n as Z,t as B,a0 as M,a4 as q,a5 as J,B as K,I as R,R as F,e as X,c as T}from"./app-Daz5hQqP.js";import{a as ee}from"./toasts-CAnEIL5D.js";import{S as te}from"./sweetalert2.esm.all-Y6IUEg8t.js";import{_ as se,a as ae}from"./Notas-CmErOt73.js";import{_ as oe}from"./Modal-fk_tVkIH.js";import{_ as re}from"./Input-2c0UPahG.js";import{_ as le}from"./logo-CaazZSua.js";import"./index-DdayreIq.js";import"./index-CgLYefFZ.js";import"./index-B0UQXbCX.js";import"./index-Bx_4kJFn.js";import"./index-B_6te62D.js";import"./index-VK-jRE3F.js";import"./index-D2D_5DhT.js";import"./index-BwsTNDEX.js";import"./index-oybTknhm.js";import"./index-D57tIMx8.js";import"./index-Cf8uqb4F.js";import"./index-FJewQ5Kq.js";import"./index-CCo-F7CA.js";import"./index-BhC0klEp.js";import"./postcss-CKKfy64Q.js";import"./postcss-C6hvmFKL.js";import"./index-BGM17kiH.js";import"./index-BRFLvT6g.js";import"./useCommonUtilities-BgDhORlD.js";import"./marked.esm-BPgSS2IS.js";import"./Auth-BSRt_T7d.js";import"./index-CgZwvQSx.js";import"./Service-Dq_hvRdu.js";import"./GeneralService-DrVLB8JM.js";import"./Toats-CRqRGqmn.js";import"./searchStore-I8hi7hCl.js";import"./Loading-CHeTVfnu.js";import"./index-Bd2NVFSE.js";import"./index-CUhoAKgl.js";import"./index-CIangVzy.js";import"./index-DY3VNik6.js";import"./index-C8hdP8cj.js";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const ie=()=>{};function ne(b,a,d){let c;N(d)?c={evaluating:d}:c={};const{lazy:x=!1,evaluating:l=void 0,shallow:i=!0,onError:o=ie}=c,_=V(!x),f=i?V(a):s(a);let u=0;return Y(async p=>{if(!_.value)return;u++;const E=u;let m=!1;l&&Promise.resolve().then(()=>{l.value=!0});try{const h=await b(S=>{p(()=>{l&&(l.value=!1),m||S()})});E===u&&(f.value=h)}catch(h){o(h)}finally{l&&E===u&&(l.value=!1),m=!0}}),x?O(()=>(_.value=!0,f.value)):f}const ce={key:0,class:"items-center justify-center flex flex-col"},ue={class:"flex flex-col gap-y-3 h-[60vh] overflow-y-auto"},de={class:"shadow-lg pr-4 rounded-md flex items-center justify-between"},me={class:"text-xl font-bold"},fe={class:"font-bold text-sm"},pe={__name:"Changes",setup(b){const a=s(!1),d=s(),c=ne(async()=>{var{data:l}=await M.get(route("get.states.change",{date:d.value}));return l.status}),x={reservado:"blue","CAMBIO DE FECHA":"gray","NO SHOW":"amber",REUBICADO:"orange",CANCELADA:"green",PROBLEMATICA:"red"};return(l,i)=>(g(),A(D,null,[r("span",{onClick:i[0]||(i[0]=o=>a.value=!0),class:"text-xs font-bold text-blue-800 cursor-pointer"},"Listado de Cambios"),y(oe,{title:"Historial de Cambios",modelValue:a.value,"onUpdate:modelValue":i[2]||(i[2]=o=>a.value=o),"close-on-escape":""},{default:I(()=>[y(re,{"max-date":new Date,type:"date",class:"my-2",modelValue:d.value,"onUpdate:modelValue":i[1]||(i[1]=o=>d.value=o),dateFormat:"dd/mm/yy"},null,8,["max-date","modelValue"]),C(c)&&C(c).length==0?(g(),A("div",ce,[y(le),i[3]||(i[3]=r("p",null,"Sin Cambio Registrados",-1))])):$("",!0),r("div",ue,[(g(!0),A(D,null,Q(C(c),o=>(g(),A("div",de,[r("div",{class:Z(["rounded-l-md text-lg font-bold uppercase",`bg-${x[o.state]}-200 p-2`])},B(o.state),3),r("div",null,[r("p",me,B(o.statable.service),1),r("span",fe,B(o.user.name),1)])]))),256))])]),_:1},8,["modelValue"])],64))}},ve=q("bookingService",()=>{const b=s([]),a=s(null);return{selectDate:b,statusFilter:a}},{persist:{storage:sessionStorage,paths:["selectDate","statusFilter"]}}),ge=[{field:"created_at",header:"Fecha Entrada",filter:!0,sortable:!0,type:"date"},{field:"cliente_name",header:"Nombre del pasajero",filter:!0,sortable:!0},{field:"adults",header:"Pasajeros",filter:!0,sortable:!0},{field:"cliente_building",header:"Edificio u Hotel",filter:!0,sortable:!0},{field:"service",header:"Actividad",filter:!0,sortable:!0},{field:"date",header:"Fecha de la Actividad",filter:!1,type:"date",sortable:!0},{field:"channel.name",header:"Canal de venta",filter:!0,sortable:!0},{field:"proveedors_names",header:"proveedores",class:"text-center font-semibold text-sm",filter:!0},{field:"status",header:"Estado",filter:!0,sortable:!0,type:"text",filtertype:"EQUALS",class:"text-center uppercase",severitys:[{text:"RESERVADO",severity:"info",class:""},{text:"CAMBIO DE FECHA",class:"bg-gray-200 font-bold"},{text:"COMPLETADA",severity:"success",class:""},{text:"NO SHOW",severity:"warn",class:""},{text:"REUBICADO",severity:"warn",class:""},{text:"CANCELADA",severity:"danger",class:"animate-pulse"},{text:"PROBLEMATICA",severity:"danger",class:"animate-pulse"},{text:"SIN CONFIRMAR",severity:"danger"}]}],ye={class:"h-[92vh]"},be={class:"flex py-2 px-4 justify-between items-center"},xe={class:"italic flex flex-col"},_e={class:"text-2xl font-bold"},nt={__name:"Index",props:{bookingServices:Array,serviceType:String},setup(b){const a=b,{toast:d}=ee(),c=s([]),x=s([]),l=s(!1),i=s(""),o=s([]),_=s(!1),f=s(null),u=s(!1),p=s(a.bookingServices),E=ve(),{selectDate:m,statusFilter:h}=J(E),S=O(()=>({TOUR:"Reservas de Tours",EMBARCACION:"Reservas de Embarcaciones",TRANSFER:"Reservas de Transportes"})[a.serviceType]||"Reservas"),U={action:()=>{R.get(route("BookingServices.create"))}},L=async e=>{const t={dates:e};a.serviceType&&(t.type=a.serviceType);const{data:v}=await M.get(route("get.all.booking.services.dates"),{params:t});return v.bookingServices};K([m,h,l],async([e,t,v])=>{if(v){m.value=[new Date("2024-11-02"),new Date],l.value=!1;return}if(!e)p.value=a.bookingServices;else{const n=await L(e);p.value=n}t&&(p.value=p.value.filter(n=>n.status==t))},{immediate:!0});const P=[{label:"Detalles",action:async e=>{f.value=e,_.value=!0},icon:"fa-solid fa-circle-info text-sm",severity:"info"},{label:"Editar",action:async e=>{R.get(route("BookingServices.edit",e.id))},icon:"fa-solid fa-pencil text-sm",severity:"warn"},{label:"Notas",severity:"secondary",action:e=>{o.value=e,u.value=!0},icon:"fa-solid fa-note-sticky text-sm"},{label:"Eliminar",icon:"fa-solid fa-trash text-sm",severity:"danger",show:F().props.auth.user.rol=="admin"||F().props.auth.user.rol=="superadmin",action:e=>{te.fire({title:"Estas Seguro?",text:`Eliminar la reservaciÃ³n de ${e.cliente_name}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Si, Eliminar!"}).then(t=>{t.isConfirmed&&R.delete(route("BookingServices.destroy",e.id),{onSuccess:()=>{d("success","Reserva Eliminada")}})})}}],j=s([]),H=e=>{j.value=e},W=e=>{const t=e[0].getDate(),v=e[0].getMonth()+1,n=e[0].getFullYear(),w=k=>k<10?`0${k}`:k;return`${w(t)}/${w(v)}/${n} - ${w(e[1].getDate())}/${w(e[1].getMonth()+1)}/${e[1].getFullYear()}`};return(e,t)=>{const v=X("VueDatePicker");return g(),A(D,null,[y(G,{title:S.value},{default:I(()=>[t[3]||(t[3]=r("div",{class:"hidden bg-amber-200 bg-orange-200 bg-blue-200 !bg-green-200 !bg-gray-200 !bg-orange-200 !bg-amber-200"},null,-1)),r("div",ye,[r("div",be,[r("div",xe,[r("h1",_e,B(S.value),1),y(pe)]),r("div",null,[y(v,{"hide-offset-dates":"",modelValue:C(m),"onUpdate:modelValue":t[0]||(t[0]=n=>N(m)?m.value=n:null),teleport:!0,format:W,"model-type":"yyyy-MM-dd",range:"","enable-time-picker":!1,locale:"es","multi-calendars":{solo:!0},timezone:"America/Bogota"},null,8,["modelValue"])])]),y(z,{actions:P,add:U,showButtonBar:"",columnas:C(ge),data:p.value,cacheName:"reservas",rowClass:!0,onFilterApply:H},null,8,["columnas","data"])]),f.value?(g(),T(se,{key:0,modelValue:_.value,"onUpdate:modelValue":t[1]||(t[1]=n=>_.value=n),service:f.value,proveedors:c.value},null,8,["modelValue","service","proveedors"])):$("",!0)]),_:1},8,["title"]),u.value?(g(),T(ae,{key:0,modelValue:u.value,"onUpdate:modelValue":t[2]||(t[2]=n=>u.value=n),notes:x.value,note:i.value,service:o.value},null,8,["modelValue","notes","note","service"])):$("",!0)],64)}}};export{nt as default};
