import{G as M,H as F,d as a,I as J,q as K,f as y,o as m,a as s,b as _,w as T,g as V,u as E,F as B,i as L,n as P,t as k,A as H,J as Q,K as Z,L as X,y as R,M as O,e as ee,c as N,m as I,T as te}from"./app-2ma044HW.js";import{_ as oe}from"./Datatable-CIiCX6tL.js";import{_ as se}from"./AppLayout-CidpeDG9.js";import{a as ae}from"./toasts-DiJqYpaW.js";import{S as re}from"./sweetalert2.all-BFQ7WZNl.js";import{_ as le,a as ie}from"./Notas-ByCIrnNB.js";import{_ as ne}from"./Modal-B_nfeE5N.js";import{_ as ue}from"./Input-DNfAKx2O.js";import{_ as ce}from"./logo-W3uxrB1W.js";import"./index-ffIfwkjT.js";import"./index-DH-JKB2w.js";import"./index-DWJF38mr.js";import"./index-D263MXCT.js";import"./index-Fv_tMZxH.js";import"./index-BEO2BeQb.js";import"./index-KCY-5WMz.js";import"./index-BeKdJVwc.js";import"./index-HG_ioRt2.js";import"./index-BK5Zo1o8.js";import"./index-Dt9vp_2a.js";import"./index-C8dXrct2.js";import"./index-DQTmgWe3.js";import"./postcss-DBFS7537.js";import"./postcss-CcW7IdiT.js";import"./index-B9HcFZxs.js";import"./index-CpnZVaCj.js";import"./useCommonUtilities-BgDhORlD.js";import"./marked.esm-BPgSS2IS.js";import"./Auth-Cak7XSP0.js";import"./index-Dxf-_mVP.js";import"./Service-BjdhKN2J.js";import"./Toats-BDB8rBVT.js";import"./searchStore-BblSpjID.js";import"./Loading-DMKgsyti.js";import"./index-BWwS0ZcC.js";import"./index-BmgORl7Z.js";import"./index-C8sqfZSB.js";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const de=()=>{};function me(h,u,v){let c;M(v)?c={evaluating:v}:c={};const{lazy:C=!1,evaluating:l=void 0,shallow:i=!0,onError:r=de}=c,A=F(!C),b=i?F(u):a(u);let d=0;return J(async x=>{if(!A.value)return;d++;const S=d;let f=!1;l&&Promise.resolve().then(()=>{l.value=!0});try{const p=await h(D=>{x(()=>{l&&(l.value=!1),f||D()})});S===d&&(b.value=p)}catch(p){r(p)}finally{l&&S===d&&(l.value=!1),f=!0}}),C?K(()=>(A.value=!0,b.value)):b}const ve={key:0,class:"items-center justify-center flex flex-col"},fe={class:"flex flex-col gap-y-3 h-[60vh] overflow-y-auto"},pe={class:"shadow-lg pr-4 rounded-md flex items-center justify-between"},ge={class:"text-xl font-bold"},be={class:"font-bold text-sm"},xe={__name:"Changes",setup(h){const u=a(!1),v=a(),c=me(async()=>{var{data:l}=await H.get(route("get.states.change",{date:v.value}));return l.status}),C={reservado:"blue","CAMBIO DE FECHA":"gray","NO SHOW":"amber",REUBICADO:"orange",CANCELADA:"green",PROBLEMATICA:"red"};return(l,i)=>(m(),y(B,null,[s("span",{onClick:i[0]||(i[0]=r=>u.value=!0),class:"text-xs font-bold text-blue-800 cursor-pointer"},"Listado de Cambios"),_(ne,{title:"Historial de Cambios",modelValue:u.value,"onUpdate:modelValue":i[2]||(i[2]=r=>u.value=r),"close-on-escape":""},{default:T(()=>[_(ue,{"max-date":new Date,type:"date",class:"my-2",modelValue:v.value,"onUpdate:modelValue":i[1]||(i[1]=r=>v.value=r),dateFormat:"dd/mm/yy"},null,8,["max-date","modelValue"]),E(c)&&E(c).length==0?(m(),y("div",ve,[_(ce),i[3]||(i[3]=s("p",null,"Sin Cambio Registrados",-1))])):V("",!0),s("div",fe,[(m(!0),y(B,null,L(E(c),r=>(m(),y("div",pe,[s("div",{class:P(["rounded-l-md text-lg font-bold uppercase",`bg-${C[r.state]}-200 p-2`])},k(r.state),3),s("div",null,[s("p",ge,k(r.statable.service),1),s("span",be,k(r.user.name),1)])]))),256))])]),_:1},8,["modelValue"])],64))}},ye=Q("bookingService",()=>{const h=a([]),u=a(null);return{selectDate:h,statusFilter:u}},{persist:{storage:sessionStorage,paths:["selectDate","statusFilter"]}}),_e=[{field:"created_at",header:"Fecha Entrada",filter:!0,sortable:!0,type:"date"},{field:"cliente_name",header:"Nombre del pasajero",filter:!0,sortable:!0},{field:"adults",header:"Pasajeros",filter:!0,sortable:!0},{field:"cliente_building",header:"Edificio u Hotel",filter:!0,sortable:!0},{field:"service",header:"Actividad",filter:!0,sortable:!0},{field:"date",header:"Fecha de la Actividad",filter:!1,type:"date",sortable:!0},{field:"channel.name",header:"Canal de venta",filter:!0,sortable:!0},{field:"proveedors_names",header:"proveedores",class:"text-center font-semibold text-sm",filter:!0},{field:"status",header:"Estado",filter:!0,sortable:!0,type:"text",filtertype:"EQUALS",class:"text-center uppercase",severitys:[{text:"RESERVADO",severity:"info",class:""},{text:"CAMBIO DE FECHA",class:"bg-gray-200 font-bold"},{text:"COMPLETADA",severity:"success",class:""},{text:"NO SHOW",severity:"warn",class:""},{text:"REUBICADO",severity:"warn",class:""},{text:"CANCELADA",severity:"danger",class:"animate-pulse"},{text:"PROBLEMATICA",severity:"danger",class:"animate-pulse"},{text:"SIN CONFIRMAR",severity:"danger"}]}],he={class:"h-[92vh]"},Ce={class:"flex py-2 px-4 justify-between items-center"},Ae={class:"italic flex flex-col"},Ee={class:"flex gap-x-2"},$e=["onClick"],we={class:"text-xs font-bold uppercase"},ct={__name:"Index",props:{bookingServices:Array},setup(h){const u=h,{toast:v}=ae(),c=a([]),C=a([]),l=a(!1),i=a(""),r=a([]),A=a(!1),b=a(null),d=a(!1),x=a(u.bookingServices),S=ye(),{selectDate:f,statusFilter:p}=Z(S),D=[{text:"RESERVADO",color:"blue"},{text:"CAMBIO DE FECHA",color:"gray"},{text:"NO SHOW",color:"amber"},{text:"REUBICADO",color:"orange"},{text:"CANCELADA",color:"green"},{text:"SIN CONFIRMAR",color:"red"}],U={action:()=>{R.get(route("BookingServices.create"))}},j=async e=>{const{data:t}=await H.get(route("get.all.booking.services.dates",{dates:e}));return t.bookingServices};X([f,p,l],async([e,t,w])=>{if(w){f.value=[new Date("2024-11-02"),new Date],l.value=!1;return}if(!e)x.value=u.bookingServices;else{const g=await j(e);x.value=g}t&&(x.value=x.value.filter(g=>g.status==t))},{immediate:!0});const W=e=>{p.value=e},z=[{label:"Detalles",action:async e=>{b.value=e,A.value=!0,await getProveedors()},icon:"fa-solid fa-circle-info text-sm",severity:"info"},{label:"Editar",action:async e=>{R.get(route("BookingServices.edit",e.id))},icon:"fa-solid fa-pencil text-sm",severity:"warn"},{label:"Notas",severity:"secondary",action:e=>{r.value=e,d.value=!0},icon:"fa-solid fa-note-sticky text-sm"},{label:"Eliminar",icon:"fa-solid fa-trash text-sm",severity:"danger",show:O().props.auth.user.rol=="admin"||O().props.auth.user.rol=="superadmin",action:e=>{re.fire({title:"Estas Seguro?",text:`Eliminar la reservaciÃ³n de ${e.cliente_name}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Si, Eliminar!"}).then(t=>{t.isConfirmed&&R.delete(route("BookingServices.destroy",e.id),{onSuccess:()=>{v("success","Reserva Eliminada")}})})}}],$=a([]),G=e=>{$.value=e},Y=e=>{const t=e[0].getDate(),w=e[0].getMonth()+1,g=e[0].getFullYear(),o=n=>n<10?`0${n}`:n;return`${o(t)}/${o(w)}/${g} - ${o(e[1].getDate())}/${o(e[1].getMonth()+1)}/${e[1].getFullYear()}`};return(e,t)=>{const w=ee("VueDatePicker"),g=te;return m(),y(B,null,[_(se,{title:"Reservas"},{default:T(()=>[t[6]||(t[6]=s("div",{class:"hidden bg-amber-200 bg-orange-200 bg-blue-200 !bg-green-200 !bg-gray-200 !bg-orange-200 !bg-amber-200"},null,-1)),s("div",he,[s("div",Ce,[s("div",Ae,[t[4]||(t[4]=s("h1",{class:"text-2xl font-bold"},"Reservas",-1)),_(xe)]),s("div",Ee,[I((m(),y("div",{class:"p-2 bg-black text-white text-center rounded-lg cursor-pointer transition-all duration-300 scale-95 hover:scale-100 border-2",onClick:t[0]||(t[0]=o=>p.value=null)},t[5]||(t[5]=[s("p",{class:"text-sm font-bold uppercase"},"Todos",-1)]))),[[g,`${$.value.length} Reservas
                        ${$.value.reduce((o,n)=>o+n.adults,0)} Pasajeros
                        `,void 0,{bottom:!0}]]),(m(),y(B,null,L(D,o=>I(s("div",{onClick:n=>W(o.text),class:P(["flex items-center transition-all duration-300 py-1 px-4 rounded-lg cursor-pointer hover:scale-105 hover:border-b-4 hover:border-gray-800",[`bg-${o.color}-200`,E(p)==o.text?"border-b-4 scale-105 shadow-lg border-gray-800":""]])},[s("p",we,k(o.text),1)],10,$e),[[g,`${$.value.filter(n=>n.status==o.text).length} Reservas
                    ${$.value.filter(n=>n.status==o.text).reduce((n,q)=>n+q.adults,0)} Pasajeros
                    `,void 0,{bottom:!0}]])),64))]),s("div",null,[_(w,{"hide-offset-dates":"",modelValue:E(f),"onUpdate:modelValue":t[1]||(t[1]=o=>M(f)?f.value=o:null),teleport:!0,format:Y,"model-type":"yyyy-MM-dd",range:"","enable-time-picker":!1,locale:"es","multi-calendars":{solo:!0},timezone:"America/Bogota"},null,8,["modelValue"])])]),_(oe,{actions:z,add:U,showButtonBar:"",columnas:E(_e),data:x.value,cacheName:"reservas",rowClass:!0,onFilterApply:G},null,8,["columnas","data"])]),b.value?(m(),N(le,{key:0,modelValue:A.value,"onUpdate:modelValue":t[2]||(t[2]=o=>A.value=o),service:b.value,proveedors:c.value},null,8,["modelValue","service","proveedors"])):V("",!0)]),_:1}),d.value?(m(),N(ie,{key:0,modelValue:d.value,"onUpdate:modelValue":t[3]||(t[3]=o=>d.value=o),notes:C.value,note:i.value,service:r.value},null,8,["modelValue","notes","note","service"])):V("",!0)],64)}}};export{ct as default};
