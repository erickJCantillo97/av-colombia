import{d as V,u as S,A as E,p as C,B as F,f as u,o as g,a as i,g as f,b as r,h as o,t as d,F as w,j as U,k as h}from"./app-Dn5KsD2c.js";import{_ as v}from"./Input-ghybvxy-.js";import{s as y}from"./index-BN0FKXnc.js";import"./index-DNTWODPJ.js";import"./index-DR6pQG3P.js";import"./index-MkQHpa6a.js";import"./index-CT6YQiMJ.js";import"./index-DELeNmm2.js";import"./index-EoFuTiQD.js";import"./index-DDLb-JzL.js";import"./index-BAQvh4r0.js";import"./index-Chzc5Pzv.js";import"./index-C2J1GnwE.js";import"./index-iXiE1s_o.js";import"./index-BsLlquhF.js";import"./index-CdvsRzs8.js";import"./index-CMpHijLN.js";import"./index-De445YOk.js";import"./index-DIGlDJNG.js";import"./index-qRuK0Bcv.js";import"./index-B9zJXf3V.js";import"./useCommonUtilities-BgDhORlD.js";import"./postcss-DzalkE6p.js";import"./postcss-680hWGfA.js";const B={class:"p-2"},$={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},j={class:"bg-gray-50 p-4 rounded-lg"},A={class:"flex justify-between items-center"},I={class:"text-2xl font-bold text-green-600"},D={class:"text-sm text-gray-500 mt-1"},M={key:0,class:"bg-blue-50 p-4 rounded-lg"},N={class:"grid grid-cols-2 gap-4 text-sm"},O={class:"ml-2"},z={class:"ml-2"},L={key:0,class:"mt-2"},P={class:"flex flex-wrap gap-1 mt-1"},R={class:"flex justify-end space-x-3 pt-4 border-t"},ge={__name:"TicketForm",props:{ticketTypes:Array,bookingServices:Array,editingTicket:Object,isEditing:{type:Boolean,default:!1}},emits:["ticket-created","close"],setup(c,{emit:T}){const s=c,b=T,n=V(1e4),e=S({ticket_type_id:null,booking_service_id:null,cantidad:1,costo_total:0,tipo_movimiento:"entrada"}),m=E(()=>s.ticketTypes.find(a=>a.id===e.ticket_type_id)),p=()=>{const a=parseInt(e.cantidad)||0,t=parseFloat(n.value)||0;e.costo_total=a*t},_=a=>parseFloat(a||0).toLocaleString("es-CO",{minimumFractionDigits:2,maximumFractionDigits:2}),x=()=>{s.isEditing&&s.editingTicket?e.put(route("tickets.update",s.editingTicket.id),{onSuccess:()=>{b("ticket-created"),k()},onError:a=>{console.error("Error al actualizar ticket:",a)}}):e.post(route("pagoEntradas.storeTicket"),{onSuccess:()=>{b("ticket-created"),k()},onError:a=>{console.error("Error al crear ticket:",a)}})},k=()=>{e.reset(),n.value=1e4};return C(()=>{s.isEditing&&s.editingTicket?(e.ticket_type_id=s.editingTicket.ticket_type_id,e.booking_service_id=s.editingTicket.booking_service_id,e.cantidad=s.editingTicket.cantidad,e.costo_total=s.editingTicket.costo_total,e.tipo_movimiento=s.editingTicket.tipo_movimiento,s.editingTicket.cantidad>0&&(n.value=s.editingTicket.costo_total/s.editingTicket.cantidad)):k()}),F([()=>e.cantidad,n],p),p(),(a,t)=>(g(),u("div",B,[i("form",{onSubmit:h(x,["prevent"]),class:"space-y-6"},[i("div",$,[i("div",null,[r(v,{label:"Tipo de Ticket",modelValue:o(e).ticket_type_id,"onUpdate:modelValue":t[0]||(t[0]=l=>o(e).ticket_type_id=l),type:"dropdown","option-value":"id","option-label":"name",options:c.ticketTypes,"error-message":o(e).errors.ticket_type_id,placeholder:"Selecciona un tipo de ticket",onValueChange:p},null,8,["modelValue","options","error-message"])]),i("div",null,[r(v,{label:"Cliente (Opcional)",modelValue:o(e).booking_service_id,"onUpdate:modelValue":t[1]||(t[1]=l=>o(e).booking_service_id=l),type:"dropdown","option-value":"id","option-label":"client_name",options:c.bookingServices,"error-message":o(e).errors.booking_service_id,placeholder:"Selecciona un cliente"},null,8,["modelValue","options","error-message"])]),i("div",null,[r(v,{label:"Cantidad",modelValue:o(e).cantidad,"onUpdate:modelValue":t[2]||(t[2]=l=>o(e).cantidad=l),type:"number",min:1,"error-message":o(e).errors.cantidad,placeholder:"Ingresa la cantidad",onInput:p},null,8,["modelValue","error-message"])]),i("div",null,[r(v,{label:"Precio por Ticket",modelValue:n.value,"onUpdate:modelValue":t[3]||(t[3]=l=>n.value=l),type:"number",step:"1000",min:0,placeholder:"Precio por ticket",onInput:p},null,8,["modelValue"])]),i("div",null,[r(v,{label:"Tipo de Movimiento",modelValue:o(e).tipo_movimiento,"onUpdate:modelValue":t[4]||(t[4]=l=>o(e).tipo_movimiento=l),type:"dropdown","option-value":"value","option-label":"label",options:[{label:"Entrada",value:"entrada"},{label:"Salida",value:"salida"}],"error-message":o(e).errors.tipo_movimiento,placeholder:"Selecciona tipo de movimiento"},null,8,["modelValue","error-message"])])]),i("div",j,[i("div",A,[t[6]||(t[6]=i("span",{class:"text-lg font-medium text-gray-700"},"Costo Total:",-1)),i("span",I," $"+d(_(o(e).costo_total)),1)]),i("div",D,d(o(e).cantidad||0)+" tickets Ã— $"+d(_(n.value)),1)]),m.value?(g(),u("div",M,[t[10]||(t[10]=i("h4",{class:"font-semibold text-blue-800 mb-2"},"Resumen del Ticket",-1)),i("div",N,[i("div",null,[t[7]||(t[7]=i("span",{class:"text-blue-600 font-medium"},"Tipo:",-1)),i("span",O,d(m.value.name),1)]),i("div",null,[t[8]||(t[8]=i("span",{class:"text-blue-600 font-medium"},"Servicios asociados:",-1)),i("span",z,d(m.value.services?.length||0),1)])]),m.value.services?.length>0?(g(),u("div",L,[t[9]||(t[9]=i("span",{class:"text-blue-600 font-medium text-sm"},"Servicios:",-1)),i("div",P,[(g(!0),u(w,null,U(m.value.services,l=>(g(),u("span",{key:l.id,class:"inline-block px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full"},d(l.title),1))),128))])])):f("",!0)])):f("",!0),i("div",R,[r(o(y),{type:"button",label:"Cancelar",severity:"secondary",outlined:"",onClick:t[5]||(t[5]=l=>a.$emit("close"))}),r(o(y),{type:"submit",label:c.isEditing?"Actualizar Ticket":"Comprar Tickets",severity:"success",icon:c.isEditing?"fa-solid fa-save":"fa-solid fa-shopping-cart",loading:o(e).processing},null,8,["label","icon","loading"])])],32)]))}};export{ge as default};
