import{_ as H}from"./Datatable-BkLSTZK5.js";import{_ as W}from"./AppLayout-046R_RQn.js";import{O,P as F,d as s,Q as z,v as G,f as C,o as v,a as o,b as g,w as M,g as $,u as A,F as V,i as Q,n as Y,t as B,N as I,R as Z,U as q,E as J,m as D,y as R,e as K,c as N}from"./app-QJWR2dcj.js";import{a as X}from"./toasts-Dmclcgp1.js";import{S as ee}from"./sweetalert2.all-aXzOV0r8.js";import{_ as te,a as se}from"./Notas-5gVwfUjS.js";import{_ as ae}from"./Modal-BE8CmZJu.js";import{_ as oe}from"./Input-rA03rjHd.js";import{_ as re}from"./logo-BOYtERcx.js";import"./index-B6FU2OPi.js";import"./index-CY7Q0EBF.js";import"./index-sWbMTZwI.js";import"./index-BS8Uk91E.js";import"./index-CcA5YYpZ.js";import"./index-J5NRoLkn.js";import"./index-l_IBLBHU.js";import"./index-m9yrcgqL.js";import"./index-Cmelgjyn.js";import"./index-BuVitAOF.js";import"./index-DSJGW0BS.js";import"./index-CtN23weB.js";import"./index-BsQsxdSu.js";import"./index-DswH6krw.js";import"./postcss-RR0TXq3r.js";import"./postcss-DAZiDuP2.js";import"./index-CLcJA-yB.js";import"./index-DehBDAu7.js";import"./useCommonUtilities-BgDhORlD.js";import"./marked.esm-BPgSS2IS.js";import"./Auth-DkVdEcEO.js";import"./index-kwUEleoM.js";import"./Service-BaStgb_T.js";import"./Toats-CVGAhVjE.js";import"./searchStore-GxRvVDzl.js";import"./Loading-0F7mYofQ.js";import"./index-DWA9C5Fi.js";import"./index-CpoHuY24.js";import"./index-DH3fsyab.js";import"./index-DEI4HB0J.js";import"./index-DXysdgsf.js";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const le=()=>{};function ie(y,i,d){let u;O(d)?u={evaluating:d}:u={};const{lazy:b=!1,evaluating:r=void 0,shallow:l=!0,onError:a=le}=u,x=F(!b),f=l?F(i):s(i);let c=0;return z(async p=>{if(!x.value)return;c++;const E=c;let m=!1;r&&Promise.resolve().then(()=>{r.value=!0});try{const _=await y(S=>{p(()=>{r&&(r.value=!1),m||S()})});E===c&&(f.value=_)}catch(_){a(_)}finally{r&&E===c&&(r.value=!1),m=!0}}),b?G(()=>(x.value=!0,f.value)):f}const ne={key:0,class:"items-center justify-center flex flex-col"},ue={class:"flex flex-col gap-y-3 h-[60vh] overflow-y-auto"},ce={class:"shadow-lg pr-4 rounded-md flex items-center justify-between"},de={class:"text-xl font-bold"},me={class:"font-bold text-sm"},fe={__name:"Changes",setup(y){const i=s(!1),d=s(),u=ie(async()=>{var{data:r}=await I.get(route("get.states.change",{date:d.value}));return r.status}),b={reservado:"blue","CAMBIO DE FECHA":"gray","NO SHOW":"amber",REUBICADO:"orange",CANCELADA:"green",PROBLEMATICA:"red"};return(r,l)=>(v(),C(V,null,[o("span",{onClick:l[0]||(l[0]=a=>i.value=!0),class:"text-xs font-bold text-blue-800 cursor-pointer"},"Listado de Cambios"),g(ae,{title:"Historial de Cambios",modelValue:i.value,"onUpdate:modelValue":l[2]||(l[2]=a=>i.value=a),"close-on-escape":""},{default:M(()=>[g(oe,{"max-date":new Date,type:"date",class:"my-2",modelValue:d.value,"onUpdate:modelValue":l[1]||(l[1]=a=>d.value=a),dateFormat:"dd/mm/yy"},null,8,["max-date","modelValue"]),A(u)&&A(u).length==0?(v(),C("div",ne,[g(re),l[3]||(l[3]=o("p",null,"Sin Cambio Registrados",-1))])):$("",!0),o("div",ue,[(v(!0),C(V,null,Q(A(u),a=>(v(),C("div",ce,[o("div",{class:Y(["rounded-l-md text-lg font-bold uppercase",`bg-${b[a.state]}-200 p-2`])},B(a.state),3),o("div",null,[o("p",de,B(a.statable.service),1),o("span",me,B(a.user.name),1)])]))),256))])]),_:1},8,["modelValue"])],64))}},pe=Z("bookingService",()=>{const y=s([]),i=s(null);return{selectDate:y,statusFilter:i}},{persist:{storage:sessionStorage,paths:["selectDate","statusFilter"]}}),ve=[{field:"created_at",header:"Fecha Entrada",filter:!0,sortable:!0,type:"date"},{field:"cliente_name",header:"Nombre del pasajero",filter:!0,sortable:!0},{field:"adults",header:"Pasajeros",filter:!0,sortable:!0},{field:"cliente_building",header:"Edificio u Hotel",filter:!0,sortable:!0},{field:"service",header:"Actividad",filter:!0,sortable:!0},{field:"date",header:"Fecha de la Actividad",filter:!1,type:"date",sortable:!0},{field:"channel.name",header:"Canal de venta",filter:!0,sortable:!0},{field:"proveedors_names",header:"proveedores",class:"text-center font-semibold text-sm",filter:!0},{field:"status",header:"Estado",filter:!0,sortable:!0,type:"text",filtertype:"EQUALS",class:"text-center uppercase",severitys:[{text:"RESERVADO",severity:"info",class:""},{text:"CAMBIO DE FECHA",class:"bg-gray-200 font-bold"},{text:"COMPLETADA",severity:"success",class:""},{text:"NO SHOW",severity:"warn",class:""},{text:"REUBICADO",severity:"warn",class:""},{text:"CANCELADA",severity:"danger",class:"animate-pulse"},{text:"PROBLEMATICA",severity:"danger",class:"animate-pulse"},{text:"SIN CONFIRMAR",severity:"danger"}]}],ge={class:"h-[92vh]"},ye={class:"flex py-2 px-4 justify-between items-center"},be={class:"italic flex flex-col"},rt={__name:"Index",props:{bookingServices:Array},setup(y){const i=y,{toast:d}=X(),u=s([]),b=s([]),r=s(!1),l=s(""),a=s([]),x=s(!1),f=s(null),c=s(!1),p=s(i.bookingServices),E=pe(),{selectDate:m,statusFilter:_}=q(E),S={action:()=>{D.get(route("BookingServices.create"))}},P=async e=>{const{data:t}=await I.get(route("get.all.booking.services.dates",{dates:e}));return t.bookingServices};J([m,_,r],async([e,t,h])=>{if(h){m.value=[new Date("2024-11-02"),new Date],r.value=!1;return}if(!e)p.value=i.bookingServices;else{const n=await P(e);p.value=n}t&&(p.value=p.value.filter(n=>n.status==t))},{immediate:!0});const U=[{label:"Detalles",action:async e=>{f.value=e,x.value=!0,await getProveedors()},icon:"fa-solid fa-circle-info text-sm",severity:"info"},{label:"Editar",action:async e=>{D.get(route("BookingServices.edit",e.id))},icon:"fa-solid fa-pencil text-sm",severity:"warn"},{label:"Notas",severity:"secondary",action:e=>{a.value=e,c.value=!0},icon:"fa-solid fa-note-sticky text-sm"},{label:"Eliminar",icon:"fa-solid fa-trash text-sm",severity:"danger",show:R().props.auth.user.rol=="admin"||R().props.auth.user.rol=="superadmin",action:e=>{ee.fire({title:"Estas Seguro?",text:`Eliminar la reservaciÃ³n de ${e.cliente_name}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Si, Eliminar!"}).then(t=>{t.isConfirmed&&D.delete(route("BookingServices.destroy",e.id),{onSuccess:()=>{d("success","Reserva Eliminada")}})})}}],L=s([]),T=e=>{L.value=e},j=e=>{const t=e[0].getDate(),h=e[0].getMonth()+1,n=e[0].getFullYear(),w=k=>k<10?`0${k}`:k;return`${w(t)}/${w(h)}/${n} - ${w(e[1].getDate())}/${w(e[1].getMonth()+1)}/${e[1].getFullYear()}`};return(e,t)=>{const h=K("VueDatePicker");return v(),C(V,null,[g(W,{title:"Reservas"},{default:M(()=>[t[4]||(t[4]=o("div",{class:"hidden bg-amber-200 bg-orange-200 bg-blue-200 !bg-green-200 !bg-gray-200 !bg-orange-200 !bg-amber-200"},null,-1)),o("div",ge,[o("div",ye,[o("div",be,[t[3]||(t[3]=o("h1",{class:"text-2xl font-bold"},"Reservas",-1)),g(fe)]),o("div",null,[g(h,{"hide-offset-dates":"",modelValue:A(m),"onUpdate:modelValue":t[0]||(t[0]=n=>O(m)?m.value=n:null),teleport:!0,format:j,"model-type":"yyyy-MM-dd",range:"","enable-time-picker":!1,locale:"es","multi-calendars":{solo:!0},timezone:"America/Bogota"},null,8,["modelValue"])])]),g(H,{actions:U,add:S,showButtonBar:"",columnas:A(ve),data:p.value,cacheName:"reservas",rowClass:!0,onFilterApply:T},null,8,["columnas","data"])]),f.value?(v(),N(te,{key:0,modelValue:x.value,"onUpdate:modelValue":t[1]||(t[1]=n=>x.value=n),service:f.value,proveedors:u.value},null,8,["modelValue","service","proveedors"])):$("",!0)]),_:1}),c.value?(v(),N(se,{key:0,modelValue:c.value,"onUpdate:modelValue":t[2]||(t[2]=n=>c.value=n),notes:b.value,note:l.value,service:a.value},null,8,["modelValue","notes","note","service"])):$("",!0)],64)}}};export{rt as default};
