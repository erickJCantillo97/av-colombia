import{_ as N}from"./Datatable-Dh3w8uY7.js";import{Q as B,O as D,d as x,u as z,A as T,f as a,o as l,a as o,b as c,w as p,h as r,g as y,F as h,j as C,n as F,t as u,i as U,I as G}from"./app-B8m0nNYc.js";import{s as M}from"./index-BjXbKqwh.js";import{M as q}from"./Modal-l5bxqxph.js";import{_ as S}from"./Input-C3s4g0tj.js";import{s as w}from"./index-Dr8cmIQ0.js";import"./index-BYPyNz6W.js";import"./index-D0ZItSoF.js";import"./index-BC9WllNl.js";import"./index-CEGAZWTK.js";import"./index-DAGH-nF_.js";import"./index-DNDlol-m.js";import"./index-CJX1Y8eb.js";import"./index-Zq11piMN.js";import"./index-BV8QaNMJ.js";import"./index-BDfQAeee.js";import"./index-CpCYixKq.js";import"./index-CstxKFuQ.js";import"./index-DxyWWUVO.js";import"./index-BglhNePU.js";import"./index-DFvRsSh3.js";import"./index-8otDII8u.js";import"./useCommonUtilities-BgDhORlD.js";import"./postcss-BvsocDeF.js";import"./postcss-DW3B03dX.js";import"./index-DQYm0Si2.js";import"./index-Dsq7Vfvu.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-B7GjwrnR.js";import"./index-XcQ6uK0N.js";import"./index-AlClQI3H.js";import"./index-BzDCOY73.js";const I={class:"h-[99vh]"},O={class:"text-xl font-bold white-space-nowrap"},P={key:0,class:"fa-solid fa-plus"},Q={key:1,class:"fa-solid fa-pencil"},H={class:"flex gap-x-3 py-2"},J={class:"grid grid-cols-1 w-full shadow-2xl border rounded-md gap-4 p-6"},K={class:"w-full"},R={class:"max-h-64 overflow-y-auto border border-gray-200 rounded-md p-2"},W={class:"grid grid-cols-1 gap-2"},X=["onClick"],Y={class:"flex items-center justify-between"},Z={class:"font-medium text-sm"},ee={key:0,class:"fa-solid fa-check text-blue-600"},se={key:0,class:"text-red-500 text-sm mt-1"},te={key:1,class:"mt-4"},ie={class:"text-sm font-medium text-gray-700 mb-2"},oe={class:"flex flex-wrap gap-2"},re=["onClick"],Ue={__name:"Index",props:{ticketTypes:Array,services:Array},setup(_){const f=_,V=[{header:"Tipo de Ticket",field:"name",filter:!0},{header:"Servicios Asociados",field:"services_count",filter:!1,type:"html-custom",renderer:s=>{const e=s.services?s.services.length:0;return`<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                ${e} servicio${e!==1?"s":""}
              </span>`}},{header:"Servicios",field:"services_list",filter:!1,type:"html-custom",renderer:s=>{if(!s.services||s.services.length===0)return'<span class="text-gray-500 italic">Sin servicios</span>';const e=s.services.map(g=>g.title).join(", "),i=e.length>50?e.substring(0,50)+"...":e;return`<span class="text-sm" title="${e}">${i}</span>`}}],v=B(),$=D(),d=x(!1),n=x(!1),m=x(""),t=z({id:null,name:"",services:[]}),j={action:()=>{t.reset(),d.value=!1,n.value=!0}},A=[{action:s=>{t.reset(),n.value=!0,d.value=!0,t.id=s.id,t.name=s.name,t.services=s.services?s.services.map(e=>e.id):[]},severity:"secondary",icon:"fa-solid fa-pencil text-sm"},{action:(s,e)=>{$.require({target:e.currentTarget,message:"¿Seguro de eliminar el tipo de ticket "+s.name+"?",icon:"fa-solid fa-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-sm p-button-danger",rejectLabel:"Cancelar",acceptLabel:"Eliminar",accept:()=>{G.delete(route("ticketTypes.destroy",s.id),{onSuccess:()=>{v.add({severity:"error",icon:"fa-solid fa-trash-can",summary:"¡Acción realizada!",detail:"Tipo de ticket eliminado con éxito",group:"customTooltipDataTable",life:5e3})}})}})},severity:"danger",icon:"fa-regular fa-trash-can text-sm"}],L=T(()=>m.value?f.services.filter(s=>s.title.toLowerCase().includes(m.value.toLowerCase())):f.services),b=T(()=>f.services.filter(s=>t.services.includes(s.id))),k=s=>{t.services.includes(s)?t.services=t.services.filter(e=>e!==s):t.services.push(s)},E=()=>{d.value?t.put(route("ticketTypes.update",t.id),{onSuccess:()=>{n.value=!1,v.add({severity:"success",icon:"fa-solid fa-check",summary:"¡Éxito!",detail:"Tipo de ticket actualizado con éxito",group:"customTooltipDataTable",life:3e3})}}):t.post(route("ticketTypes.store"),{onSuccess:()=>{n.value=!1,v.add({severity:"success",icon:"fa-solid fa-check",summary:"¡Éxito!",detail:"Tipo de ticket creado con éxito",group:"customTooltipDataTable",life:3e3})}})};return(s,e)=>(l(),a(h,null,[o("div",I,[c(N,{columnas:V,add:j,data:_.ticketTypes,actions:A},null,8,["data"])]),c(q,{visible:n.value,"onUpdate:visible":e[3]||(e[3]=i=>n.value=i),width:"70vw","close-on-escape":""},{title:p(()=>[o("span",O,u(d.value?"Editar":"Agregar")+" Tipo de Ticket ",1)]),icon:p(()=>[d.value?(l(),a("i",Q)):(l(),a("i",P))]),footer:p(()=>[c(r(w),{onClick:E,title:"Guardar",severity:"success",label:"Guardar",outlined:"",icon:"fa-solid fa-save",class:"!h-8",loading:r(t).processing},null,8,["loading"]),c(r(w),{onClick:e[2]||(e[2]=i=>n.value=!1),title:"Cancelar",severity:"danger",label:"Cancelar",outlined:"",icon:"fa-solid fa-times",class:"!h-8"})]),default:p(()=>[o("div",H,[o("div",J,[c(S,{label:"Nombre del Tipo de Ticket",modelValue:r(t).name,"onUpdate:modelValue":e[0]||(e[0]=i=>r(t).name=i),"error-message":r(t).errors.name,placeholder:"Ej: Ticket VIP, Ticket Estándar, etc."},null,8,["modelValue","error-message"]),o("div",K,[e[5]||(e[5]=o("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Servicios Asociados ",-1)),c(S,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=i=>m.value=i),placeholder:"Buscar servicios...",class:"mb-3"},null,8,["modelValue"]),o("div",R,[o("div",W,[(l(!0),a(h,null,C(L.value,i=>(l(),a("div",{key:i.id,onClick:g=>k(i.id),class:F([{"bg-blue-100 border-blue-500":r(t).services.includes(i.id),"bg-gray-50 border-gray-200":!r(t).services.includes(i.id)},"p-3 rounded-md cursor-pointer border-2 hover:bg-blue-50 transition-colors duration-200"])},[o("div",Y,[o("span",Z,u(i.title),1),r(t).services.includes(i.id)?(l(),a("i",ee)):y("",!0)])],10,X))),128))])]),r(t).errors.services?(l(),a("div",se,u(r(t).errors.services),1)):y("",!0),b.value.length>0?(l(),a("div",te,[o("h4",ie," Servicios Seleccionados ("+u(b.value.length)+") ",1),o("div",oe,[(l(!0),a(h,null,C(b.value,i=>(l(),a("span",{key:i.id,class:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},[U(u(i.title)+" ",1),o("button",{onClick:g=>k(i.id),class:"ml-2 inline-flex items-center justify-center w-4 h-4 rounded-full bg-blue-200 hover:bg-blue-300"},[...e[4]||(e[4]=[o("i",{class:"fa-solid fa-times text-xs"},null,-1)])],8,re)]))),128))])])):y("",!0)])])])]),_:1},8,["visible"]),c(r(M))],64))}};export{Ue as default};
