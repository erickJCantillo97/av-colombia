import{y as o,x as d,A as s}from"./app-4jSWbsFf.js";import{a as i,g as n}from"./Toats-BtnnowQq.js";import{s as a}from"./searchStore-BkQHvwBB.js";class p{url=null;assignMatchingKeys(t,e){Object.keys(t).forEach(r=>{r in e&&(e[r]=t[r])})}submit(t,e=null){return e?o.put(route(this.url+".update",e),t,{onSuccess:()=>{n("Actualizado Exitosamente")},onError:r=>{i(r.response.data.message||"Error al actualizar")}}):o.post(route(this.url+".store"),t,{onSuccess:()=>{n("Guardado Exitosamente")},onError:r=>{i(r.response.data.message||"Error al guardar")}})}delete(t){return o.delete(route(this.url+".destroy",t),{onSuccess:()=>{n("Eliminado Exitosamente")},onError:e=>{i(e.response.data.message||"Error al eliminar")}})}}class f extends p{loading=!1;service=[];portada=null;form=d({title:"",description:"",features:[],boys_price:0,adults_price:0,code:"",includes:[],notIncludes:[],type:"TOUR",city:"Cartagena",problematic:0,duration_type:"",destinations:"",duration:0,duration_unit:"Dias",recogidas:[],puntos:[],capacidad_min:1,is_round_trip:!0,capacidad_max:1,origen:"",destino:"",tarifa_vehiculo:"",motor:"",size:""});constructor(t){super(),this.service=t,this.url="services",t&&(this.assignMatchingKeys(t,this.form),this.form.is_round_trip=t.is_round_trip==1,this.form.includes=JSON.parse(t.includes),this.form.notIncludes=JSON.parse(t.notIncludes),this.form.recogidas=JSON.parse(t.recogidas),this.form.puntos=JSON.parse(t.puntos))}async getProveedorsByService(t){const{data:e}=await s.get(route("get.proveedors.by.service",t));return e.proveedors}async getServices(){const{data:t}=await s.get(route("get.all.services"));return t.services}async getAllFeatures(){const{data:t}=await s.get(route("get.all.features"));return t}async getServicePagination(t=1,e=10){const r={page:t,location:a.location.value,type:a.type.value.value,checkin:a.checkin.value,checkout:a.checkout.value,guests:a.guests.value,perPage:e},{data:c}=await s.get(route("services.get.paginated"),{params:r});return c}async submit(){const t=["includes","notIncludes","recogidas","puntos"],e={};t.forEach(r=>{e[r]=this.form[r],this.form[r]=JSON.stringify(this.form[r])}),super.submit(this.form,this.service?.id??null),t.forEach(r=>{this.form[r]=e[r]})}async setPortada(){o.post(route("set.portada",this.service.slug),{portada:this.portada},{onSuccess:()=>{n("Portada actualizada exitosamente")},onError:t=>{i("Error al actualizar la portada")}})}formatDate(t){const e=new Date(t),r=e.getFullYear(),c=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getDate()).padStart(2,"0");return`${r}-${c}-${l}`}getPrice(){const t=this.service.availabilities.find(e=>this.formatDate(e.start_date)<=this.formatDate(a.checkin.value)&&this.formatDate(e.end_date)>=this.formatDate(a.checkout.value))?.precies??[];return t.length?t.reduce((e,r)=>r.value>e.value?r:e,t[0]).value:0}}export{f as S};
