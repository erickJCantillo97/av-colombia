import{s as B}from"./index-DjixC-nJ.js";import{d as n,x as P,q as F,B as R,f as V,o as f,a as s,g as x,b as i,c as U,u as g,A as N,y as S}from"./app-k8w_-KfF.js";import{a as M}from"./toasts-Bf1FAz7R.js";import{_ as y}from"./Input-Di7WTPwP.js";import j from"./DetailsTypeReserva-120GO6xT.js";import{a as z}from"./useCommonUtilities-EmANIG9p.js";import"./index-CJnFwoxB.js";import"./index-DiOcfoyk.js";import"./index-CZymkh2B.js";import"./index-DhQtuUhP.js";import"./index-DfYKEzlW.js";import"./index-2WJJ6Twp.js";import"./index-BgyvoNnr.js";import"./index-BK5B2x_l.js";import"./index-Cw-UQAl-.js";import"./index-CjU7yBN9.js";import"./index-DqN09_0m.js";import"./sweetalert2.esm.all-DV3w3JmD.js";import"./index-C4kXc4uj.js";import"./index-BWFoV7w1.js";import"./index-Dx3__UjX.js";import"./index-CseFBRIG.js";import"./index-C6y8MRJ9.js";import"./index-Bz4_12Ih.js";import"./filepond-plugin-image-preview.min-BeGNjneI.js";import"./index-BY3IReMZ.js";import"./index-BrPtZSH0.js";import"./postcss-SYbNkDwX.js";import"./index-C-lvVkP5.js";import"./ItemDetailTypeReserva-Cp1pbOyq.js";const H={class:"gap-y-2 flex flex-col"},L={class:"flex flex-col md:flex-row gap-x-2 items-center"},$={class:"flex flex-col w-full justify-between font-bold"},q={key:0,class:"flex flex-col gap-y-2"},W={class:"flex flex-col w-full justify-between font-bold"},h={class:"grid grid-cols-1 md:grid-cols-3 gap-x-4"},G={class:"flex justify-end gap-x-2"},J=["loading"],_e={__name:"Form",props:{payment:Array},setup(E){const D=n(!1),{toast:A}=M(),l=E,p=t=>{if(t==null||t==null)return"Sin definir";var e=new Date(new Date(t).getTime()+new Date(t).getTimezoneOffset()*6e4);return e},m=n(!1),a=P({date:new Date,startDate:new Date,endDate:new Date,amount:0,proveedor_id:"",file:"",description:""}),C=n([]),d=n([new Date,new Date]),u=n(),_=n([]),r=n(),b=n(null),v=n(0),w=()=>{N.get(route("get.booking.time.range"),{params:{start_date:new Date(d.value[0]).toISOString().split("T")[0],end_date:new Date(d.value[1]).toISOString().split("T")[0]}}).then(t=>{C.value=t.data.proveedores,u.value=t.data.bookingTimeRange.filter(e=>{let c=r.value;return e.proveedors.map(k=>k.proveedor_id).includes(c)}),v.value=z(u.value,r.value),_.value=[{name:"RESERVADO",value:u.value.filter(e=>e.status=="RESERVADO"),color:"bg-blue-200"},{name:"COMPLETADA",value:u.value.filter(e=>e.status=="COMPLETADA"),color:"bg-green-200"},{name:"CANCELADA",value:u.value.filter(e=>e.status=="CANCELADA"),color:"bg-red-200"},{name:"NO SHOW",value:u.value.filter(e=>e.status=="NO SHOW"),color:"bg-yellow-200"},{name:"CAMBIO DE FECHA",value:u.value.filter(e=>e.status=="CAMBIO DE FECHA"),color:"bg-gray-200"},{name:"REUBICADO",value:u.value.filter(e=>e.status=="REUBICADO"),color:"bg-yellow-200"}]})};function T(t){a.file=t.target.files[0]}const I=()=>{m.value=!0;let t=new FormData;if(t.append("proveedor_id",r.value),t.append("amount",a.amount),t.append("comprobante",a.file),t.append("date",new Date(a.date).toISOString().split("T")[0]),t.append("startDate",new Date(d.value[0]).toISOString().split("T")[0]),t.append("endDate",new Date(d.value[1]).toISOString().split("T")[0]),t.append("description",a.description),b.value){S.post(route("paymentProveedors.update",b.value),t,{onSuccess:()=>{A("success","Pago Actualizado con exito"),m.value=!1,D.value=!1}});return}S.post(route("paymentProveedors.store"),t,{onSuccess:()=>{A("success","Pago Actualizado con exito"),m.value=!1,D.value=!1}})},O=F(()=>v.value-a.amount);return R(()=>{l.payment&&(b.value=l.payment.id,a.date=p(l.payment.date),a.startDate=p(l.payment.startDate),a.endDate=p(l.payment.endDate),a.amount=l.payment.amount,a.proveedor_id=l.payment.proveedor_id,a.description=l.payment.description,d.value=[p(l.payment.startDate),p(l.payment.endDate)],r.value=l.payment.proveedor_id,w())}),(t,e)=>{const c=B;return f(),V("div",H,[s("div",L,[s("div",$,[e[7]||(e[7]=s("p",null,"Fechas",-1)),i(c,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=o=>d.value=o),selectionMode:"range",dateFormat:"dd/mm/yy",class:"w-full h-9",manualInput:!1,onValueChange:w},null,8,["modelValue"])]),i(y,{label:"Proveedor",type:"dropdown","option-label":"proveedor","option-value":"proveedor_id",onValueChange:w,class:"w-full",modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=o=>r.value=o),options:C.value},null,8,["modelValue","options"])]),r.value?(f(),V("div",q,[r.value?(f(),U(j,{key:0,reservasType:_.value,proveedor:r.value},null,8,["reservasType","proveedor"])):x("",!0),s("div",W,[e[8]||(e[8]=s("p",null,"Fecha en que realizÃ³ el pago",-1)),i(c,{modelValue:g(a).date,"onUpdate:modelValue":e[2]||(e[2]=o=>g(a).date=o),dateFormat:"dd/mm/yy",class:"w-full",manualInput:!1},null,8,["modelValue"])]),s("div",h,[i(y,{label:"Valor Pagado",type:"number",mode:"currency",modelValue:g(a).amount,"onUpdate:modelValue":e[3]||(e[3]=o=>g(a).amount=o)},null,8,["modelValue"]),i(y,{label:"Valor Total",type:"number",mode:"currency",modelValue:v.value,"onUpdate:modelValue":e[4]||(e[4]=o=>v.value=o),disabled:""},null,8,["modelValue"]),i(y,{label:"Diferencia",type:"number",mode:"currency",modelValue:O.value,"onUpdate:modelValue":e[5]||(e[5]=o=>O.value=o),disabled:""},null,8,["modelValue"])]),s("input",{type:"file",onChange:T,label:"Comprobante"},null,32)])):x("",!0),s("div",G,[s("button",{onClick:e[6]||(e[6]=o=>D.value=!1),class:"bg-red-500 text-white px-4 py-2 rounded-md"}," Cancelar "),r.value?(f(),V("button",{key:0,loading:m.value,onClick:I,class:"bg-green-500 text-white px-4 py-2 rounded-md"}," Guardar ",8,J)):x("",!0)])])}}};export{_e as default};
