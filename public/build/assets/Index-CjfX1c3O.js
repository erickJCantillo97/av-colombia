import{_ as H}from"./Datatable-CmH2Rb7a.js";import{_ as W}from"./AppLayout-D2egXX6r.js";import{$ as O,a0 as F,d as a,a1 as z,A as G,f as A,o as v,a as o,b as g,w as M,g as D,h as C,F as V,j as Y,n as Z,t as B,Z as I,a2 as Q,a3 as q,B as J,I as $,M as R,e as K,c as N}from"./app-Bkmq6IjL.js";import{a as X}from"./toasts-CAnEIL5D.js";import{S as ee}from"./sweetalert2.esm.all-Y6IUEg8t.js";import{_ as te,a as ae}from"./Notas-C9g0qYed.js";import{_ as se}from"./Modal-GHdh7yTF.js";import{_ as oe}from"./Input-DkWzKbaZ.js";import{_ as re}from"./logo-CZ113150.js";import"./index-CcP_lYt9.js";import"./index-BLqmo2gT.js";import"./index-DaANNUiK.js";import"./index-CfbMPObl.js";import"./index-s9JRI-aI.js";import"./index-DXGaN_yB.js";import"./index-BpetVVTO.js";import"./index-BDEkOoTf.js";import"./index-CgfV6IMP.js";import"./index-DXym8dc4.js";import"./index-nj7zxik0.js";import"./index-DUCg-gIe.js";import"./index-C7bdtJCW.js";import"./index-CB7E2Eg0.js";import"./postcss-C08joEDO.js";import"./postcss-DXcLJQ9m.js";import"./index-R9UnX9_e.js";import"./index-4OYothAa.js";import"./useCommonUtilities-BgDhORlD.js";import"./marked.esm-BPgSS2IS.js";import"./Auth-BO5QB7ha.js";import"./index-CKTb4ZjY.js";import"./Service-CinDjj4j.js";import"./Toats-CRqRGqmn.js";import"./searchStore-P8cLzOpn.js";import"./Loading-INsU-SET.js";import"./index-ClvRstXy.js";import"./index-W7nZhAj4.js";import"./index-Nfd3bcJj.js";import"./index-Dhtgddix.js";import"./index-RsaUD5Xe.js";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const le=()=>{};function ie(y,i,d){let u;O(d)?u={evaluating:d}:u={};const{lazy:b=!1,evaluating:r=void 0,shallow:l=!0,onError:s=le}=u,x=F(!b),f=l?F(i):a(i);let c=0;return z(async p=>{if(!x.value)return;c++;const w=c;let m=!1;r&&Promise.resolve().then(()=>{r.value=!0});try{const _=await y(S=>{p(()=>{r&&(r.value=!1),m||S()})});w===c&&(f.value=_)}catch(_){s(_)}finally{r&&w===c&&(r.value=!1),m=!0}}),b?G(()=>(x.value=!0,f.value)):f}const ne={key:0,class:"items-center justify-center flex flex-col"},ue={class:"flex flex-col gap-y-3 h-[60vh] overflow-y-auto"},ce={class:"shadow-lg pr-4 rounded-md flex items-center justify-between"},de={class:"text-xl font-bold"},me={class:"font-bold text-sm"},fe={__name:"Changes",setup(y){const i=a(!1),d=a(),u=ie(async()=>{var{data:r}=await I.get(route("get.states.change",{date:d.value}));return r.status}),b={reservado:"blue","CAMBIO DE FECHA":"gray","NO SHOW":"amber",REUBICADO:"orange",CANCELADA:"green",PROBLEMATICA:"red"};return(r,l)=>(v(),A(V,null,[o("span",{onClick:l[0]||(l[0]=s=>i.value=!0),class:"text-xs font-bold text-blue-800 cursor-pointer"},"Listado de Cambios"),g(se,{title:"Historial de Cambios",modelValue:i.value,"onUpdate:modelValue":l[2]||(l[2]=s=>i.value=s),"close-on-escape":""},{default:M(()=>[g(oe,{"max-date":new Date,type:"date",class:"my-2",modelValue:d.value,"onUpdate:modelValue":l[1]||(l[1]=s=>d.value=s),dateFormat:"dd/mm/yy"},null,8,["max-date","modelValue"]),C(u)&&C(u).length==0?(v(),A("div",ne,[g(re),l[3]||(l[3]=o("p",null,"Sin Cambio Registrados",-1))])):D("",!0),o("div",ue,[(v(!0),A(V,null,Y(C(u),s=>(v(),A("div",ce,[o("div",{class:Z(["rounded-l-md text-lg font-bold uppercase",`bg-${b[s.state]}-200 p-2`])},B(s.state),3),o("div",null,[o("p",de,B(s.statable.service),1),o("span",me,B(s.user.name),1)])]))),256))])]),_:1},8,["modelValue"])],64))}},pe=Q("bookingService",()=>{const y=a([]),i=a(null);return{selectDate:y,statusFilter:i}},{persist:{storage:sessionStorage,paths:["selectDate","statusFilter"]}}),ve=[{field:"created_at",header:"Fecha Entrada",filter:!0,sortable:!0,type:"date"},{field:"cliente_name",header:"Nombre del pasajero",filter:!0,sortable:!0},{field:"adults",header:"Pasajeros",filter:!0,sortable:!0},{field:"cliente_building",header:"Edificio u Hotel",filter:!0,sortable:!0},{field:"service",header:"Actividad",filter:!0,sortable:!0},{field:"date",header:"Fecha de la Actividad",filter:!1,type:"date",sortable:!0},{field:"channel.name",header:"Canal de venta",filter:!0,sortable:!0},{field:"proveedors_names",header:"proveedores",class:"text-center font-semibold text-sm",filter:!0},{field:"status",header:"Estado",filter:!0,sortable:!0,type:"text",filtertype:"EQUALS",class:"text-center uppercase",severitys:[{text:"RESERVADO",severity:"info",class:""},{text:"CAMBIO DE FECHA",class:"bg-gray-200 font-bold"},{text:"COMPLETADA",severity:"success",class:""},{text:"NO SHOW",severity:"warn",class:""},{text:"REUBICADO",severity:"warn",class:""},{text:"CANCELADA",severity:"danger",class:"animate-pulse"},{text:"PROBLEMATICA",severity:"danger",class:"animate-pulse"},{text:"SIN CONFIRMAR",severity:"danger"}]}],ge={class:"h-[92vh]"},ye={class:"flex py-2 px-4 justify-between items-center"},be={class:"italic flex flex-col"},rt={__name:"Index",props:{bookingServices:Array},setup(y){const i=y,{toast:d}=X(),u=a([]),b=a([]),r=a(!1),l=a(""),s=a([]),x=a(!1),f=a(null),c=a(!1),p=a(i.bookingServices),w=pe(),{selectDate:m,statusFilter:_}=q(w),S={action:()=>{$.get(route("BookingServices.create"))}},P=async e=>{const{data:t}=await I.get(route("get.all.booking.services.dates",{dates:e}));return t.bookingServices};J([m,_,r],async([e,t,h])=>{if(h){m.value=[new Date("2024-11-02"),new Date],r.value=!1;return}if(!e)p.value=i.bookingServices;else{const n=await P(e);p.value=n}t&&(p.value=p.value.filter(n=>n.status==t))},{immediate:!0});const L=[{label:"Detalles",action:async e=>{f.value=e,x.value=!0,await getProveedors()},icon:"fa-solid fa-circle-info text-sm",severity:"info"},{label:"Editar",action:async e=>{$.get(route("BookingServices.edit",e.id))},icon:"fa-solid fa-pencil text-sm",severity:"warn"},{label:"Notas",severity:"secondary",action:e=>{s.value=e,c.value=!0},icon:"fa-solid fa-note-sticky text-sm"},{label:"Eliminar",icon:"fa-solid fa-trash text-sm",severity:"danger",show:R().props.auth.user.rol=="admin"||R().props.auth.user.rol=="superadmin",action:e=>{ee.fire({title:"Estas Seguro?",text:`Eliminar la reservaciÃ³n de ${e.cliente_name}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Si, Eliminar!"}).then(t=>{t.isConfirmed&&$.delete(route("BookingServices.destroy",e.id),{onSuccess:()=>{d("success","Reserva Eliminada")}})})}}],T=a([]),U=e=>{T.value=e},j=e=>{const t=e[0].getDate(),h=e[0].getMonth()+1,n=e[0].getFullYear(),E=k=>k<10?`0${k}`:k;return`${E(t)}/${E(h)}/${n} - ${E(e[1].getDate())}/${E(e[1].getMonth()+1)}/${e[1].getFullYear()}`};return(e,t)=>{const h=K("VueDatePicker");return v(),A(V,null,[g(W,{title:"Reservas"},{default:M(()=>[t[4]||(t[4]=o("div",{class:"hidden bg-amber-200 bg-orange-200 bg-blue-200 !bg-green-200 !bg-gray-200 !bg-orange-200 !bg-amber-200"},null,-1)),o("div",ge,[o("div",ye,[o("div",be,[t[3]||(t[3]=o("h1",{class:"text-2xl font-bold"},"Reservas",-1)),g(fe)]),o("div",null,[g(h,{"hide-offset-dates":"",modelValue:C(m),"onUpdate:modelValue":t[0]||(t[0]=n=>O(m)?m.value=n:null),teleport:!0,format:j,"model-type":"yyyy-MM-dd",range:"","enable-time-picker":!1,locale:"es","multi-calendars":{solo:!0},timezone:"America/Bogota"},null,8,["modelValue"])])]),g(H,{actions:L,add:S,showButtonBar:"",columnas:C(ve),data:p.value,cacheName:"reservas",rowClass:!0,onFilterApply:U},null,8,["columnas","data"])]),f.value?(v(),N(te,{key:0,modelValue:x.value,"onUpdate:modelValue":t[1]||(t[1]=n=>x.value=n),service:f.value,proveedors:u.value},null,8,["modelValue","service","proveedors"])):D("",!0)]),_:1}),c.value?(v(),N(ae,{key:0,modelValue:c.value,"onUpdate:modelValue":t[2]||(t[2]=n=>c.value=n),notes:b.value,note:l.value,service:s.value},null,8,["modelValue","notes","note","service"])):D("",!0)],64)}}};export{rt as default};
