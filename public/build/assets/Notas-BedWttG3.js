import{s as G}from"./index-Dr8cmIQ0.js";import{s as se}from"./index-CEGAZWTK.js";import{s as oe}from"./AppLayout-BVUkvS_V.js";import{S as E}from"./sweetalert2.esm.all-Y6IUEg8t.js";import{aU as H,aV as U,u as W,d as j,p as J,c as S,o as n,w as V,a as e,f as v,E as T,h as m,G as L,F as P,j as F,t as i,b as x,i as _,g as k,n as X,y as I,I as Q,a0 as R}from"./app-B8m0nNYc.js";import{a as le}from"./toasts-CAnEIL5D.js";import{M as z}from"./Modal-l5bxqxph.js";import{_ as B}from"./Input-C3s4g0tj.js";import{S as ae}from"./Service-2_knPiXi.js";import{u as ne}from"./Auth-BL5Cm5aV.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{L as ie}from"./Loading-CSz5bKqq.js";const re={class:"p-2"},de={class:"mb-4 flex flex-col"},ce={class:"grid grid-cols-5 border-y items-center border text-right gap-x-4"},ue={class:"col-span-1"},ve={class:"col-span-1 text-nowrap truncate"},me={class:"col-span-1"},fe={class:"col-span-1"},xe=["onUpdate:modelValue"],ge={class:"flex justify-end p-6 space-x-4"},pe={__name:"ServiceCancel",props:H({service:Object},{modelValue:{},modelModifiers:{},view:{default:!1},viewModifiers:{}}),emits:["update:modelValue","update:view"],setup(s){const D=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}),y=U(s,"modelValue"),w=U(s,"view"),d=s,p=W({date:"",proveedors:[]}),C=j([]);J(()=>{C.value=d.service.proveedors.map($=>{var o=$.proveedor;return{proveedor_id:$.id,concept:o.concept,proveedor:$,pasajeros:d.service.adults,cost:$.cost,proveedor_name:o.proveedor.nombre,costo_penalidad:o.proveedor.type_penalidad_cost=="Porcentaje"?o.proveedor.penalidad_cancelacion/100*$.cost:o.proveedor.penalidad_cancelacion*d.service.adults}})});const b=()=>{p.proveedors=C.value,p.post(route("cancelar.servicio",d.service.id),{onSuccess:()=>{y.value=!1,w.value=!1}})};return($,o)=>{const r=G;return n(),S(z,{title:`Cancelar Servicio ${s.service.service}`,modelValue:y.value,"onUpdate:modelValue":o[2]||(o[2]=c=>y.value=c),width:"70vw",onClose:o[3]||(o[3]=c=>y.value=!1),"close-on-escape":""},{default:V(()=>[e("div",re,[e("div",de,[o[4]||(o[4]=e("label",{for:"",class:"font-bold"},"Fecha de Cancelación",-1)),T(e("input",{label:"Fecha de Cancelación",type:"date",class:"rounded-lg shadow-sm border-gray-300 p-2","onUpdate:modelValue":o[0]||(o[0]=c=>m(p).date=c)},null,512),[[L,m(p).date]])]),o[5]||(o[5]=e("div",{class:"grid grid-cols-5 font-bold uppercase bg-gray-300 p-2 text-center"},[e("div",{class:"col-span-1"},"Proveedor"),e("div",{class:"col-span-1"},"Concepto"),e("div",{class:"col-span-1"},"Pasajeros"),e("div",{class:"col-span-1"},"Costo"),e("div",{class:"col-span-1"},"Penalidad Total")],-1)),(n(!0),v(P,null,F(C.value,c=>(n(),v("div",ce,[e("div",ue,i(c.proveedor_name),1),e("div",ve,i(c.concept),1),e("div",me,i(c.pasajeros),1),e("div",fe,i(m(D).format(c.cost)),1),T(e("input",{class:"col-span-1 rounded-md border border-gray-300 p-2","onUpdate:modelValue":u=>c.costo_penalidad=u,type:"number",mode:"currency"},null,8,xe),[[L,c.costo_penalidad]])]))),256))]),e("div",ge,[x(r,{onClick:o[1]||(o[1]=c=>y.value=!1)},{default:V(()=>[...o[6]||(o[6]=[_("No, Cerrar",-1)])]),_:1}),x(r,{severity:"danger",onClick:b},{default:V(()=>[...o[7]||(o[7]=[_("Si, Cancelar Servicio",-1)])]),_:1})])]),_:1},8,["title","modelValue"])}}},be={class:"p-2"},ye={class:"mb-4 flex flex-col"},he={class:"font-extrabold text-2xl text-center",for:""},we=["max"],Ce={class:"grid grid-cols-6 border-y items-center border text-right gap-x-4 py-1"},$e={class:"col-span-1"},ke={class:"col-span-1 text-nowrap truncate"},Ve={class:"col-span-1"},Se={class:"col-span-1"},_e=["onUpdate:modelValue","onInput"],je={class:"col-span-1"},De={class:"flex justify-end p-6 space-x-4"},Oe={__name:"ServiceNoShow",props:H({service:Object},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const D=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}),y=U(s,"modelValue"),w=s,d=W({cantidad:w.service.adults,notes:"",proveedors:[]}),p=j([]);J(()=>{p.value=w.service.proveedors.map(o=>{var r=o.proveedor;return{proveedor_id:o.id,concept:r.concept,proveedor:o,pasajeros:w.service.adults,cost:o.cost,proveedor_name:r.proveedor.nombre,totalpayment:0,costo_penalidad:r.proveedor.type_penalidad_cost=="Porcentaje"?r.proveedor.penalidad_no_show/100*o.cost/w.service.adults:r.proveedor.penalidad_no_show}}),b()});const C=()=>{d.proveedors=p.value,d.post(route("noshow.servicio",w.service.id),{onSuccess:()=>{y.value=!1}})},b=()=>{p.value.forEach(o=>{o.total_no_show=o.costo_penalidad*d.cantidad,$(o)})},$=o=>{const r=o.pasajeros-d.cantidad,c=o.cost/o.pasajeros*r;o.totalpayment=c+o.costo_penalidad*d.cantidad};return(o,r)=>{const c=G;return n(),S(z,{title:`Marcar como No SHOW ${s.service.service}`,modelValue:y.value,"onUpdate:modelValue":r[3]||(r[3]=u=>y.value=u),width:"70vw",onClose:r[4]||(r[4]=u=>y.value=!1),"close-on-escape":""},{default:V(()=>[e("div",be,[e("div",ye,[e("h1",he,i(s.service.cliente_name),1),r[5]||(r[5]=e("label",{for:"",class:"font-bold"},"Cuantos no se presentaron?",-1)),T(e("input",{type:"number",min:1,onInput:b,max:s.service.adults,class:"rounded-lg border-gray-300","onUpdate:modelValue":r[0]||(r[0]=u=>m(d).cantidad=u)},null,40,we),[[L,m(d).cantidad]])]),x(B,{type:"textarea",modelValue:m(d).notes,"onUpdate:modelValue":r[1]||(r[1]=u=>m(d).notes=u),label:"¿Porque no se presentaron?",class:"text-red-500"},null,8,["modelValue"]),r[6]||(r[6]=e("div",{class:"grid grid-cols-6 font-bold uppercase bg-gray-300 p-2 text-center"},[e("div",{class:"col-span-1"},"Proveedor"),e("div",{class:"col-span-1"},"Concepto"),e("div",{class:"col-span-1"},"Pasajeros"),e("div",{class:"col-span-1"},"Costo total Servicio"),e("div",{class:"col-span-1"},"Pago por No Show"),e("div",{class:"col-span-1"},"Total a pagar")],-1)),(n(!0),v(P,null,F(p.value,u=>(n(),v("div",Ce,[e("div",$e,i(u.proveedor_name),1),e("div",ke,i(u.concept),1),e("div",Ve,i(u.pasajeros),1),e("div",Se,i(m(D).format(u.cost)),1),T(e("input",{class:"col-span-1 rounded-md border-gray-300 p-2","onUpdate:modelValue":O=>u.costo_penalidad=O,onInput:O=>$(u),type:"number",mode:"currency"},null,40,_e),[[L,u.costo_penalidad]]),e("div",je,i(m(D).format(u.totalpayment)),1)]))),256))]),e("div",De,[x(c,{onClick:r[2]||(r[2]=u=>y.value=!1)},{default:V(()=>[...r[7]||(r[7]=[_("No, Cerrar",-1)])]),_:1}),x(c,{severity:"warn",onClick:C},{default:V(()=>[...r[8]||(r[8]=[_("Si, Servicio No show",-1)])]),_:1})])]),_:1},8,["title","modelValue"])}}},Ae={class:"flex flex-col gap-1 w-full"},Pe={class:"flex items-center justify-between"},Ne={class:"text-xl font-bold text-gray-800"},Ee={class:"text-sm text-gray-500"},Ie={class:"space-y-6"},Be={class:"space-y-2"},Ue={class:"space-y-2"},Fe={class:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"},Me=["href"],Re={class:"grid grid-cols-2 gap-2"},Te={class:"bg-blue-50 rounded-lg p-3 text-center"},Le={class:"text-2xl font-bold text-blue-600"},He={class:"bg-purple-50 rounded-lg p-3 text-center"},ze={class:"text-2xl font-bold text-purple-600"},qe={class:"space-y-2"},Ge={class:"flex items-center justify-between py-2 px-3 bg-green-50 rounded-lg"},We={class:"text-lg font-bold text-green-700"},Je={key:0,class:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"},Ke=["href"],Qe={key:0},Xe={class:"space-y-2"},Ye={key:1},Ze={class:"bg-amber-50 border-l-4 border-amber-400 p-3 rounded"},et={class:"text-sm text-gray-700"},tt={key:2},st={class:"flex items-center justify-between mb-3"},ot={class:"bg-green-100 text-green-700 text-xs font-semibold px-2.5 py-1 rounded-full"},lt={class:"space-y-2"},at={class:"text-sm text-gray-700"},nt={class:"text-sm font-semibold text-green-700"},it={key:3},rt={class:"flex items-center justify-between mb-3"},dt={class:"bg-blue-100 text-blue-700 text-xs font-semibold px-2.5 py-1 rounded-full"},ct={class:"space-y-2"},ut={class:"text-sm text-gray-700"},vt={class:"text-sm font-semibold text-blue-700"},mt={key:0,class:"border-t pt-4"},ft={class:"grid grid-cols-2 md:grid-cols-3 gap-2"},xt={class:"flex flex-col gap-y-2"},gt={class:"flex flex-col gap-y-1"},pt={key:0,class:"flex items-center gap-x-2"},bt={key:1},yt={class:"flex items-center gap-2"},ht={class:"flex justify-end gap-2"},wt={__name:"viewBooking",props:H({service:Object},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const{hasRole:D}=ne(),y=new ae,{toast:w}=le(),d=(f,{attrs:t})=>I("div",{class:"flex items-center justify-between py-2 px-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors"},[I("div",{class:"flex items-center gap-3"},[I("i",{class:`fa-solid fa-${f.icon} text-gray-500 text-sm`}),I("span",{class:"text-sm text-gray-600"},f.label)]),I("span",{class:"text-sm font-medium text-gray-900"},f.value)]),p=s,C=j(null),b=U(s,"modelValue"),$=j(!1),o=j(!1),r=j(!1),c=W({service:p.service.id,current_id:"",new_id:"",state:"REUBICAR",note:"",terminated:!0,value:""}),u=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}),O=()=>{$.value=!0},N=(f,t)=>{E.fire({title:f,text:"Estas seguro de realizar esta acción?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si"}).then(q=>{q.isConfirmed&&(E.fire({title:f,text:"Esta reserva ha sido "+f+".",icon:"success"}),Q.post(route("set.states.booking"),{service:p.service.id,state:f,terminated:t},{onSuccess:()=>{w("success","Reserva "+f)}}))})},M=()=>{E.fire({title:"Cambio de Fecha",html:'<input type="date" id="swal-date" class="w-full rounded-md text-center">',showCancelButton:!0,confirmButtonText:"Cambiar Fecha",showLoaderOnConfirm:!0,preConfirm:async()=>{const f=document.getElementById("swal-date").value;return f?(await Q.post(route("set.states.booking"),{service:p.service.id,state:"CAMBIO DE FECHA",date:f,terminated:!1}),f):(E.showValidationMessage("Debes seleccionar una fecha"),!1)},allowOutsideClick:()=>!E.isLoading()}).then(f=>{f.isConfirmed&&w("success","Fecha Cambiada")})},h=f=>{if(f==null||f==null)return"Sin definir";var t=new Date(new Date(f).getTime()+new Date(f).getTimezoneOffset()*6e4).toLocaleString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"});return t=="30/11/2"?"INDEFINIDO":t},l=()=>{if(!C.value||!c.new_id||!c.value)return w("error","Rellene todos los Campos"),0;c.current_id=C.value.id,c.service=p.service.id,c.state="REUBICADO",c.terminated=!1,c.post(route("set.states.booking"),{onSuccess:()=>{r.value=!1,c.reset(),w("success","Servicio REUBICADO")}})},g=j([]),A=async()=>{g.value=await y.getProveedorsByService(p.service.service_id)},Z=()=>{c.reset(),r.value=!0,A()},ee=f=>({RESERVADO:"bg-blue-100 text-blue-800","CAMBIO DE FECHA":"bg-gray-100 text-gray-800","NO SHOW":"bg-yellow-100 text-yellow-800",REUBICADO:"bg-orange-100 text-orange-800",CANCELADA:"bg-red-100 text-red-800",PROBLEMATICA:"bg-red-200 text-red-900","SIN CONFIRMAR":"bg-purple-100 text-purple-800",COMPLETADA:"bg-green-100 text-green-800"})[f]||"bg-gray-100 text-gray-800";return(f,t)=>{const q=oe,te=se,K=G;return n(),v(P,null,[x(q,{visible:b.value,"onUpdate:visible":t[6]||(t[6]=a=>b.value=a),header:"Detalles de la Reserva",position:"right",class:"!w-full md:!w-[500px]"},{header:V(()=>[e("div",Ae,[e("div",Pe,[e("h2",Ne,i(s.service.service),1),e("span",{class:X([ee(s.service.status),"px-3 py-1 text-xs font-semibold rounded-full"])},i(s.service.status),3)]),e("p",Ee,"ID: "+i(s.service.id.substring(0,8)),1)])]),footer:V(()=>[m(D)(["admin","superadmin"])?(n(),v("div",mt,[t[38]||(t[38]=e("p",{class:"text-xs text-gray-500 mb-3 font-medium"},"Acciones Rápidas",-1)),e("div",ft,[e("button",{onClick:t[0]||(t[0]=a=>N("reservado",!0)),class:"flex items-center justify-center gap-2 px-3 py-2.5 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg transition-all duration-200 hover:shadow-md group",title:"Confirmar Reserva"},[...t[32]||(t[32]=[e("i",{class:"fa-solid fa-circle-check text-sm group-hover:scale-110 transition-transform"},null,-1),e("span",{class:"text-xs font-medium hidden md:inline"},"Confirmar",-1)])]),e("button",{onClick:t[1]||(t[1]=a=>o.value=!0),class:"flex items-center justify-center gap-2 px-3 py-2.5 bg-yellow-50 hover:bg-yellow-100 text-yellow-700 rounded-lg transition-all duration-200 hover:shadow-md group",title:"No Show"},[...t[33]||(t[33]=[e("i",{class:"fa-solid fa-eye-slash text-sm group-hover:scale-110 transition-transform"},null,-1),e("span",{class:"text-xs font-medium hidden md:inline"},"No Show",-1)])]),e("button",{onClick:t[2]||(t[2]=a=>M()),class:"flex items-center justify-center gap-2 px-3 py-2.5 bg-gray-50 hover:bg-gray-100 text-gray-700 rounded-lg transition-all duration-200 hover:shadow-md group",title:"Cambio de Fecha"},[...t[34]||(t[34]=[e("i",{class:"fa-solid fa-calendar-week text-sm group-hover:scale-110 transition-transform"},null,-1),e("span",{class:"text-xs font-medium hidden md:inline"},"Fecha",-1)])]),e("button",{onClick:t[3]||(t[3]=a=>Z()),class:"flex items-center justify-center gap-2 px-3 py-2.5 bg-orange-50 hover:bg-orange-100 text-orange-700 rounded-lg transition-all duration-200 hover:shadow-md group",title:"Reubicar"},[...t[35]||(t[35]=[e("i",{class:"fa-solid fa-people-arrows text-sm group-hover:scale-110 transition-transform"},null,-1),e("span",{class:"text-xs font-medium hidden md:inline"},"Reubicar",-1)])]),e("button",{onClick:t[4]||(t[4]=a=>O()),class:"flex items-center justify-center gap-2 px-3 py-2.5 bg-red-50 hover:bg-red-100 text-red-700 rounded-lg transition-all duration-200 hover:shadow-md group",title:"Cancelar"},[...t[36]||(t[36]=[e("i",{class:"fa-solid fa-xmark-circle text-sm group-hover:scale-110 transition-transform"},null,-1),e("span",{class:"text-xs font-medium hidden md:inline"},"Cancelar",-1)])]),e("button",{onClick:t[5]||(t[5]=a=>N("PROBLEMATICA",!1)),class:"flex items-center justify-center gap-2 px-3 py-2.5 bg-red-50 hover:bg-red-100 text-red-700 rounded-lg transition-all duration-200 hover:shadow-md group",title:"Problemática"},[...t[37]||(t[37]=[e("i",{class:"fa-solid fa-triangle-exclamation text-sm group-hover:scale-110 transition-transform"},null,-1),e("span",{class:"text-xs font-medium hidden md:inline"},"Problema",-1)])])])])):k("",!0)]),default:V(()=>[e("div",Ie,[e("section",null,[t[17]||(t[17]=e("h3",{class:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2"},[e("i",{class:"fa-solid fa-calendar-days text-blue-500"}),_(" Información del Servicio ")],-1)),e("div",Be,[x(d,{icon:"fa-calendar",label:"Fecha",value:h(s.service.date)},null,8,["value"]),x(d,{icon:"fa-clock",label:"Hora",value:s.service.hour},null,8,["value"]),s.service.time_service?(n(),S(d,{key:0,icon:"fa-hourglass-half",label:"Duración",value:s.service.time_service},null,8,["value"])):k("",!0),x(d,{icon:"fa-store",label:"Canal",value:s.service.channel.name},null,8,["value"])])]),e("section",null,[t[19]||(t[19]=e("h3",{class:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2"},[e("i",{class:"fa-solid fa-user text-blue-500"}),_(" Información del Cliente ")],-1)),e("div",Ue,[x(d,{icon:"fa-user-circle",label:"Cliente",value:s.service.cliente_name},null,8,["value"]),x(d,{icon:"fa-city",label:"Ciudad",value:s.service.cliente_city},null,8,["value"]),e("div",Fe,[t[18]||(t[18]=e("div",{class:"flex items-center gap-3"},[e("i",{class:"fa-brands fa-whatsapp text-green-500 text-sm"}),e("span",{class:"text-sm text-gray-600"},"Teléfono")],-1)),e("a",{target:"_blank",href:`https://wa.me/${s.service.cliente_phone}?text=Hola mucho gusto yo soy Sandra la coordinadora de su actividad. Hello, nice to talk to you I'm Sandra the coordinator for your activity`,class:"text-sm font-medium text-blue-600 hover:text-blue-800 hover:underline"},i(s.service.cliente_phone),9,Me)]),x(d,{icon:"fa-building",label:"Edificio",value:s.service.cliente_building},null,8,["value"])])]),e("section",null,[t[24]||(t[24]=e("h3",{class:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2"},[e("i",{class:"fa-solid fa-users text-blue-500"}),_(" Participantes ")],-1)),e("div",Re,[e("div",Te,[t[20]||(t[20]=e("i",{class:"fa-solid fa-user text-blue-600 text-lg mb-1"},null,-1)),e("p",Le,i(s.service.adults),1),t[21]||(t[21]=e("p",{class:"text-xs text-gray-600"},"Adultos",-1))]),e("div",He,[t[22]||(t[22]=e("i",{class:"fa-solid fa-child text-purple-600 text-lg mb-1"},null,-1)),e("p",ze,i(s.service.boys),1),t[23]||(t[23]=e("p",{class:"text-xs text-gray-600"},"Niños",-1))])])]),e("section",null,[t[27]||(t[27]=e("h3",{class:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2"},[e("i",{class:"fa-solid fa-dollar-sign text-blue-500"}),_(" Información Financiera ")],-1)),e("div",qe,[e("div",Ge,[t[25]||(t[25]=e("span",{class:"text-sm text-gray-600"},"Total",-1)),e("span",We,i(m(u).format(s.service.total)),1)]),x(d,{icon:"fa-receipt",label:"Total Real",value:m(u).format(s.service.total_real)},null,8,["value"]),x(d,{icon:"fa-wallet",label:"Saldo",value:m(u).format(s.service.saldo)},null,8,["value"]),s.service.file!="/laravel/public/"?(n(),v("div",Je,[t[26]||(t[26]=e("div",{class:"flex items-center gap-3"},[e("i",{class:"fa-solid fa-paperclip text-gray-500 text-sm"}),e("span",{class:"text-sm text-gray-600"},"Soporte")],-1)),e("a",{target:"_blank",href:s.service.file,class:"text-sm font-medium text-blue-600 hover:text-blue-800 hover:underline"}," Ver Archivo ",8,Ke)])):k("",!0)])]),s.service.user||s.service.conductor||s.service.fecha_cancelacion?(n(),v("section",Qe,[t[28]||(t[28]=e("h3",{class:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2"},[e("i",{class:"fa-solid fa-info-circle text-blue-500"}),_(" Información Adicional ")],-1)),e("div",Xe,[s.service.user?(n(),S(d,{key:0,icon:"fa-user-tie",label:s.service.vendedor_id?"Vendedor":"Usuario",value:s.service.user?.name},null,8,["label","value"])):k("",!0),s.service.user?(n(),S(d,{key:1,icon:"fa-calendar-plus",label:"Fecha de Reserva",value:new Date(s.service.created_at).toLocaleDateString("es-CO")},null,8,["value"])):k("",!0),s.service.conductor?(n(),S(d,{key:2,icon:"fa-car",label:"Conductor",value:s.service.conductor},null,8,["value"])):k("",!0),s.service.placa?(n(),S(d,{key:3,icon:"fa-id-card",label:"Placa",value:s.service.placa},null,8,["value"])):k("",!0),s.service.total_pago_proveedor?(n(),S(d,{key:4,icon:"fa-money-bill",label:"Valor del Servicio",value:m(u).format(s.service.total_pago_proveedor)},null,8,["value"])):k("",!0),s.service.fecha_cancelacion?(n(),S(d,{key:5,icon:"fa-calendar-xmark",label:"Fecha de Cancelación",value:new Date(new Date(s.service.fecha_cancelacion).setDate(new Date(s.service.fecha_cancelacion).getDate()+1)).toLocaleDateString("es-CO")},null,8,["value"])):k("",!0)])])):k("",!0),s.service.observations?(n(),v("section",Ye,[t[29]||(t[29]=e("h3",{class:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2"},[e("i",{class:"fa-solid fa-note-sticky text-blue-500"}),_(" Observaciones ")],-1)),e("div",Ze,[e("p",et,i(s.service.observations),1)])])):k("",!0),s.service.proveedors.length>0?(n(),v("section",tt,[e("div",st,[t[30]||(t[30]=e("h3",{class:"text-sm font-semibold text-gray-700 flex items-center gap-2"},[e("i",{class:"fa-solid fa-handshake text-blue-500"}),_(" Proveedores ")],-1)),e("span",ot,i(s.service.proveedors.length),1)]),e("div",lt,[(n(!0),v(P,null,F(s.service.proveedors,a=>(n(),v("div",{key:a.id,class:"flex items-center justify-between py-2 px-3 bg-green-50 rounded-lg border border-green-100"},[e("span",at,i(a.proveedor.proveedor.nombre),1),e("span",nt,i(m(u).format(a.cost)),1)]))),128))])])):k("",!0),s.service.extras.length>0?(n(),v("section",it,[e("div",rt,[t[31]||(t[31]=e("h3",{class:"text-sm font-semibold text-gray-700 flex items-center gap-2"},[e("i",{class:"fa-solid fa-plus-circle text-blue-500"}),_(" Extras ")],-1)),e("span",dt,i(s.service.extras.length),1)]),e("div",ct,[(n(!0),v(P,null,F(s.service.extras,a=>(n(),v("div",{key:a.id,class:"flex items-center justify-between py-2 px-3 bg-blue-50 rounded-lg border border-blue-100"},[e("span",ut,i(a.cantidad)+" "+i(a.description),1),e("span",vt,i(m(u).format(a.total_price)),1)]))),128))])])):k("",!0)])]),_:1},8,["visible"]),x(z,{modelValue:r.value,"onUpdate:modelValue":t[13]||(t[13]=a=>r.value=a),title:"Cambio de proveedor","close-on-escape":""},{default:V(()=>[e("div",xt,[e("span",gt,[t[41]||(t[41]=e("label",{for:"",class:"font-bold"}," Proveedor Actual",-1)),x(te,{placeholder:"Proveedor Actual",options:s.service.proveedors,label:"Proveedor Actual",modelValue:C.value,"onUpdate:modelValue":t[7]||(t[7]=a=>C.value=a),"option-label":"proveedor.name"},{value:V(a=>[a.value?(n(),v("div",pt,[e("div",null,i(C.value.proveedor.proveedor.nombre),1),t[39]||(t[39]=e("span",null,"-",-1)),e("div",null,i(m(u).format(C.value.cost)),1)])):(n(),v("span",bt,i(a.placeholder),1))]),option:V(({option:a})=>[e("div",yt,[e("span",null,i(a.proveedor.proveedor.nombre),1),t[40]||(t[40]=e("span",null,"-",-1)),e("span",null,i(m(u).format(a.cost)),1)])]),_:1},8,["options","modelValue"])]),x(B,{"option-label":"nombre",type:"dropdown",label:"Nuevo Proveedor",modelValue:m(c).new_id,"onUpdate:modelValue":t[8]||(t[8]=a=>m(c).new_id=a),options:g.value},null,8,["modelValue","options"]),x(B,{label:"Valor",modelValue:m(c).value,"onUpdate:modelValue":t[9]||(t[9]=a=>m(c).value=a),type:"number",mode:"currency"},null,8,["modelValue"]),x(B,{label:"Nota",modelValue:m(c).note,"onUpdate:modelValue":t[10]||(t[10]=a=>m(c).note=a),type:"textarea",mode:"currency"},null,8,["modelValue"]),e("div",ht,[x(K,{onClick:t[11]||(t[11]=a=>r.value=!1),label:"Cancelar",severity:"danger",icon:"fa-solid fa-xmark"}),x(K,{onClick:t[12]||(t[12]=a=>l()),label:"Guardar",severity:"success",icon:"fa-solid fa-save"})])])]),_:1},8,["modelValue"]),$.value?(n(),S(pe,{key:0,modelValue:$.value,"onUpdate:modelValue":t[14]||(t[14]=a=>$.value=a),view:b.value,"onUpdate:view":t[15]||(t[15]=a=>b.value=a),service:s.service},null,8,["modelValue","view","service"])):k("",!0),o.value?(n(),S(Oe,{key:1,modelValue:o.value,"onUpdate:modelValue":t[16]||(t[16]=a=>o.value=a),service:s.service},null,8,["modelValue","service"])):k("",!0)],64)}}},vs=Y(wt,[["__scopeId","data-v-8eeccd39"]]),Ct={class:"flex items-center gap-3 px-6 py-4 border-b border-gray-200"},$t={class:"text-xs text-gray-500"},kt={class:"flex flex-col h-[60vh]"},Vt={class:"flex-1 overflow-y-auto px-6 py-4 space-y-4 bg-gray-50"},St={key:0,class:"flex justify-center items-center h-full"},_t={class:"text-center"},jt={key:1,class:"flex justify-center flex-col items-center h-full text-center px-8 py-12"},Dt={key:2,class:"space-y-3"},Ot={key:0,class:"flex items-end gap-2 max-w-[75%] group"},At={class:"flex-1 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl rounded-br-sm shadow-md hover:shadow-lg transition-shadow duration-200"},Pt={class:"px-4 py-3"},Nt={class:"text-white text-sm leading-relaxed break-words"},Et={class:"flex items-center justify-end gap-2 mt-2"},It={class:"text-xs text-blue-100"},Bt={class:"px-2 pb-2 flex gap-1 justify-end opacity-0 group-hover:opacity-100 transition-opacity duration-200"},Ut=["onClick"],Ft=["onClick"],Mt={class:"w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center text-white text-xs font-bold flex-shrink-0 shadow-md"},Rt={key:1,class:"flex items-end gap-2 max-w-[75%]"},Tt={class:"w-8 h-8 rounded-full bg-gradient-to-br from-gray-400 to-gray-500 flex items-center justify-center text-white text-xs font-bold flex-shrink-0 shadow-md"},Lt={class:"flex-1 bg-white rounded-2xl rounded-bl-sm shadow-md hover:shadow-lg transition-shadow duration-200 border border-gray-200"},Ht={class:"px-4 py-3"},zt={class:"text-sm font-semibold text-gray-900 mb-1"},qt={class:"text-gray-700 text-sm leading-relaxed break-words"},Gt={class:"text-xs text-gray-500 mt-2 block"},Wt={class:"border-t border-gray-200 bg-white px-6 py-4"},Jt={key:0,class:"mb-2 flex items-center gap-2 text-sm text-blue-600 bg-blue-50 px-3 py-2 rounded-lg"},Kt={class:"flex gap-3 items-end"},Qt={class:"flex-1"},Xt=["disabled"],Yt=["disabled"],Zt={__name:"Notas",props:H({todayActivity:Boolean,notes:Array,note:String,service:Array},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const D=U(s,"modelValue"),y=s,w=j(y.notes),d=j(!1),p=j(null),C=j(!1),b=j(""),$=()=>{R.post(route("notes.store"),{note:b.value,booking_service_id:y.service.id}).then(h=>{b.value="",O()})},o=h=>{R.delete(route("notes.destroy",h.id)).then(l=>{O()})},r=h=>{b.value=h.note,d.value=!0,p.value=h},c=()=>{R.put(route("notes.update",p.value.id),{note:b.value}).then(h=>{O(),b.value="",d.value=!1,p.value=null})},u=()=>{b.value="",d.value=!1,p.value=null},O=()=>{C.value=!0,R.get(route("notes.index",{booking_service_id:y.service.id})).then(h=>{w.value=h.data.notes,C.value=!1})},N=h=>{const l=new Date(h),g=new Date,A=new Date(g);return A.setDate(A.getDate()-1),l.toDateString()===g.toDateString()?`Hoy ${l.toLocaleTimeString("es-CO",{hour:"2-digit",minute:"2-digit"})}`:l.toDateString()===A.toDateString()?`Ayer ${l.toLocaleTimeString("es-CO",{hour:"2-digit",minute:"2-digit"})}`:l.toLocaleString("es-CO",{day:"2-digit",month:"short",hour:"2-digit",minute:"2-digit"})},M=h=>{if(!h)return"?";const l=h.trim().split(" ");return l.length===1?l[0].charAt(0).toUpperCase():(l[0].charAt(0)+l[l.length-1].charAt(0)).toUpperCase()};return J(()=>{O()}),(h,l)=>(n(),S(z,{modelValue:D.value,"onUpdate:modelValue":l[1]||(l[1]=g=>D.value=g),"close-on-escape":"",width:"60vw"},{header:V(()=>[e("div",Ct,[l[3]||(l[3]=e("div",{class:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center"},[e("i",{class:"fa-solid fa-comments text-white"})],-1)),e("div",null,[l[2]||(l[2]=e("h3",{class:"text-lg font-bold text-gray-900"},"Notas de la Actividad",-1)),e("p",$t,i(y.service.service)+" - "+i(y.service.cliente_name),1)])])]),default:V(()=>[e("div",kt,[e("div",Vt,[C.value?(n(),v("div",St,[e("div",_t,[x(ie)])])):w.value.length===0?(n(),v("div",jt,[...l[4]||(l[4]=[e("div",{class:"relative mb-6"},[e("div",{class:"absolute inset-0 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-full blur-xl opacity-60 animate-pulse-slow"}),e("div",{class:"relative w-24 h-24 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-lg"},[e("div",{class:"absolute inset-0 rounded-full bg-white opacity-20 animate-ping-slow"}),e("i",{class:"fa-solid fa-message-plus text-4xl text-white drop-shadow-lg"})])],-1),e("h3",{class:"text-xl font-bold text-gray-900 mb-2"}," No hay notas todavía ",-1),e("p",{class:"text-sm text-gray-600 mb-6 max-w-xs leading-relaxed"}," Esta actividad aún no tiene notas. Comienza la conversación agregando la primera nota. ",-1),e("div",{class:"flex items-center gap-3 text-xs text-gray-400"},[e("div",{class:"flex items-center gap-1.5"},[e("div",{class:"w-2 h-2 rounded-full bg-blue-400 animate-bounce",style:{"animation-delay":"0s"}}),e("div",{class:"w-2 h-2 rounded-full bg-indigo-400 animate-bounce",style:{"animation-delay":"0.2s"}}),e("div",{class:"w-2 h-2 rounded-full bg-purple-400 animate-bounce",style:{"animation-delay":"0.4s"}})]),e("span",{class:"font-medium"},"Escribe tu primera nota abajo")],-1),e("div",{class:"absolute inset-0 pointer-events-none overflow-hidden"},[e("div",{class:"particle particle-1"}),e("div",{class:"particle particle-2"}),e("div",{class:"particle particle-3"})],-1)])])):(n(),v("div",Dt,[(n(!0),v(P,null,F(w.value,g=>(n(),v("div",{key:g.id,class:X(["flex animate-fade-in",g.user_id===h.$page.props.auth.user.id?"justify-end":"justify-start"])},[g.user_id===h.$page.props.auth.user.id?(n(),v("div",Ot,[e("div",At,[e("div",Pt,[e("p",Nt,i(g.note),1),e("div",Et,[e("span",It,i(N(g.created_at)),1),l[5]||(l[5]=e("i",{class:"fa-solid fa-check-double text-xs text-blue-100"},null,-1))])]),e("div",Bt,[e("button",{onClick:A=>r(g),class:"px-2 py-1 text-xs text-white hover:bg-white/20 rounded-lg transition-colors duration-200",title:"Editar"},[...l[6]||(l[6]=[e("i",{class:"fa-solid fa-pencil"},null,-1)])],8,Ut),e("button",{onClick:A=>o(g),class:"px-2 py-1 text-xs text-white hover:bg-red-500 rounded-lg transition-colors duration-200",title:"Eliminar"},[...l[7]||(l[7]=[e("i",{class:"fa-solid fa-trash"},null,-1)])],8,Ft)])]),e("div",Mt,i(M(h.$page.props.auth.user.name)),1)])):(n(),v("div",Rt,[e("div",Tt,i(M(g.user.name)),1),e("div",Lt,[e("div",Ht,[e("p",zt,i(g.user.name),1),e("p",qt,i(g.note),1),e("span",Gt,i(N(g.created_at)),1)])])]))],2))),128))]))]),e("div",Wt,[d.value?(n(),v("div",Jt,[l[9]||(l[9]=e("i",{class:"fa-solid fa-pen-to-square"},null,-1)),l[10]||(l[10]=e("span",null,"Editando nota",-1)),e("button",{onClick:u,class:"ml-auto text-gray-500 hover:text-gray-700"},[...l[8]||(l[8]=[e("i",{class:"fa-solid fa-xmark"},null,-1)])])])):k("",!0),e("div",Kt,[e("div",Qt,[x(B,{type:"textarea",modelValue:b.value,"onUpdate:modelValue":l[0]||(l[0]=g=>b.value=g),rowsTextarea:2,placeholder:"Escribe una nota...",class:"w-full"},null,8,["modelValue"])]),d.value?(n(),v("button",{key:1,onClick:c,disabled:!b.value.trim(),class:"flex-shrink-0 w-12 h-12 rounded-xl bg-gradient-to-br from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 disabled:from-gray-300 disabled:to-gray-400 disabled:cursor-not-allowed text-white shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center"},[...l[12]||(l[12]=[e("i",{class:"fa-solid fa-check"},null,-1)])],8,Yt)):(n(),v("button",{key:0,onClick:$,disabled:!b.value.trim(),class:"flex-shrink-0 w-12 h-12 rounded-xl bg-gradient-to-br from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 disabled:from-gray-300 disabled:to-gray-400 disabled:cursor-not-allowed text-white shadow-lg hover:shadow-xl transition-all duration-200 flex items-center justify-center group"},[...l[11]||(l[11]=[e("i",{class:"fa-solid fa-paper-plane group-hover:translate-x-0.5 group-hover:-translate-y-0.5 transition-transform duration-200"},null,-1)])],8,Xt))])])])]),_:1},8,["modelValue"]))}},ms=Y(Zt,[["__scopeId","data-v-ef8bf030"]]);export{ms as N,vs as V};
