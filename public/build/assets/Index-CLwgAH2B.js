import{s as w}from"./index-DEej-U-A.js";import{s as k}from"./index-MB3T2xEW.js";import{_ as B}from"./Datatable-C4OGUp_U.js";import{_ as m,a as M}from"./Modal-Bh87YVM-.js";import{_ as U}from"./AppLayout-zG8DpL1C.js";import{d as n,C as N,c as $,w as c,o as p,a as s,b as l,u as i,f as _,t as r,G as T}from"./app-B0rJRvBf.js";import{S as q,a as A}from"./toasts-BN-4G0DO.js";import"./index-N009d65B.js";import"./index-DiGwwsfh.js";import"./index-BSAjQjAR.js";import"./index-DejEIosd.js";import"./index-YyKgS5aV.js";import"./index-sxdJrvfs.js";import"./postcss-DPrN65BX.js";import"./index-CQgXjGh3.js";import"./index-Bw72Ycs7.js";import"./index-CVsqwtTv.js";import"./index-DidRaT4Z.js";import"./useCommonUtilities-DO03hYfs.js";import"./moment-Cijl8gKs.js";import"./index-as_b_m-S.js";import"./index-Bv8cJmgx.js";import"./index-td95V7AT.js";import"./index-Bs3yB8iJ.js";const E={class:"h-[99vh]"},G={class:"flex flex-col gap-y-4"},j={key:0,class:"flex items-center"},z={key:1},L={class:"flex justify-between w-full items-center"},O={class:"text-xs"},D={class:"flex gap-x-4"},ye={__name:"Index",props:{payments:{type:Array,required:!0}},setup(g){const d=n(!1),{toast:u}=A(),f=n([]);n(!1);const t=N({payable_id:"",payable_type:"App\\Models\\Service",method:"",amount:"",currency:"COP",validatePay:!1}),b={action:()=>{d.value=!0}},h=[{action:a=>{q.fire({title:"Confirmar Pago?",text:"Esta seguro de Confirmar este pago?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Si, Confirmar!"}).then(o=>{o.isConfirmed&&(console.log(a),T.post(route("payment.set.state",a.id),{_method:"PUT",status:"Confirmado"},{onSuccess:()=>{u("success","Pago Confirmado con exito")}}))}),x.value=a},severity:"success",icon:"fa-solid fa-wallet text-sm",label:"Validar Pago"}],x=n(),C=a=>{if(t.validatePay&&(t.status="Confirmado"),t.amount==""||t.method==""||t.payable_id==""){u("error","Todos los campos son obligatorios");return}t.payable_id=t.payable_id.id,t.post(route("payments.store"),{onSuccess:()=>{d.value=!1,u("success","Pago Registrado con exito")}})},V=n([]);(()=>{axios.get(route("get.services")).then(a=>{V.value=a.data.services.slice(0,5)})})();const v=n([]);(()=>{axios.get(route("get.services.no.payment")).then(a=>{v.value=Object.values(a.data.bookingNoPayment)})})();const S=[{header:"Servicio",field:"payable.service",filter:!0},{header:"Cliente",field:"payable.cliente_name",filter:!0},{header:"Tipo de Pago",field:"type",filter:!0,format:a=>a.toUpperCase()},{header:"Monto",field:"amount",type:"currency",filter:!0},{header:"Metodo de Pago",field:"metohd_payment.name",filter:!0},{header:"Fecha",field:"created_at",type:"date",filter:!0},{header:"Estado",field:"status",filter:!0,sortable:!0,type:"tag",filtertype:"EQUALS",class:"text-center uppercase",severitys:[{text:"Pendiente",severity:"danger",class:""},{text:"Confirmado",severity:"success",class:""}]}];return(()=>{axios.get(route("paymentMethods.index")).then(a=>{f.value=a.data}).catch(a=>{console.log(a)})})(),(a,o)=>{const P=k,y=w;return p(),$(U,{title:"Pagos"},{default:c(()=>[s("div",E,[l(B,{add:b,columnas:S,actions:h,data:g.payments,title:"Pagos"},null,8,["data"])]),l(M,{modelValue:d.value,"onUpdate:modelValue":o[5]||(o[5]=e=>d.value=e),title:"AÃ±adir Pagos"},{footer:c(()=>[s("div",D,[l(y,{label:"Cancelar",size:"small",severity:"danger",icon:"pi pi-times",onClick:o[4]||(o[4]=e=>d.value=!1)}),l(y,{label:"Guardar",size:"small",severity:"success",icon:"pi pi-save",onClick:C})])]),default:c(()=>[s("form",null,[s("div",G,[s("div",null,[o[6]||(o[6]=s("label",{for:"",class:"font-bold"},"Servicio",-1)),l(P,{options:v.value,filter:"",showClear:"",modelValue:i(t).payable_id,"onUpdate:modelValue":o[0]||(o[0]=e=>i(t).payable_id=e),class:"w-full","option-label":"service",placeholder:"Seleccione un servicio"},{value:c(e=>[e.value?(p(),_("div",j,[s("div",null,r(e.value.service)+" - "+r(e.value.cliente_name),1)])):(p(),_("span",z,r(e.placeholder),1))]),option:c(e=>[s("div",L,[s("div",null,[s("p",null,r(e.option.service)+" - "+r(e.option.cliente_name),1),s("p",O,r(e.option.date)+" "+r(e.option.hour),1)]),s("div",null,r(e.option.total_price_sales),1)])]),_:1},8,["options","modelValue"])]),l(m,{label:"Monto",modelValue:i(t).amount,"onUpdate:modelValue":o[1]||(o[1]=e=>i(t).amount=e),mode:"currency",type:"number",required:""},null,8,["modelValue"]),l(m,{label:"Medio de Pago",class:"w-full",min:"0",type:"dropdown","option-label":"name","option-value":"id",options:f.value,modelValue:i(t).method,"onUpdate:modelValue":o[2]||(o[2]=e=>i(t).method=e),required:""},null,8,["options","modelValue"]),l(m,{checkboxLabel:"Pago Verificado",modelValue:i(t).validatePay,"onUpdate:modelValue":o[3]||(o[3]=e=>i(t).validatePay=e),type:"checkbox",required:""},null,8,["modelValue"])])])]),_:1},8,["modelValue"])]),_:1})}}};export{ye as default};
