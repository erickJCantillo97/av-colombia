import{s as I}from"./index-Bc6OUorH.js";import{d as l,x as T,q as k,f as y,o as v,a as r,g as b,b as d,c as P,u as c,A as B,y as _}from"./app-DxitKapu.js";import{a as F}from"./toasts-Bf1FAz7R.js";import{_ as f}from"./Input-B4juYmS9.js";import R from"./DetailsTypeReserva-hXHGqrKf.js";import{a as U}from"./useCommonUtilities-Ca8fwx5n.js";import"./index-s3nGfwil.js";import"./index-CAJYn1Te.js";import"./index-Czego5ym.js";import"./index-dsWgR68u.js";import"./index-C5lx-bVH.js";import"./index-B58qAnix.js";import"./index-CHtdE7Z0.js";import"./index-JKsanBW5.js";import"./index-D7wdhyir.js";import"./index-CJMTAeLJ.js";import"./index-BIhKiV4f.js";import"./index-DacBG7Yp.js";import"./sweetalert2.esm.all-DV3w3JmD.js";import"./index-Cyw2NGxR.js";import"./index-BpZhgwyn.js";import"./index-B4BoY1zs.js";import"./index-BeFxeSPv.js";import"./index-B29L13Nf.js";import"./index-BgfiG7o2.js";import"./filepond-plugin-image-preview.min-CqLqekfX.js";import"./index-DeTk9LJU.js";import"./index-P3caaM5S.js";import"./postcss-BBbZy-qO.js";import"./index-DOwZUJUe.js";import"./ItemDetailTypeReserva-pkRhwjWf.js";const N={class:"gap-y-2 flex flex-col"},M={class:"flex flex-col md:flex-row gap-x-2 items-center"},j={class:"flex flex-col w-full justify-between font-bold"},H={key:0,class:"flex flex-col gap-y-2"},L={class:"flex flex-col w-full justify-between font-bold"},z={class:"grid grid-cols-1 md:grid-cols-3 gap-x-4"},$={class:"flex justify-end gap-x-2"},q=["loading"],Ae={__name:"Form",props:{payments:Array},setup(W){const g=l(!1),{toast:D}=F(),i=l(!1),a=T({date:new Date,startDate:new Date,endDate:new Date,amount:0,proveedor_id:"",file:"",description:""}),V=l([]),u=l([new Date,new Date]),s=l(),w=l([]),n=l(),x=l(null),p=l(0),A=()=>{B.get(route("get.booking.time.range"),{params:{start_date:new Date(u.value[0]).toISOString().split("T")[0],end_date:new Date(u.value[1]).toISOString().split("T")[0]}}).then(o=>{V.value=o.data.proveedores,s.value=o.data.bookingTimeRange.filter(e=>{let m=n.value;return e.proveedors.map(E=>E.proveedor_id).includes(m)}),p.value=U(s.value),w.value=[{name:"RESERVADO",value:s.value.filter(e=>e.status=="RESERVADO"),color:"bg-blue-200"},{name:"COMPLETADA",value:s.value.filter(e=>e.status=="COMPLETADA"),color:"bg-green-200"},{name:"CANCELADA",value:s.value.filter(e=>e.status=="CANCELADA"),color:"bg-red-200"},{name:"NO SHOW",value:s.value.filter(e=>e.status=="NO SHOW"),color:"bg-yellow-200"},{name:"CAMBIO DE FECHA",value:s.value.filter(e=>e.status=="CAMBIO DE FECHA"),color:"bg-gray-200"},{name:"REUBICADO",value:s.value.filter(e=>e.status=="REUBICADO"),color:"bg-yellow-200"}]})};function O(o){a.file=o.target.files[0]}const S=()=>{i.value=!0;let o=new FormData;if(o.append("proveedor_id",n.value),o.append("amount",a.amount),o.append("comprobante",a.file),o.append("date",new Date(a.date).toISOString().split("T")[0]),o.append("startDate",new Date(u.value[0]).toISOString().split("T")[0]),o.append("endDate",new Date(u.value[1]).toISOString().split("T")[0]),o.append("description",a.description),x.value){_.post(route("paymentProveedors.update",x.value),o,{onSuccess:()=>{D("success","Pago Actualizado con exito"),i.value=!1,g.value=!1}});return}_.post(route("paymentProveedors.store"),o,{onSuccess:()=>{D("success","Pago Actualizado con exito"),i.value=!1,g.value=!1}})},C=k(()=>p.value-a.amount);return(o,e)=>{const m=I;return v(),y("div",N,[r("div",M,[r("div",j,[e[7]||(e[7]=r("p",null,"Fechas",-1)),d(m,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=t=>u.value=t),selectionMode:"range",dateFormat:"dd/mm/yy",class:"w-full h-9",manualInput:!1,onValueChange:A},null,8,["modelValue"])]),d(f,{label:"Proveedor",type:"dropdown","option-label":"proveedor","option-value":"proveedor_id",onValueChange:A,class:"w-full",modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=t=>n.value=t),options:V.value},null,8,["modelValue","options"])]),n.value?(v(),y("div",H,[n.value?(v(),P(R,{key:0,reservasType:w.value},null,8,["reservasType"])):b("",!0),r("div",L,[e[8]||(e[8]=r("p",null,"Fecha en que realizÃ³ el pago",-1)),d(m,{modelValue:c(a).date,"onUpdate:modelValue":e[2]||(e[2]=t=>c(a).date=t),dateFormat:"dd/mm/yy",class:"w-full",manualInput:!1},null,8,["modelValue"])]),r("div",z,[d(f,{label:"Valor Pagado",type:"number",mode:"currency",modelValue:c(a).amount,"onUpdate:modelValue":e[3]||(e[3]=t=>c(a).amount=t)},null,8,["modelValue"]),d(f,{label:"Valor Total",type:"number",mode:"currency",modelValue:p.value,"onUpdate:modelValue":e[4]||(e[4]=t=>p.value=t),disabled:""},null,8,["modelValue"]),d(f,{label:"Diferencia",type:"number",mode:"currency",modelValue:C.value,"onUpdate:modelValue":e[5]||(e[5]=t=>C.value=t),disabled:""},null,8,["modelValue"])]),r("input",{type:"file",onChange:O,label:"Comprobante"},null,32)])):b("",!0),r("div",$,[r("button",{onClick:e[6]||(e[6]=t=>g.value=!1),class:"bg-red-500 text-white px-4 py-2 rounded-md"}," Cancelar "),n.value?(v(),y("button",{key:0,loading:i.value,onClick:S,class:"bg-green-500 text-white px-4 py-2 rounded-md"}," Guardar ",8,q)):b("",!0)])])}}};export{Ae as default};
