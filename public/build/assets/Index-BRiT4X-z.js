import{_ as N}from"./Datatable-DYRcW64X.js";import{eZ as z,z as B,d as x,x as D,q as T,f as a,o as l,a as o,b as c,w as p,u as r,g as y,F as h,i as C,n as U,t as u,h as q,y as F}from"./app-D3TVovok.js";import{s as G}from"./index-CL_bo5B1.js";import{_ as P}from"./Modal-CwSIOy12.js";import{_ as S}from"./Input-CWukJyi6.js";import{s as w}from"./index-DmpIMitd.js";import"./index-B6MwcRAP.js";import"./index-CpSpfJ4h.js";import"./index-DMWRCe5s.js";import"./index-Bk74RKgI.js";import"./index-C2ZoJfjl.js";import"./index-BeUecfdB.js";import"./index-B3nQ2eiu.js";import"./index-DMUrjB19.js";import"./index-puHQxlHh.js";import"./index-hSegFKzE.js";import"./index-CW7MCMFN.js";import"./index-cteAv5J9.js";import"./postcss-BEpFf2j4.js";import"./postcss-DXO0iv9d.js";import"./index-DDLxGx8D.js";import"./index-B4AnWLoV.js";import"./useCommonUtilities-BgDhORlD.js";import"./index-DxZUXwSo.js";import"./index-CSQz5owT.js";import"./index-CJbdPjwK.js";import"./index-Moky5Myd.js";import"./index-DEIDRqql.js";const Z={class:"h-[99vh]"},H={class:"text-xl font-bold white-space-nowrap"},I={key:0,class:"fa-solid fa-plus"},J={key:1,class:"fa-solid fa-pencil"},K={class:"flex gap-x-3 py-2"},M={class:"grid grid-cols-1 w-full shadow-2xl border rounded-md gap-4 p-6"},O={class:"w-full"},Q={class:"max-h-64 overflow-y-auto border border-gray-200 rounded-md p-2"},R={class:"grid grid-cols-1 gap-2"},W=["onClick"],X={class:"flex items-center justify-between"},Y={class:"font-medium text-sm"},ee={key:0,class:"fa-solid fa-check text-blue-600"},se={key:0,class:"text-red-500 text-sm mt-1"},te={key:1,class:"mt-4"},ie={class:"text-sm font-medium text-gray-700 mb-2"},oe={class:"flex flex-wrap gap-2"},re=["onClick"],ze={__name:"Index",props:{ticketTypes:Array,services:Array},setup(_){const f=_,V=[{header:"Tipo de Ticket",field:"name",filter:!0},{header:"Servicios Asociados",field:"services_count",filter:!1,type:"html-custom",renderer:s=>{const e=s.services?s.services.length:0;return`<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                ${e} servicio${e!==1?"s":""}
              </span>`}},{header:"Servicios",field:"services_list",filter:!1,type:"html-custom",renderer:s=>{if(!s.services||s.services.length===0)return'<span class="text-gray-500 italic">Sin servicios</span>';const e=s.services.map(g=>g.title).join(", "),i=e.length>50?e.substring(0,50)+"...":e;return`<span class="text-sm" title="${e}">${i}</span>`}}],v=z(),$=B(),d=x(!1),n=x(!1),m=x(""),t=D({id:null,name:"",services:[]}),j={action:()=>{t.reset(),d.value=!1,n.value=!0}},A=[{action:s=>{t.reset(),n.value=!0,d.value=!0,t.id=s.id,t.name=s.name,t.services=s.services?s.services.map(e=>e.id):[]},severity:"secondary",icon:"fa-solid fa-pencil text-sm"},{action:(s,e)=>{$.require({target:e.currentTarget,message:"¿Seguro de eliminar el tipo de ticket "+s.name+"?",icon:"fa-solid fa-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-sm p-button-danger",rejectLabel:"Cancelar",acceptLabel:"Eliminar",accept:()=>{F.delete(route("ticketTypes.destroy",s.id),{onSuccess:()=>{v.add({severity:"error",icon:"fa-solid fa-trash-can",summary:"¡Acción realizada!",detail:"Tipo de ticket eliminado con éxito",group:"customTooltipDataTable",life:5e3})}})}})},severity:"danger",icon:"fa-regular fa-trash-can text-sm"}],L=T(()=>m.value?f.services.filter(s=>s.title.toLowerCase().includes(m.value.toLowerCase())):f.services),b=T(()=>f.services.filter(s=>t.services.includes(s.id))),k=s=>{t.services.includes(s)?t.services=t.services.filter(e=>e!==s):t.services.push(s)},E=()=>{d.value?t.put(route("ticketTypes.update",t.id),{onSuccess:()=>{n.value=!1,v.add({severity:"success",icon:"fa-solid fa-check",summary:"¡Éxito!",detail:"Tipo de ticket actualizado con éxito",group:"customTooltipDataTable",life:3e3})}}):t.post(route("ticketTypes.store"),{onSuccess:()=>{n.value=!1,v.add({severity:"success",icon:"fa-solid fa-check",summary:"¡Éxito!",detail:"Tipo de ticket creado con éxito",group:"customTooltipDataTable",life:3e3})}})};return(s,e)=>(l(),a(h,null,[o("div",Z,[c(N,{columnas:V,add:j,data:_.ticketTypes,actions:A},null,8,["data"])]),c(P,{visible:n.value,"onUpdate:visible":e[3]||(e[3]=i=>n.value=i),width:"70vw","close-on-escape":""},{title:p(()=>[o("span",H,u(d.value?"Editar":"Agregar")+" Tipo de Ticket ",1)]),icon:p(()=>[d.value?(l(),a("i",J)):(l(),a("i",I))]),footer:p(()=>[c(r(w),{onClick:E,title:"Guardar",severity:"success",label:"Guardar",outlined:"",icon:"fa-solid fa-save",class:"!h-8",loading:r(t).processing},null,8,["loading"]),c(r(w),{onClick:e[2]||(e[2]=i=>n.value=!1),title:"Cancelar",severity:"danger",label:"Cancelar",outlined:"",icon:"fa-solid fa-times",class:"!h-8"})]),default:p(()=>[o("div",K,[o("div",M,[c(S,{label:"Nombre del Tipo de Ticket",modelValue:r(t).name,"onUpdate:modelValue":e[0]||(e[0]=i=>r(t).name=i),"error-message":r(t).errors.name,placeholder:"Ej: Ticket VIP, Ticket Estándar, etc."},null,8,["modelValue","error-message"]),o("div",O,[e[5]||(e[5]=o("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Servicios Asociados ",-1)),c(S,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=i=>m.value=i),placeholder:"Buscar servicios...",class:"mb-3"},null,8,["modelValue"]),o("div",Q,[o("div",R,[(l(!0),a(h,null,C(L.value,i=>(l(),a("div",{key:i.id,onClick:g=>k(i.id),class:U([{"bg-blue-100 border-blue-500":r(t).services.includes(i.id),"bg-gray-50 border-gray-200":!r(t).services.includes(i.id)},"p-3 rounded-md cursor-pointer border-2 hover:bg-blue-50 transition-colors duration-200"])},[o("div",X,[o("span",Y,u(i.title),1),r(t).services.includes(i.id)?(l(),a("i",ee)):y("",!0)])],10,W))),128))])]),r(t).errors.services?(l(),a("div",se,u(r(t).errors.services),1)):y("",!0),b.value.length>0?(l(),a("div",te,[o("h4",ie," Servicios Seleccionados ("+u(b.value.length)+") ",1),o("div",oe,[(l(!0),a(h,null,C(b.value,i=>(l(),a("span",{key:i.id,class:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},[q(u(i.title)+" ",1),o("button",{onClick:g=>k(i.id),class:"ml-2 inline-flex items-center justify-center w-4 h-4 rounded-full bg-blue-200 hover:bg-blue-300"},e[4]||(e[4]=[o("i",{class:"fa-solid fa-times text-xs"},null,-1)]),8,re)]))),128))])])):y("",!0)])])])]),_:1},8,["visible"]),c(r(G))],64))}};export{ze as default};
