import{C as ee,D as te,eC as oe,ez as ne,eA as se,em as re,e8 as ie,eB as le,e2 as H,es as ae,dT as de,e9 as K,eK as ce,e as ue,e6 as pe,c as fe,o as c,w as D,b,dX as ve,E as R,m as me,g as x,f as u,r as U,d as v,x as he,a as n,F as _,i as P,n as N,t as d,u as C,A as ye,y as Z}from"./app-BWib5eXO.js";import{F as be}from"./index-H1-HmqXs.js";import{O as I}from"./index-CYS8p4m6.js";import{a as ge}from"./index-1MVZi4D-.js";import{R as we}from"./index-Fb3eDVF1.js";import{s as Ce}from"./index-gnfV9sVP.js";import{s as ke}from"./index-BCjtCngz.js";import{_ as Le}from"./Datatable-BcrgxSFt.js";import{_ as M}from"./Input-CI2_0FkY.js";import{_ as _e}from"./Modal-BBnP55YX.js";import{_ as xe}from"./AppLayout-BSuDxkcU.js";import"./sweetalert2.esm.all-DV3w3JmD.js";import{a as De}from"./toasts-Bf1FAz7R.js";import"./index-ChxBCW4X.js";import"./index-sMg_zPJf.js";import"./index-Bum3vL2N.js";import"./index-viLQsilq.js";import"./index-BCBQy-vn.js";import"./index-C0TuxGfY.js";import"./index-CZdvmSJ5.js";import"./index-BW25Ygt6.js";import"./index-DBBh2usp.js";import"./filepond-plugin-image-preview.min-CbCwKa3N.js";import"./index-CbkbWGAm.js";import"./useCommonUtilities-Bn79kAg2.js";import"./postcss-B1G8Shmz.js";import"./index-L1460jno.js";import"./index-B2J3qTGC.js";import"./index-ChfhMpZP.js";import"./index-D8E_UDlO.js";import"./index-QK53yA0m.js";var Ee=ee`
    .p-popover {
        margin-block-start: dt('popover.gutter');
        background: dt('popover.background');
        color: dt('popover.color');
        border: 1px solid dt('popover.border.color');
        border-radius: dt('popover.border.radius');
        box-shadow: dt('popover.shadow');
    }

    .p-popover-content {
        padding: dt('popover.content.padding');
    }

    .p-popover-flipped {
        margin-block-start: calc(dt('popover.gutter') * -1);
        margin-block-end: dt('popover.gutter');
    }

    .p-popover-enter-from {
        opacity: 0;
        transform: scaleY(0.8);
    }

    .p-popover-leave-to {
        opacity: 0;
    }

    .p-popover-enter-active {
        transition:
            transform 0.12s cubic-bezier(0, 0, 0.2, 1),
            opacity 0.12s cubic-bezier(0, 0, 0.2, 1);
    }

    .p-popover-leave-active {
        transition: opacity 0.1s linear;
    }

    .p-popover:after,
    .p-popover:before {
        bottom: 100%;
        left: calc(dt('popover.arrow.offset') + dt('popover.arrow.left'));
        content: ' ';
        height: 0;
        width: 0;
        position: absolute;
        pointer-events: none;
    }

    .p-popover:after {
        border-width: calc(dt('popover.gutter') - 2px);
        margin-left: calc(-1 * (dt('popover.gutter') - 2px));
        border-style: solid;
        border-color: transparent;
        border-bottom-color: dt('popover.background');
    }

    .p-popover:before {
        border-width: dt('popover.gutter');
        margin-left: calc(-1 * dt('popover.gutter'));
        border-style: solid;
        border-color: transparent;
        border-bottom-color: dt('popover.border.color');
    }

    .p-popover-flipped:after,
    .p-popover-flipped:before {
        bottom: auto;
        top: 100%;
    }

    .p-popover.p-popover-flipped:after {
        border-bottom-color: transparent;
        border-top-color: dt('popover.background');
    }

    .p-popover.p-popover-flipped:before {
        border-bottom-color: transparent;
        border-top-color: dt('popover.border.color');
    }
`,Oe={root:"p-popover p-component",content:"p-popover-content"},Se=te.extend({name:"popover",style:Ee,classes:Oe}),Ae={name:"BasePopover",extends:Ce,props:{dismissable:{type:Boolean,default:!0},appendTo:{type:[String,Object],default:"body"},baseZIndex:{type:Number,default:0},autoZIndex:{type:Boolean,default:!0},breakpoints:{type:Object,default:null},closeOnEscape:{type:Boolean,default:!0}},style:Se,provide:function(){return{$pcPopover:this,$parentInstance:this}}},q={name:"Popover",extends:Ae,inheritAttrs:!1,emits:["show","hide"],data:function(){return{visible:!1}},watch:{dismissable:{immediate:!0,handler:function(e){e?this.bindOutsideClickListener():this.unbindOutsideClickListener()}}},selfClick:!1,target:null,eventTarget:null,outsideClickListener:null,scrollHandler:null,resizeListener:null,container:null,styleElement:null,overlayEventListener:null,documentKeydownListener:null,beforeUnmount:function(){this.dismissable&&this.unbindOutsideClickListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.destroyStyle(),this.unbindResizeListener(),this.target=null,this.container&&this.autoZIndex&&K.clear(this.container),this.overlayEventListener&&(I.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null),this.container=null},mounted:function(){this.breakpoints&&this.createStyle()},methods:{toggle:function(e,l){this.visible?this.hide():this.show(e,l)},show:function(e,l){this.visible=!0,this.eventTarget=e.currentTarget,this.target=l||e.currentTarget},hide:function(){this.visible=!1},onContentClick:function(){this.selfClick=!0},onEnter:function(e){var l=this;ce(e,{position:"absolute",top:"0"}),this.alignOverlay(),this.dismissable&&this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.autoZIndex&&K.set("overlay",e,this.baseZIndex+this.$primevue.config.zIndex.overlay),this.overlayEventListener=function(p){l.container.contains(p.target)&&(l.selfClick=!0)},this.focus(),I.on("overlay-click",this.overlayEventListener),this.$emit("show"),this.closeOnEscape&&this.bindDocumentKeyDownListener()},onLeave:function(){this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener(),this.unbindDocumentKeyDownListener(),I.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null,this.$emit("hide")},onAfterLeave:function(e){this.autoZIndex&&K.clear(e)},alignOverlay:function(){le(this.container,this.target,!1);var e=H(this.container),l=H(this.target),p=0;e.left<l.left&&(p=l.left-e.left),this.container.style.setProperty(ae("popover.arrow.left").name,"".concat(p,"px")),e.top<l.top&&(this.container.setAttribute("data-p-popover-flipped","true"),!this.isUnstyled&&de(this.container,"p-popover-flipped"))},onContentKeydown:function(e){e.code==="Escape"&&this.closeOnEscape&&(this.hide(),ie(this.target))},onButtonKeydown:function(e){switch(e.code){case"ArrowDown":case"ArrowUp":case"ArrowLeft":case"ArrowRight":e.preventDefault()}},focus:function(){var e=this.container.querySelector("[autofocus]");e&&e.focus()},onKeyDown:function(e){e.code==="Escape"&&this.closeOnEscape&&(this.visible=!1)},bindDocumentKeyDownListener:function(){this.documentKeydownListener||(this.documentKeydownListener=this.onKeyDown.bind(this),window.document.addEventListener("keydown",this.documentKeydownListener))},unbindDocumentKeyDownListener:function(){this.documentKeydownListener&&(window.document.removeEventListener("keydown",this.documentKeydownListener),this.documentKeydownListener=null)},bindOutsideClickListener:function(){var e=this;!this.outsideClickListener&&re()&&(this.outsideClickListener=function(l){e.visible&&!e.selfClick&&!e.isTargetClicked(l)&&(e.visible=!1),e.selfClick=!1},document.addEventListener("click",this.outsideClickListener))},unbindOutsideClickListener:function(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener),this.outsideClickListener=null,this.selfClick=!1)},bindScrollListener:function(){var e=this;this.scrollHandler||(this.scrollHandler=new se(this.target,function(){e.visible&&(e.visible=!1)})),this.scrollHandler.bindScrollListener()},unbindScrollListener:function(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener:function(){var e=this;this.resizeListener||(this.resizeListener=function(){e.visible&&!ne()&&(e.visible=!1)},window.addEventListener("resize",this.resizeListener))},unbindResizeListener:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},isTargetClicked:function(e){return this.eventTarget&&(this.eventTarget===e.target||this.eventTarget.contains(e.target))},containerRef:function(e){this.container=e},createStyle:function(){if(!this.styleElement&&!this.isUnstyled){var e;this.styleElement=document.createElement("style"),this.styleElement.type="text/css",oe(this.styleElement,"nonce",(e=this.$primevue)===null||e===void 0||(e=e.config)===null||e===void 0||(e=e.csp)===null||e===void 0?void 0:e.nonce),document.head.appendChild(this.styleElement);var l="";for(var p in this.breakpoints)l+=`
                        @media screen and (max-width: `.concat(p,`) {
                            .p-popover[`).concat(this.$attrSelector,`] {
                                width: `).concat(this.breakpoints[p],` !important;
                            }
                        }
                    `);this.styleElement.innerHTML=l}},destroyStyle:function(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)},onOverlayClick:function(e){I.emit("overlay-click",{originalEvent:e,target:this.target})}},directives:{focustrap:be,ripple:we},components:{Portal:ge}},Te=["aria-modal"];function Pe(t,e,l,p,E,i){var O=ue("Portal"),k=pe("focustrap");return c(),fe(O,{appendTo:t.appendTo},{default:D(function(){return[b(ve,R({name:"p-popover",onEnter:i.onEnter,onLeave:i.onLeave,onAfterLeave:i.onAfterLeave},t.ptm("transition")),{default:D(function(){return[E.visible?me((c(),u("div",R({key:0,ref:i.containerRef,role:"dialog","aria-modal":E.visible,onClick:e[3]||(e[3]=function(){return i.onOverlayClick&&i.onOverlayClick.apply(i,arguments)}),class:t.cx("root")},t.ptmi("root")),[t.$slots.container?U(t.$slots,"container",{key:0,closeCallback:i.hide,keydownCallback:function(S){return i.onButtonKeydown(S)}}):(c(),u("div",R({key:1,class:t.cx("content"),onClick:e[0]||(e[0]=function(){return i.onContentClick&&i.onContentClick.apply(i,arguments)}),onMousedown:e[1]||(e[1]=function(){return i.onContentClick&&i.onContentClick.apply(i,arguments)}),onKeydown:e[2]||(e[2]=function(){return i.onContentKeydown&&i.onContentKeydown.apply(i,arguments)})},t.ptm("content")),[U(t.$slots,"default")],16))],16,Te)),[[k]]):x("",!0)]}),_:3},16,["onEnter","onLeave","onAfterLeave"])]}),_:3},8,["appendTo"])}q.render=Pe;const Ie={class:"h-[99vh]"},Ve={class:"gap-y-2 flex flex-col"},ze={class:"flex flex-col w-full justify-between font-bold"},Ke={key:0,class:"flex flex-col gap-y-2"},Re={class:"flex justify-between gap-x-4"},Be=["onClick"],Fe={class:"flex gap-2 divide-x-4 divide-white items-center"},je={class:"p-1"},He={class:"p-1 pl-3"},Ue={class:"flex flex-col w-full justify-between font-bold"},Ne={class:"flex justify-end gap-x-2"},Ze=["loading"],Me={class:"flex flex-col gap-4"},qe={class:"font-medium block mb-2"},We={class:"w-full bg-gray-200 rounded-md p-2 grid grid-cols-2 divide-y-2 md:flex space-x-2"},Ge=["onClick"],Xe={class:"flex flex-col gap-y-2 h-64 overflow-auto"},Ye={key:0},Je={class:"flex items-center gap-x-8 border-b shadow-md justify-between p-3 rounded-md hover:bg-gray-300"},Qe={class:"flex flex-col"},$e={class:"font-bold flex items-center gap-x-2"},et={class:"text-xs"},tt={class:"flex flex-col"},ot={class:"text-sm"},nt={class:"font-bold"},st={key:1},rt={class:"flex items-center gap-x-8 border-b shadow-md justify-between p-3 rounded-md hover:bg-gray-300"},it={class:"flex flex-col"},lt={class:"font-bold flex items-center gap-x-2"},at={class:"text-xs"},dt={class:"text-xs"},ct={class:"flex flex-col"},ut={class:"text-sm"},pt={class:"font-bold"},Zt={__name:"Index",props:{payments:Array},setup(t){const e=v(!1),{toast:l}=De(),p=v(1),E=[{name:"Agrupados",value:1},{name:"Detalles",value:2}],i=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}),O=r=>{if(r==null||r==null)return"Sin definir";var s=new Date(new Date(r).getTime()+new Date(r).getTimezoneOffset()*6e4);return s},k=v(!1),f=he({date:new Date,startDate:new Date,endDate:new Date,amount:0,proveedor_id:"",file:"",description:""}),S=v([]),h=v([new Date,new Date]),g=v(),B=v([]),y=v(),A=v(null),W={action:()=>{A.value=null,h.value=[new Date,new Date],f.reset(),T(),e.value=!0}},G=[{name:"Ver",icon:"fa-solid fa-pencil",severity:"info",action:r=>{e.value=!0,A.value=r.id,f.date=r.date,h.value=[O(r.startDate),O(r.endDate)],f.amount=r.amount,y.value=r.proveedor_id,T()}}],X=[{header:"Proveedor",field:"proveedor.nombre",filter:!0},{header:"Fecha de Pago",field:"date",type:"date",filter:!0},{header:"Valor",field:"amount",type:"currency"},{header:"Fecha Inicio",field:"startDate",type:"date",filter:!0},{header:"Fecha Fin",field:"endDate",type:"date",filter:!0},{header:"Comprobante",field:"comprobante",type:"html-custom",renderer:r=>`<a href="${r.comprobante}" class="text-sky-600 underline" target="_blank">Ver Comprobante</a>`}],T=()=>{ye.get(route("get.booking.time.range"),{params:{start_date:new Date(h.value[0]).toISOString().split("T")[0],end_date:new Date(h.value[1]).toISOString().split("T")[0]}}).then(r=>{S.value=r.data.proveedores,g.value=r.data.bookingTimeRange.filter(s=>{let m=y.value;return s.proveedors.map(o=>o.proveedor_id).includes(m)}),B.value=[{name:"RESERVADO",value:g.value.filter(s=>s.status=="RESERVADO"),color:"bg-blue-200"},{name:"COMPLETADA",value:g.value.filter(s=>s.status=="COMPLETADA"),color:"bg-green-200"},{name:"CANCELADA",value:g.value.filter(s=>s.status=="CANCELADA"),color:"bg-red-200"},{name:"NO SHOW",value:g.value.filter(s=>s.status=="NO SHOW"),color:"bg-yellow-200"},{name:"CAMBIO DE FECHA",value:g.value.filter(s=>s.status=="CAMBIO DE FECHA"),color:"bg-gray-200"},{name:"REUBICADO",value:g.value.filter(s=>s.status=="REUBICADO"),color:"bg-yellow-200"}]})},F=v(),V=v([]),j=v([]),Y=(r,s)=>{j.value=s.value.reduce((m,L)=>{const o=L.title;return m[o]||(m[o]={count:0,pasajeros:0,total:0}),m[o].count+=1,m[o].pasajeros+=L.adults,m[o].total+=L.proveedors.filter(a=>a.proveedor_id==y.value).reduce((a,w)=>a+w.cost,0),m},{}),V.value=s,F.value.toggle(r)};function J(r){f.file=r.target.files[0]}const Q=()=>{k.value=!0;let r=new FormData;if(r.append("proveedor_id",y.value),r.append("amount",f.amount),r.append("comprobante",f.file),r.append("date",new Date(f.date).toISOString().split("T")[0]),console.log(new Date(h.value[0]).toISOString().split("T")[0],new Date(h.value[1]).toISOString().split("T")[0]),r.append("startDate",new Date(h.value[0]).toISOString().split("T")[0]),r.append("endDate",new Date(h.value[1]).toISOString().split("T")[0]),r.append("description",f.description),A.value){Z.post(route("paymentProveedors.update",A.value),r,{onSuccess:()=>{l("success","Pago Actualizado con exito"),k.value=!1,e.value=!1}});return}Z.post(route("paymentProveedors.store"),r,{onSuccess:()=>{l("success","Pago Actualizado con exito"),k.value=!1,e.value=!1}})};return(r,s)=>{const m=ke,L=q;return c(),u(_,null,[b(xe,{title:"Pagos"},{default:D(()=>[n("div",Ie,[b(Le,{add:W,columnas:X,data:t.payments,actions:G,title:"Pagos"},null,8,["data"])]),b(_e,{modelValue:e.value,"onUpdate:modelValue":s[5]||(s[5]=o=>e.value=o),title:"Añadir Pagos"},{default:D(()=>[n("div",Ve,[n("div",ze,[s[6]||(s[6]=n("p",null,"Fechas",-1)),b(m,{modelValue:h.value,"onUpdate:modelValue":s[0]||(s[0]=o=>h.value=o),selectionMode:"range",dateFormat:"dd/mm/yy",class:"w-full",manualInput:!1,onValueChange:T},null,8,["modelValue"])]),b(M,{label:"Proveedor",type:"dropdown","option-label":"proveedor","option-value":"proveedor_id",onValueChange:T,modelValue:y.value,"onUpdate:modelValue":s[1]||(s[1]=o=>y.value=o),options:S.value},null,8,["modelValue","options"]),y.value?(c(),u("div",Ke,[n("div",Re,[(c(!0),u(_,null,P(B.value,o=>(c(),u("div",{class:N([`${o.color} ${o.value.length>0?"cursor-pointer":"hidden"} `,"rounded-lg py-2 border w-full flex flex-col gap-y-1 items-center font-bold cursor-pointer scale-90 hover:scale-100 shadow-sm hover:shadow-lg transition-all duration-300"]),onClick:a=>Y(a,o)},[n("h1",null,d(o.name),1),n("div",Fe,[n("p",je,d(o.value.length)+" Reservas",1),n("p",He,d(o.value.reduce((a,w)=>a+w.adults,0))+" Pasajeros ",1)]),n("p",null,d(C(i).format(o.value.reduce((a,w)=>a+w.proveedors.filter(z=>z.proveedor_id==y.value).reduce((z,$)=>z+$.cost,0),0))),1)],10,Be))),256))]),n("div",Ue,[s[7]||(s[7]=n("p",null,"Fecha en que realizó el pago",-1)),b(m,{modelValue:C(f).date,"onUpdate:modelValue":s[2]||(s[2]=o=>C(f).date=o),dateFormat:"dd/mm/yy",class:"w-full",manualInput:!1},null,8,["modelValue"])]),b(M,{label:"Valor",type:"number",mode:"currency",modelValue:C(f).amount,"onUpdate:modelValue":s[3]||(s[3]=o=>C(f).amount=o)},null,8,["modelValue"]),n("input",{type:"file",onChange:J,label:"Comprobante"},null,32)])):x("",!0),n("div",Ne,[n("button",{onClick:s[4]||(s[4]=o=>e.value=!1),class:"bg-red-500 text-white px-4 py-2 rounded-md"}," Cancelar "),y.value?(c(),u("button",{key:0,loading:k.value,onClick:Q,class:"bg-green-500 text-white px-4 py-2 rounded-md"}," Guardar ",8,Ze)):x("",!0)])])]),_:1},8,["modelValue"])]),_:1}),b(L,{ref_key:"op",ref:F},{default:D(()=>[n("div",Me,[n("div",null,[n("span",qe,d(V.value.name),1),n("div",We,[(c(),u(_,null,P(E,o=>n("div",{onClick:a=>p.value=o.value,class:N(["w-full rounded-lg text-center py-2 text-sm md:text-md cursor-pointer",p.value==o.value?"bg-white":"hover:bg-white/30"])},d(o.name),11,Ge)),64))]),n("div",Xe,[p.value==1?(c(),u("div",Ye,[(c(!0),u(_,null,P(j.value,(o,a)=>(c(),u("div",Je,[n("div",Qe,[n("span",$e,[n("p",null,d(a),1)]),n("span",et,d(o.count)+" Reservas",1)]),n("div",tt,[n("span",ot,d(o.pasajeros)+" Pasajeros",1),n("span",nt,d(C(i).format(o.total)),1)])]))),256))])):x("",!0),p.value==2?(c(),u("div",st,[(c(!0),u(_,null,P(V.value.value,o=>(c(),u("div",rt,[n("div",it,[n("span",lt,[n("p",null,d(o.title),1)]),n("span",at,d(o.cliente_name),1),n("span",dt,d(o.fecha),1)]),n("div",ct,[n("span",ut,d(o.adults)+" Pasajeros",1),n("span",pt,d(C(i).format(o.proveedors.filter(a=>a.proveedor_id==y.value).reduce((a,w)=>a+w.cost,0))),1)])]))),256))])):x("",!0)])])])]),_:1},512)],64)}}};export{Zt as default};
