import{s as B}from"./index-_tyHtWSK.js";import{d as c,u as E,a0 as R,A as x,B as j,p as T,f as A,o as v,a as r,b as d,h as t,t as u,g as _,c as V,k as $}from"./app-BmHNQmxM.js";import{_ as n}from"./Input-C7SEwENl.js";import{a as f,g as D}from"./Toats-CRqRGqmn.js";import{u as H}from"./useCommonUtilities-BgDhORlD.js";import{u as N}from"./Auth-Brt-17UM.js";import{S as L}from"./Service-CsvmoYGt.js";const{hasRole:q}=N(),{currencyFormat:F}=H();class z{loading=c(!1);statuesOptions=[{text:"RESERVADO",color:"blue"},{text:"COMPLETADA",color:"teal"},{text:"CAMBIO DE FECHA",color:"gray"},{text:"NO SHOW",color:"amber"},{text:"REUBICADO",color:"orange"},{text:"CANCELADA",color:"green"},{text:"SIN CONFIRMAR",color:"purple"},{text:"PROBLEMATICA",color:"red"}];channels=c([]);bookingService=c();form=E({id:"",service_id:"",date:"",adults:1,adults_nacionales:0,adults_extranjeros:0,time_service:"",boys:0,boys_nacionales:0,boys_extranjeros:0,cliente_name:"",cliente_phone:"",cliente_city:"",cliente_building:"",reserva:0,method_id:"",channel_id:q("vendedor")?"9d75e9d5-6e8f-48c1-9f56-276fd185297e":"9d99a95f-6c3d-48fd-aa7d-6ef4e6860123",saldo:0,total:0,total_real:0,percent_channel:0,observations:"",code_booking:""});formatDateTime(a,i){const[b,k,C]=a.split("-"),[w,m]=i.split(":");return`${b}-${k}-${C},${w}:${m}`}constructor(a){this.bookingService=a,a&&(console.log(a),Object.keys(this.form).forEach(i=>{a[i]!==void 0&&(this.form[i]=a[i])}),this.form.date=this.formatDateTime(a.date,a.hour))}async create(){if(!this.form.service_id)return f("Selecciona un Servicio");if(!this.form.date)return f("Selecciona una fecha");if(!this.form.channel_id)return f("Selecciona un canal");if(!this.form.cliente_name)return f("Ingresa el nombre del cliente");if(!this.form.cliente_phone)return f("Ingresa el telefono del cliente");if(!this.form.cliente_city)return f("Ingresa la ciudad del cliente");if(!this.form.cliente_building)return f("Ingresa el edificio del cliente");this.form.total_real=this.valorReal.value,this.form.percent_channel=this.channels.value.find(a=>a.id==this.form.channel_id).percent,this.loading.value=!0,this.form.post(route("BookingServices.store")),this.loading.value=!1}async update(){this.form.total_real=this.valorReal.value,this.form.percent_channel=this.channels.value.find(a=>a.id==this.form.channel_id).percent,this.loading.value=!0,this.form.put(route("BookingServices.update",this.bookingService.id)),D("Reserva actualizada Exitosamente"),this.loading.value=!1}async getChannels(){const{data:a}=await R.get(route("channels.index"));return this.channels.value=a,a}async getMethods(){const{data:a}=await R.get(route("paymentMethods.index"));return a}getColorStatus(){return this.statuesOptions.find(a=>a.text==this.bookingService.status.toUpperCase()).color}valorReal=x(()=>{let a=this.channels.value.find(b=>b.id==this.form.channel_id),i=a?a.percent/100:0;return this.form.total-this.form.total*i});valorRealFormat=x(()=>F(this.valorReal.value));valuePasajeros=x(()=>F(this.form.total/this.form.adults));valueCanalVenta=x(()=>{let a=this.channels.value.find(b=>b.id==this.form.channel_id),i=a?a.percent/100:0;return F(this.form.total*i)});updateTotals(){this.form.adults=(parseInt(this.form.adults_nacionales)||0)+(parseInt(this.form.adults_extranjeros)||0),this.form.boys=(parseInt(this.form.boys_nacionales)||0)+(parseInt(this.form.boys_extranjeros)||0)}submit(){return this.updateTotals(),this.bookingService?this.update():this.create()}}const W={class:""},G={class:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 p-3 space-y-2"},J={class:"grid grid-cols-1 md:grid-cols-4 gap-2"},K={class:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 p-3 space-y-2"},Q={class:"grid grid-cols-2 md:grid-cols-4 gap-2"},X={class:"grid grid-cols-2 gap-2 bg-blue-50 dark:bg-blue-900/20 p-2 rounded border border-blue-200 dark:border-blue-800"},Y={class:"flex items-center justify-center gap-2"},Z={class:"text-lg font-bold text-blue-900 dark:text-blue-100"},ee={class:"flex items-center justify-center gap-2"},te={class:"text-lg font-bold text-blue-900 dark:text-blue-100"},oe={class:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 p-3 space-y-2"},ae={class:"grid grid-cols-1 md:grid-cols-4 gap-2"},le={class:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 p-3 space-y-2"},re={class:"grid grid-cols-1 md:grid-cols-4 gap-2"},se={key:0,class:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-lg p-3 border border-blue-200 dark:border-blue-800"},ne={class:"flex items-center justify-between"},de={class:"text-xl font-bold text-blue-900 dark:text-blue-100"},ie={class:"grid grid-cols-2 gap-2 mt-2"},ue={class:"text-xs text-blue-600 dark:text-blue-400"},me={class:"text-xs text-blue-600 dark:text-blue-400"},ce={key:1,class:"grid grid-cols-3 gap-2"},be={class:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 rounded p-2 border border-green-200 dark:border-green-800 text-center"},pe={class:"text-sm font-bold text-green-900 dark:text-green-100"},ge={class:"bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/20 dark:to-orange-800/20 rounded p-2 border border-orange-200 dark:border-orange-800 text-center"},ve={class:"text-sm font-bold text-orange-900 dark:text-orange-100"},fe={class:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 rounded p-2 border border-blue-200 dark:border-blue-800 text-center"},xe={class:"text-sm font-bold text-blue-900 dark:text-blue-100"},ye={class:"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-700 p-3 space-y-2"},he={__name:"FormFirst",props:{bookingService:Object},setup(S){const{hasRole:a}=N(),i=c([]),b=c([]),k=c([]),C=S,w=new L,m=new z(C.bookingService),o=m.form,y=x(()=>{const s=parseInt(o.adults_nacionales)||0,e=parseInt(o.adults_extranjeros)||0;return s+e}),h=x(()=>{const s=parseInt(o.boys_nacionales)||0,e=parseInt(o.boys_extranjeros)||0;return s+e});j([y,h],([s,e])=>{o.adults=s,o.boys=e}),T(async()=>{i.value=await w.getServices(),b.value=await m.getChannels(),k.value=await m.getMethods(),console.log(b.value)});const U=c(0),O=c(0),p=c(0),g=c(0);function P(){const s=i.value.find(e=>e.id===o.service_id);s?(U.value=s.adults_price||0,O.value=s.boys_price||0,a("vendedor")&&(p.value=s.adults_price||0,g.value=s.boys_price||0)):(U.value=0,O.value=0)}const I=x(()=>{if(a("vendedor")){const s=y.value*(parseFloat(p.value)||0),e=h.value*(parseFloat(g.value)||0);return s+e}return parseFloat(o.total)||0});return j(I,s=>{a("vendedor")&&(o.total=s)}),j([p,g],()=>{if(a("vendedor")){const s=y.value*(parseFloat(p.value)||0),e=h.value*(parseFloat(g.value)||0);o.total=s+e}}),(s,e)=>{const M=B;return v(),A("div",W,[r("form",{class:"space-y-3",onSubmit:e[18]||(e[18]=$((...l)=>t(m).submit&&t(m).submit(...l),["prevent"]))},[r("div",G,[e[19]||(e[19]=r("h3",{class:"text-sm font-semibold text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-1.5"}," 游늶 Informaci칩n del Servicio ",-1)),r("div",J,[d(n,{modelValue:t(o).service_id,"onUpdate:modelValue":e[0]||(e[0]=l=>t(o).service_id=l),class:"md:col-span-2",type:"dropdown",label:"Servicio","option-label":"title","option-value":"id",onValueChange:P,options:i.value},null,8,["modelValue","options"]),d(n,{label:"Fecha de Reserva",modelValue:t(o).date,"onUpdate:modelValue":e[1]||(e[1]=l=>t(o).date=l),enableTimePicker:!0,type:"datetime",class:"md:col-span-1"},null,8,["modelValue"]),d(n,{label:"Tiempo del Servicio",type:"dropdown",modelValue:t(o).time_service,"onUpdate:modelValue":e[2]||(e[2]=l=>t(o).time_service=l),options:["20 Minutos","30 Minutos","40 Minutos","1 Hora","2 Horas","6 Horas","12 Horas","24 Horas"]},null,8,["modelValue"])])]),r("div",K,[e[22]||(e[22]=r("h3",{class:"text-sm font-semibold text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-1.5"}," 游논 Pasajeros ",-1)),r("div",Q,[d(n,{label:"Adultos Nac.",type:"number",min:0,modelValue:t(o).adults_nacionales,"onUpdate:modelValue":e[3]||(e[3]=l=>t(o).adults_nacionales=l)},null,8,["modelValue"]),d(n,{label:"Adultos Ext.",type:"number",min:0,modelValue:t(o).adults_extranjeros,"onUpdate:modelValue":e[4]||(e[4]=l=>t(o).adults_extranjeros=l)},null,8,["modelValue"]),d(n,{label:"Ni침os Nac.",type:"number",min:0,modelValue:t(o).boys_nacionales,"onUpdate:modelValue":e[5]||(e[5]=l=>t(o).boys_nacionales=l)},null,8,["modelValue"]),d(n,{label:"Ni침os Ext.",type:"number",min:0,modelValue:t(o).boys_extranjeros,"onUpdate:modelValue":e[6]||(e[6]=l=>t(o).boys_extranjeros=l)},null,8,["modelValue"])]),r("div",X,[r("div",Y,[e[20]||(e[20]=r("span",{class:"text-xs text-blue-600 dark:text-blue-400"},"Adultos:",-1)),r("span",Z,u(y.value),1)]),r("div",ee,[e[21]||(e[21]=r("span",{class:"text-xs text-blue-600 dark:text-blue-400"},"Ni침os:",-1)),r("span",te,u(h.value),1)])])]),r("div",oe,[e[23]||(e[23]=r("h3",{class:"text-sm font-semibold text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-1.5"}," 游녻 Datos del Cliente ",-1)),r("div",ae,[d(n,{label:"Nombre del Pasajero",required:!0,modelValue:t(o).cliente_name,"onUpdate:modelValue":e[7]||(e[7]=l=>t(o).cliente_name=l),class:"md:col-span-1"},null,8,["modelValue"]),d(n,{label:"Tel칠fono",type:"number",modelValue:t(o).cliente_phone,"onUpdate:modelValue":e[8]||(e[8]=l=>t(o).cliente_phone=l)},null,8,["modelValue"]),d(n,{label:"Ciudad",modelValue:t(o).cliente_city,"onUpdate:modelValue":e[9]||(e[9]=l=>t(o).cliente_city=l)},null,8,["modelValue"]),d(n,{label:"Edificio u Hotel",modelValue:t(o).cliente_building,"onUpdate:modelValue":e[10]||(e[10]=l=>t(o).cliente_building=l),class:"md:col-span-1"},null,8,["modelValue"])])]),r("div",le,[e[28]||(e[28]=r("h3",{class:"text-sm font-semibold text-gray-900 dark:text-white border-b border-gray-200 dark:border-gray-700 pb-1.5"}," 游눱 Informaci칩n de Pago ",-1)),r("div",re,[t(a)("vendedor")?(v(),V(n,{key:0,label:"Valor por Adulto",type:"number",mode:"currency",required:!0,modelValue:p.value,"onUpdate:modelValue":e[11]||(e[11]=l=>p.value=l)},null,8,["modelValue"])):_("",!0),t(a)("vendedor")?(v(),V(n,{key:1,label:"Valor por Ni침o",type:"number",mode:"currency",modelValue:g.value,"onUpdate:modelValue":e[12]||(e[12]=l=>g.value=l)},null,8,["modelValue"])):(v(),V(n,{key:2,label:"Valor Total",type:"number",mode:"currency",required:!0,modelValue:t(o).total,"onUpdate:modelValue":e[13]||(e[13]=l=>t(o).total=l)},null,8,["modelValue"])),d(n,{label:"Saldo en Sitio",type:"number",mode:"currency",modelValue:t(o).saldo,"onUpdate:modelValue":e[14]||(e[14]=l=>t(o).saldo=l),step:1e3,min:0,max:t(o).total},null,8,["modelValue","max"]),t(a)("vendedor")?_("",!0):(v(),V(n,{key:3,type:"dropdown","option-label":"name","option-value":"id",options:k.value,modelValue:t(o).method_id,"onUpdate:modelValue":e[15]||(e[15]=l=>t(o).method_id=l),label:"Medio de Pago"},null,8,["options","modelValue"])),t(a)("vendedor")?_("",!0):(v(),V(n,{key:4,type:"dropdown","option-label":"name","option-value":"id",options:b.value,modelValue:t(o).channel_id,"onUpdate:modelValue":e[16]||(e[16]=l=>t(o).channel_id=l),label:"Canal de Venta"},null,8,["options","modelValue"]))]),t(a)("vendedor")?(v(),A("div",se,[r("div",ne,[e[24]||(e[24]=r("span",{class:"text-sm font-medium text-blue-700 dark:text-blue-300"},"游눯 Valor Total:",-1)),r("span",de,"$"+u(I.value.toLocaleString("es-CO")),1)]),r("div",ie,[r("p",ue," 游녿 "+u(y.value)+" adulto(s) 칑 $"+u(parseFloat(p.value||0).toLocaleString("es-CO"))+" = $"+u((y.value*parseFloat(p.value||0)).toLocaleString("es-CO")),1),r("p",me," 游놌 "+u(h.value)+" ni침o(s) 칑 $"+u(parseFloat(g.value||0).toLocaleString("es-CO"))+" = $"+u((h.value*parseFloat(g.value||0)).toLocaleString("es-CO")),1)])])):_("",!0),t(a)("vendedor")?_("",!0):(v(),A("div",ce,[r("div",be,[e[25]||(e[25]=r("p",{class:"text-[10px] text-green-700 dark:text-green-400"},"Valor Pasajero",-1)),r("h1",pe,u(t(m).valuePasajeros),1)]),r("div",ge,[e[26]||(e[26]=r("p",{class:"text-[10px] text-orange-700 dark:text-orange-400"},"Comisiones",-1)),r("h1",ve,u(t(m).valueCanalVenta),1)]),r("div",fe,[e[27]||(e[27]=r("p",{class:"text-[10px] text-blue-700 dark:text-blue-400"},"Total Real",-1)),r("h1",xe,u(t(m).valorRealFormat),1)])]))]),r("div",ye,[d(n,{"rows-textarea":2,label:"游눫 Observaciones",modelValue:t(o).observations,"onUpdate:modelValue":e[17]||(e[17]=l=>t(o).observations=l),type:"textarea"},null,8,["modelValue"]),d(M,{type:"submit",severity:"success",label:S.bookingService?"Actualizar Reserva":"Crear Reserva",loading:t(m).loading.value,class:"w-full"},null,8,["label","loading"])])],32)])}}},Ae=Object.freeze(Object.defineProperty({__proto__:null,default:he},Symbol.toStringTag,{value:"Module"}));export{z as B,Ae as F,he as _};
