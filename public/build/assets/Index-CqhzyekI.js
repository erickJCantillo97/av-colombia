import{s as w}from"./index-7788fJZL.js";import{_ as m,s as k}from"./Input-XTariIoc.js";import{_ as B}from"./Datatable-C_t7Egvg.js";import{_ as M}from"./Modal-BBTSlOXw.js";import{_ as U}from"./AppLayout-DBH3sylV.js";import{d as r,T as N,o as p,c as T,w as c,a as s,b as l,u as i,f as _,t as n,x as $}from"./app-BAVFhd6m.js";import{S as q,a as A}from"./toasts-DRkOXQyQ.js";import"./index-BtKWs8a3.js";import"./index-2pw44bfL.js";import"./postcss-Dkgjma2c.js";import"./index-CeiLtucy.js";import"./index-BuzdczyG.js";const E={class:"h-[99vh]"},j={class:"flex flex-col gap-y-4"},z=s("label",{for:"",class:"font-bold"},"Servicio",-1),F={key:0,class:"flex items-center"},L={key:1},O={class:"flex justify-between w-full items-center"},D={class:"text-xs"},G={class:"flex gap-x-4"},le={__name:"Index",props:{payments:{type:Array,required:!0}},setup(g){const d=r(!1),{toast:u}=A(),f=r([]);r(!1);const t=N({payable_id:"",payable_type:"App\\Models\\Service",method:"",amount:"",currency:"COP",validatePay:!1}),h={action:()=>{d.value=!0}},b=[{action:o=>{q.fire({title:"Confirmar Pago?",text:"Esta seguro de Confirmar este pago?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Si, Confirmar!"}).then(a=>{a.isConfirmed&&(console.log(o),$.post(route("payment.set.state",o.id),{_method:"PUT",status:"Confirmado"},{onSuccess:()=>{u("success","Pago Confirmado con exito")}}))}),x.value=o},severity:"success",icon:"fa-solid fa-wallet text-sm",label:"Validar Pago"}],x=r(),C=o=>{if(t.validatePay&&(t.status="Confirmado"),t.amount==""||t.method==""||t.payable_id==""){u("error","Todos los campos son obligatorios");return}t.payable_id=t.payable_id.id,t.post(route("payments.store"),{onSuccess:()=>{d.value=!1,u("success","Pago Registrado con exito")}})},V=r([]);(()=>{axios.get(route("get.services")).then(o=>{V.value=o.data.services.slice(0,5)})})();const v=r([]);(()=>{axios.get(route("get.services.no.payment")).then(o=>{v.value=Object.values(o.data.bookingNoPayment)})})();const S=[{header:"Servicio",field:"payable.service",filter:!0},{header:"Cliente",field:"payable.cliente_name",filter:!0},{header:"Tipo de Pago",field:"type",filter:!0,format:o=>o.toUpperCase()},{header:"Monto",field:"amount",type:"currency",filter:!0},{header:"Metodo de Pago",field:"metohd_payment.name",filter:!0},{header:"Fecha",field:"created_at",type:"date",filter:!0},{header:"Estado",field:"status",filter:!0,sortable:!0,type:"tag",filtertype:"EQUALS",class:"text-center uppercase",severitys:[{text:"Pendiente",severity:"danger",class:""},{text:"Confirmado",severity:"success",class:""}]}];return(()=>{axios.get(route("paymentMethods.index")).then(o=>{f.value=o.data}).catch(o=>{console.log(o)})})(),(o,a)=>{const P=k,y=w;return p(),T(U,{title:"Pagos"},{default:c(()=>[s("div",E,[l(B,{add:h,columnas:S,actions:b,data:g.payments,title:"Pagos"},null,8,["data"])]),l(M,{modelValue:d.value,"onUpdate:modelValue":a[5]||(a[5]=e=>d.value=e),title:"AÃ±adir Pagos"},{footer:c(()=>[s("div",G,[l(y,{label:"Cancelar",size:"small",severity:"danger",icon:"pi pi-times",onClick:a[4]||(a[4]=e=>d.value=!1)}),l(y,{label:"Guardar",size:"small",severity:"success",icon:"pi pi-save",onClick:C})])]),default:c(()=>[s("form",null,[s("div",j,[s("div",null,[z,l(P,{options:v.value,filter:"",showClear:"",modelValue:i(t).payable_id,"onUpdate:modelValue":a[0]||(a[0]=e=>i(t).payable_id=e),class:"w-full","option-label":"service",placeholder:"Seleccione un servicio"},{value:c(e=>[e.value?(p(),_("div",F,[s("div",null,n(e.value.service)+" - "+n(e.value.cliente_name),1)])):(p(),_("span",L,n(e.placeholder),1))]),option:c(e=>[s("div",O,[s("div",null,[s("p",null,n(e.option.service)+" - "+n(e.option.cliente_name),1),s("p",D,n(e.option.date)+" "+n(e.option.hour),1)]),s("div",null,n(e.option.total_price_sales),1)])]),_:1},8,["options","modelValue"])]),l(m,{label:"Monto",modelValue:i(t).amount,"onUpdate:modelValue":a[1]||(a[1]=e=>i(t).amount=e),mode:"currency",type:"number",required:""},null,8,["modelValue"]),l(m,{label:"Medio de Pago",class:"w-full",min:"0",type:"dropdown","option-label":"name","option-value":"id",options:f.value,modelValue:i(t).method,"onUpdate:modelValue":a[2]||(a[2]=e=>i(t).method=e),required:""},null,8,["options","modelValue"]),l(m,{checkboxLabel:"Pago Verificado",modelValue:i(t).validatePay,"onUpdate:modelValue":a[3]||(a[3]=e=>i(t).validatePay=e),type:"checkbox",required:""},null,8,["modelValue"])])])]),_:1},8,["modelValue"])]),_:1})}}};export{le as default};
