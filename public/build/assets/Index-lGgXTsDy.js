import{d as g,x as ve,y as p,z as H,A as T,q as I,o as A,c as fe,w as S,a as e,b as r,B as v,u as l,C as u,t as i,j as pe,k as j,f as P,g as W,i as _e,n as be,h as ge,F as he,D as G,E as ye}from"./app-ZGisyjXt.js";import{_ as xe,s as we}from"./AppLayout-zoSBTjVs.js";import{s as Ve}from"./index-8ciPU1df.js";import{_ as Ae}from"./Datatable-C_vlSDeQ.js";import{_ as c}from"./Input-C7kEYIVV.js";import{_ as Se}from"./Modal-BKYR1aaX.js";import{s as Ce}from"./index-nI4JaVgP.js";import{a as De}from"./toasts-DRkOXQyQ.js";import{u as je}from"./vee-validate-0S5rNwX7.js";import"./index-COegUE2r.js";import"./index-qVu8Cb6j.js";import"./index-C_Lkp2KG.js";import"./index-CmGlhI0w.js";import"./postcss-BzxeOq4E.js";const Pe={class:"h-[99vh]"},Ee={class:""},Ne={class:"text-xl font-mono font-semibold"},qe={class:"flex justify-end mt-4"},Oe={class:"flex items-center gap-2"},Ue={class:"font-bold text-lg"},$e={class:"flex flex-col gap-y-1.5 text-sm"},ke={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Fe=e("strong",null,"Fecha del Servicio:",-1),Re={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Le=e("strong",null,"Hora del Servicio:",-1),Te={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},ze=e("strong",null,"Cliente:",-1),Me={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Be=e("strong",null,"Ciudad:",-1),He={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Ie=e("strong",null,"Telelfono:",-1),We=["href"],Ge={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Qe=e("strong",null,"Edificio:",-1),Je={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Ke=e("strong",null,"Adultos:",-1),Xe={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Ye=e("strong",null,"Niños:",-1),Ze={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},et=e("strong",null,"Valor:",-1),tt={key:0,class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},st=e("strong",null,"Vendedor:",-1),lt={key:1,class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},ot=e("strong",null,"Fecha de reserva:",-1),at={class:"flex flex-col gap-y-2 mt-2"},rt={class:"flex justify-between"},it=e("h2",{class:"text-xl font-bold"},"Pagos Realizados ",-1),nt={class:"bg-blue-600 text-white p-1 rounded-lg"},dt={class:"flex items-center text-xs justify-between border shadow-xl rounded-md p-1 bg-white"},ut={class:"uppercase font-bold"},ct=e("div",null,null,-1),mt={class:"flex flex-col items-center gap-2"},vt={class:"font-bold text-center"},ft={class:"flex gap-x-2"},Ut={__name:"Index",props:{bookingServices:Array},setup(Q){const{toast:z}=De(),C=g(!1),a=g({}),h=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}),_=g(!1),J={action:()=>{_.value=!0}},M=g([]),K=ve({service_id:p().required(),date:H().required(),adults:T().required(),date:H().required(),adults:T().required(),cliente_name:p().required(),cliente_phone:p().required(),cliente_city:p().required(),cliente_building:p().required(),hour:p().required(),abono:T().required(),method:p().required()}),{values:X,defineField:d,errors:f,meta:pt}=je({validationSchema:K}),[y,Y]=d("service_id"),[E,Z]=d("date"),[x,_t]=d("boys"),[w,bt]=d("adults"),[N,ee]=d("cliente_name"),[q,te]=d("cliente_phone"),[O,se]=d("cliente_city"),[U,le]=d("cliente_building"),[$,oe]=d("hour"),[k,ae]=d("abono"),[F,re]=d("method");x.value=0,w.value=1;const D=g([]);(()=>{axios.get(route("get.services")).then(o=>{D.value=o.data.services.slice(0,5)})})();const ie=[{label:"Detalles",action:o=>{a.value=o,C.value=!0},icon:"fa-solid fa-circle-info text-sm",severity:"info"},{label:"Registrar Pago",action:o=>{form.service_id=o.id,_.value=!0},icon:"fa-solid fa-dollar text-sm",severity:"success"},{label:"Problematica",action:o=>{form.service_id=o.id,_.value=!0},icon:"fa-solid fa-person-dress-burst text-sm",severity:"danger"}],ne=[{field:"cliente_name",header:"Nombre del pasajero",filter:!0,sortable:!0},{field:"cliente_building",header:"Edificio u Hotel",filter:!0,sortable:!0},{field:"service.title",header:"Actividad",filter:!0,sortable:!0},{field:"date",header:"Fecha de la Actividad",filter:!0,sortable:!0,type:"date"},{field:"created_at",header:"Fecha Entrada",filter:!0,sortable:!0,type:"date"},{field:"status",header:"Estado",filter:!0,sortable:!0,type:"tag",filtertype:"EQUALS",class:"text-center uppercase",severitys:[{text:"reservado",severity:"info",class:""},{text:"COMPLETADA",severity:"success",class:""},{text:"DISEÑO",severity:"info",class:""},{text:"NO SHOW",severity:"warn",class:""},{text:"SERVICIO POSTVENTA",severity:"success",class:""},{text:"CANCELADA",severity:"danger",class:"animate-pulse"}]}],de=I(()=>{let o=D.value.find(t=>t.id==y.value);return o?o.adult_tarifa*w.value+o.boy_tarifa*x.value:0}),R=g(!1),ue=o=>{o.preventDefault(),R.value=!0,G.post(route("reservar"),X,{onSuccess:()=>{z("success","Reserva creada con exito"),R.value=!1,_.value=!1}})};(()=>{axios.get(route("paymentMethods.index")).then(o=>{M.value=o.data}).catch(o=>{console.log(o)})})();const B=o=>{const[t,m,V]=o.split("-");return new Date(t,m-1,V)},ce=I(()=>{var o=[],t=D.value.find(n=>n.id==y.value);if(!t)return[];for(var m of t.locks)for(var V=B(m.start_date),b=B(m.end_date),s=V;s<=b;s.setDate(s.getDate()+1))o.push(new Date(s));return o}),L=(o,t)=>{G.post(route("set.states"),{service:a.value.id,state:o,terminated:t},{onSuccess:()=>{C.value=!1,z("success","Reserva "+o)}})};return(o,t)=>{const m=Ve,V=we,b=ye;return A(),fe(xe,{title:"Services"},{default:S(()=>[e("div",Pe,[r(Ae,{actions:ie,add:J,columnas:ne,data:Q.bookingServices,routecreate:"services.create",title:"Reservas"},null,8,["data"])]),r(Se,{modelValue:_.value,"onUpdate:modelValue":t[11]||(t[11]=s=>_.value=s),title:"Añadir Reserva",width:"70vw"},{default:S(()=>[e("form",{onSubmit:pe(ue,["prevent"]),class:"grid grid-cols-1 md:grid-cols-3 gap-4 items-center",novalidate:""},[r(c,v({type:"dropdown",modelValue:l(y),"onUpdate:modelValue":t[0]||(t[0]=s=>u(y)?y.value=s:null),"error-message":l(f).service_id,label:"Servicio","option-label":"title","option-value":"id",options:D.value},l(Y)),null,16,["modelValue","error-message","options"]),r(c,v({label:"Fecha de Reserva","disabled-dates":ce.value,modelValue:l(E),"onUpdate:modelValue":t[1]||(t[1]=s=>u(E)?E.value=s:null),required:"","min-date":new Date,class:"w-full",type:"date","error-message":o.errorDate},l(Z)),null,16,["disabled-dates","modelValue","min-date","error-message"]),r(c,{label:"Pasajeros",type:"number",modelValue:l(w),"onUpdate:modelValue":t[2]||(t[2]=s=>u(w)?w.value=s:null)},null,8,["modelValue"]),r(c,{label:"Niños",type:"number",modelValue:l(x),"onUpdate:modelValue":t[3]||(t[3]=s=>u(x)?x.value=s:null)},null,8,["modelValue"]),r(c,v({label:"Nombre del Pasajero"},l(ee),{modelValue:l(N),"onUpdate:modelValue":t[4]||(t[4]=s=>u(N)?N.value=s:null),"error-message":l(f).cliente_name,class:"w-full"}),null,16,["modelValue","error-message"]),r(c,v({label:"Telefono",modelValue:l(q),"onUpdate:modelValue":t[5]||(t[5]=s=>u(q)?q.value=s:null)},l(te),{"error-message":l(f).cliente_phone,class:"w-full",type:"number"}),null,16,["modelValue","error-message"]),r(c,v({label:"Ciudad de donde Proviene"},l(se),{modelValue:l(O),"onUpdate:modelValue":t[6]||(t[6]=s=>u(O)?O.value=s:null),"error-message":l(f).city,class:"w-full"}),null,16,["modelValue","error-message"]),r(c,v({label:"Edificio u Hotel",class:"w-full"},l(le),{modelValue:l(U),"onUpdate:modelValue":t[7]||(t[7]=s=>u(U)?U.value=s:null),"error-message":l(f).cliente_building}),null,16,["modelValue","error-message"]),r(c,v({type:"time",label:"Hora de Actividad",class:"w-full"},l(oe),{modelValue:l($),"onUpdate:modelValue":t[8]||(t[8]=s=>u($)?$.value=s:null),"error-message":l(f).hour}),null,16,["modelValue","error-message"]),r(c,v({class:"w-full",label:"Abono"},l(ae),{modelValue:l(k),"onUpdate:modelValue":t[9]||(t[9]=s=>u(k)?k.value=s:null),"error-message":l(f).abono,min:"1",type:"number"}),null,16,["modelValue","error-message"]),r(c,v({class:"w-full",min:"0"},l(re),{type:"dropdown","option-label":"name","option-value":"id",options:M.value,modelValue:l(F),"onUpdate:modelValue":t[10]||(t[10]=s=>u(F)?F.value=s:null),label:"Medio de Pago"}),null,16,["options","modelValue"]),e("div",Ee,[e("h1",Ne," Precio total: "+i(l(h).format(de.value)),1)]),e("div",qe,[r(m,{type:"submit",severity:"success",label:"Guardar",loading:R.value},null,8,["loading"])])],32)]),_:1},8,["modelValue"]),r(l(Ce)),r(V,{visible:C.value,"onUpdate:visible":t[15]||(t[15]=s=>C.value=s),"pt:root:class":"!bg-blue-100",header:"Detalles de la actividad",position:"right"},{header:S(()=>[e("div",Oe,[e("span",Ue,i(a.value.service.title),1)])]),footer:S(()=>[e("div",mt,[e("h1",vt,"Saldo: "+i(l(h).format(a.value.total_price-a.value.payment.reduce((s,n)=>s+n.amount,0))),1),e("div",ft,[j(r(m,{onClick:t[12]||(t[12]=s=>L("COMPLETADA",!0)),icon:"fa-solid fa-circle-check",text:"",size:"large",class:"flex-auto",severity:"success"},null,512),[[b,"Completar Servicio",void 0,{top:!0}]]),j(r(m,{onClick:t[13]||(t[13]=s=>L("NO SHOW",!0)),icon:"fa-solid fa-eye-slash",text:"",size:"large",class:"flex-auto",severity:"warn"},null,512),[[b,"Servicio No show",void 0,{top:!0}]]),j(r(m,{onClick:t[14]||(t[14]=s=>L("CANCELADA",!0)),icon:"fa-solid fa-xmark-circle",text:"",size:"large",class:"flex-auto",severity:"danger"},null,512),[[b,"Cancelar Servicio",void 0,{top:!0}]]),j(r(m,{icon:"fa-solid fa-person-dress-burst",text:"",size:"large",class:"flex-auto",severity:"danger"},null,512),[[b,"Servicio Problematico",void 0,{top:!0}]])])])]),default:S(()=>{var s;return[e("div",$e,[e("div",ke,[Fe,e("p",null,i(a.value.date),1)]),e("div",Re,[Le,e("p",null,i(a.value.hour),1)]),e("div",Te,[ze,e("p",null,i(a.value.cliente_name),1)]),e("div",Me,[Be,e("p",null,i(a.value.cliente_city),1)]),e("div",He,[Ie,e("a",{href:`tel://${a.value.cliente_phone}`},i(a.value.cliente_phone),9,We)]),e("div",Ge,[Qe,e("p",null,i(a.value.cliente_building),1)]),e("div",Je,[Ke,e("p",null,i(a.value.adults),1)]),e("div",Xe,[Ye,e("p",null,i(a.value.boys),1)]),e("div",Ze,[et,e("p",null,i(l(h).format(a.value.total_price)),1)]),a.value.user?(A(),P("div",tt,[st,e("p",null,i((s=a.value.user)==null?void 0:s.name),1)])):W("",!0),a.value.user?(A(),P("div",lt,[ot,e("p",null,i(new Date(a.value.created_at).toLocaleDateString("es-CO")),1)])):W("",!0),e("div",at,[e("div",rt,[it,e("div",nt,i(l(h).format(a.value.payment.reduce((n,me)=>n+me.amount,0))),1)]),(A(!0),P(he,null,_e(a.value.payment,n=>(A(),P("div",dt,[e("div",null,[e("div",ut,i(n.type)+" "+i(l(h).format(n.amount)),1),e("div",null,i(new Date(n.created_at).toLocaleDateString("es-CO"))+" "+i(n.metohd_payment.name),1)]),e("div",{class:be(["uppercase",n.status=="pendiente"?"bg-red-500 p-1 text-white rounded-lg shadow-md shadow-red-500":""])},[ge(i(n.status)+" ",1),ct],2)]))),256))])])]}),_:1},8,["visible"])]),_:1})}}};export{Ut as default};
