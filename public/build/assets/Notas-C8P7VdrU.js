import{ak as E,d as w,al as L,C as H,o as a,f as d,b as n,w as g,a as t,t as o,k as h,g as j,u as m,F as O,i as I,W as N,T as G,af as W,h as z,c as T,A as _}from"./app-C3bWUi_1.js";import{s as q}from"./index-BP37ezUo.js";import{s as J}from"./index-pAsKtILs.js";import{s as U}from"./index-BV-QR01z.js";import{S as V,a as K}from"./toasts-CuGasqAw.js";import{_ as A,a as M}from"./Modal-C1qJDXc7.js";import{_ as Q}from"./logo-BCfH2TdG.js";import{_ as X}from"./Loading-BbIwpx8J.js";const Y={class:"flex items-center gap-2"},Z={class:"font-bold text-lg"},ee={class:"flex flex-col gap-y-1.5 text-sm"},te={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},se={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},oe={key:0,class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},le={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},ie={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},ne={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},re={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},ae=["href"],de={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},ue={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},ce={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},ve={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},fe={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},me={key:1,class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},pe={key:2,class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},be={key:3,class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},xe={class:"flex flex-col border py-1 bg-white/30 rounded-md px-2"},ye={class:"text-lg flex w-full justify-between items-center mt-2"},ge={class:"rounded-full bg-green-800 text-white px-1.5 py-0.5 text-xs fles items-center justify-center"},we={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Ce={class:"flex flex-col items-center"},ke={class:"grid grid-cols-3 md:grid-cols-6 gap-2"},he={class:"flex flex-col gap-y-2"},Ve={class:"flex flex-col gap-y-1"},$e={key:0,class:"flex items-center gap-x-2"},Se={key:1},je={class:"flex items-center gap-2"},Oe={class:"flex justify-end gap-2"},Ye={__name:"viewBooking",props:E({service:Object,proveedors:Array},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const{toast:x}=K(),y=s,p=w(null),C=L(s,"modelValue"),b=w(!1),r=H({service:y.service.id,current_id:"",new_id:"",state:"",note:"",terminated:!0,value:""}),c=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}),B=()=>{V.fire({title:"Cancelar Servicio",input:"date",inputLabel:"Fecha de Cancelaci贸n",showCancelButton:!0,confirmButtonText:"Cancelar Servicio",showLoaderOnConfirm:!0,preConfirm:async i=>{await N.post(route("set.states"),{service:y.service.id,state:"CANCELADA",date:i,terminated:!0})},allowOutsideClick:()=>!V.isLoading()}).then(i=>{i.isConfirmed&&x("success","Reserva Cancelada")})},$=(i,e)=>{V.fire({title:i,text:"Estas seguro de realizar esta acci贸n?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si"}).then(v=>{v.isConfirmed&&(V.fire({title:i,text:"Esta reserva ha sido "+i+".",icon:"success"}),N.post(route("set.states"),{service:y.service.id,state:i,terminated:e},{onSuccess:()=>{x("success","Reserva "+i)}}))})},D=()=>{V.fire({title:"Cambio de Fecha",input:"date",inputLabel:"Nueva Fecha",showCancelButton:!0,confirmButtonText:"Cambiar Fecha",showLoaderOnConfirm:!0,preConfirm:async i=>{await N.post(route("set.states"),{service:y.service.id,state:"CAMBIO DE FECHA",date:i,terminated:!1})},allowOutsideClick:()=>!V.isLoading()}).then(i=>{i.isConfirmed&&x("success","Fecha Cambiada")})},S=i=>{if(i==null||i==null)return"Sin definir";var e=new Date(new Date(i).getTime()+new Date(i).getTimezoneOffset()*6e4).toLocaleString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"});return e=="30/11/2"?"INDEFINIDO":e},f=()=>{if(!p.value||!r.new_id||!r.value)return x("error","Rellene todos los Campos"),0;r.current_id=p.value.proveedor_id,r.state="REUBICADO",r.terminated=!0,r.post(route("set.states"),{onSuccess:()=>{b.value=!1,r.reset(),x("success","Servicio REUBICADO")}}),console.log(r.current_id)},u=()=>{r.reset(),b.value=!0};return(i,e)=>{const v=U,R=J,P=q,k=G;return a(),d(O,null,[n(R,{visible:C.value,"onUpdate:visible":e[6]||(e[6]=l=>C.value=l),"pt:root:class":"!bg-blue-100",header:"Detalles de la actividad",position:"right"},{header:g(()=>[t("div",Y,[t("span",Z,o(s.service.service),1)])]),footer:g(()=>[t("div",Ce,[t("div",ke,[h(n(v,{onClick:e[0]||(e[0]=l=>$("reservado",!0)),icon:"fa-solid fa-circle-check",severity:"info"},null,512),[[k,"Reservada",void 0,{top:!0}]]),h(n(v,{onClick:e[1]||(e[1]=l=>$("NO SHOW",!0)),icon:"fa-solid fa-eye-slash",class:"!text-white !bg-yellow-600"},null,512),[[k,"Servicio No show",void 0,{top:!0}]]),h(n(v,{onClick:e[2]||(e[2]=l=>D()),icon:"fa-solid fa-calendar-week",class:"!bg-gray-600 !text-white"},null,512),[[k,"Cambio de Fecha",void 0,{top:!0}]]),h(n(v,{onClick:e[3]||(e[3]=l=>u()),icon:"fa-solid fa-people-arrows",severity:"warn"},null,512),[[k,"Cambio de proveedor",void 0,{top:!0}]]),h(n(v,{onClick:e[4]||(e[4]=l=>B()),icon:"fa-solid fa-xmark-circle",severity:"danger"},null,512),[[k,"Cancelar Servicio",void 0,{top:!0}]]),h(n(v,{onClick:e[5]||(e[5]=l=>$("PROBLEMATICA",!1)),icon:"fa-solid fa-person-dress-burst",class:"flex-auto",severity:"danger"},null,512),[[k,"Servicio Problematico",void 0,{top:!0}]])])])]),default:g(()=>{var l;return[t("div",ee,[t("div",te,[e[14]||(e[14]=t("strong",null,"Fecha del Servicio:",-1)),t("p",null,o(S(s.service.date)),1)]),t("div",se,[e[15]||(e[15]=t("strong",null,"Hora del Servicio:",-1)),t("p",null,o(s.service.hour),1)]),s.service.time_service?(a(),d("div",oe,[e[16]||(e[16]=t("strong",null,"Duraci贸n del Servicio:",-1)),t("p",null,o(s.service.time_service),1)])):j("",!0),t("div",le,[e[17]||(e[17]=t("strong",null,"Canal de Venta:",-1)),t("p",null,o(s.service.channel.name),1)]),t("div",ie,[e[18]||(e[18]=t("strong",null,"Cliente:",-1)),t("p",null,o(s.service.cliente_name),1)]),t("div",ne,[e[19]||(e[19]=t("strong",null,"Ciudad:",-1)),t("p",null,o(s.service.cliente_city),1)]),t("div",re,[e[20]||(e[20]=t("strong",null,"Telelfono:",-1)),t("a",{target:"_blank",href:`https://wa.me/${s.service.cliente_phone}?text=Hola%20,%20mi%20nombre%20es%20*Sandra Gil*,%20Le%20escribo%20desde%20*AV%20COLOMBIA*`},o(s.service.cliente_phone),9,ae)]),t("div",de,[e[21]||(e[21]=t("strong",null,"Edificio:",-1)),t("p",null,o(s.service.cliente_building),1)]),t("div",ue,[e[22]||(e[22]=t("strong",null,"Adultos:",-1)),t("p",null,o(s.service.adults),1)]),t("div",ce,[e[23]||(e[23]=t("strong",null,"Ni帽os:",-1)),t("p",null,o(s.service.boys),1)]),t("div",ve,[e[24]||(e[24]=t("strong",null,"Total:",-1)),t("p",null,o(m(c).format(s.service.total)),1)]),t("div",fe,[e[25]||(e[25]=t("strong",null,"Total Real:",-1)),t("p",null,o(m(c).format(s.service.total_real)),1)]),s.service.user?(a(),d("div",me,[e[26]||(e[26]=t("strong",null,"Usuario:",-1)),t("p",null,o((l=s.service.user)==null?void 0:l.name),1)])):j("",!0),s.service.user?(a(),d("div",pe,[e[27]||(e[27]=t("strong",null,"Fecha de reserva:",-1)),t("p",null,o(new Date(s.service.created_at).toLocaleDateString("es-CO")),1)])):j("",!0),s.service.fecha_cancelacion?(a(),d("div",be,[e[28]||(e[28]=t("strong",null,"Fecha de Cancelaci贸n:",-1)),t("p",null,o(s.service.fecha_cancelacion),1)])):j("",!0),t("div",xe,[e[29]||(e[29]=t("strong",null,"Observacion:",-1)),t("p",null,o(s.service.observations),1)]),t("div",ye,[e[30]||(e[30]=t("p",{class:"font-bold"},"Proveedores",-1)),t("p",ge,o(s.service.proveedors.length),1)]),(a(!0),d(O,null,I(s.service.proveedors,F=>(a(),d("div",we,[t("p",null,o(F.proveedor),1),t("p",null,o(m(c).format(F.cost)),1)]))),256))])]}),_:1},8,["visible"]),n(M,{modelValue:b.value,"onUpdate:modelValue":e[13]||(e[13]=l=>b.value=l),title:"Cambio de proveedor","close-on-escape":""},{default:g(()=>[t("div",he,[t("span",Ve,[e[33]||(e[33]=t("label",{for:"",class:"font-bold"}," Proveedor Actual",-1)),n(P,{placeholder:"Proveedor Actual",options:s.service.proveedors,label:"Proveedor Actual",modelValue:p.value,"onUpdate:modelValue":e[7]||(e[7]=l=>p.value=l),"option-label":"proveedor"},{value:g(l=>[l.value?(a(),d("div",$e,[t("div",null,o(p.value.proveedor),1),e[31]||(e[31]=t("span",null,"-",-1)),t("div",null,o(m(c).format(p.value.cost)),1)])):(a(),d("span",Se,o(l.placeholder),1))]),option:g(({option:l})=>[t("div",je,[t("span",null,o(l.proveedor),1),e[32]||(e[32]=t("span",null,"-",-1)),t("span",null,o(m(c).format(l.cost)),1)])]),_:1},8,["options","modelValue"])]),n(A,{"option-label":"nombre","option-value":"id",type:"dropdown",label:"Nuevo Proveedor",modelValue:m(r).new_id,"onUpdate:modelValue":e[8]||(e[8]=l=>m(r).new_id=l),options:s.proveedors},null,8,["modelValue","options"]),n(A,{label:"Valor",modelValue:m(r).value,"onUpdate:modelValue":e[9]||(e[9]=l=>m(r).value=l),type:"number",mode:"currency"},null,8,["modelValue"]),n(A,{label:"Nota",modelValue:m(r).note,"onUpdate:modelValue":e[10]||(e[10]=l=>m(r).note=l),type:"textarea",mode:"currency"},null,8,["modelValue"]),t("div",Oe,[n(v,{onClick:e[11]||(e[11]=l=>b.value=!1),label:"Cancelar",severity:"danger",icon:"fa-solid fa-xmark"}),n(v,{onClick:e[12]||(e[12]=l=>f()),label:"Guardar",severity:"success",icon:"fa-solid fa-save"})])])]),_:1},8,["modelValue"])],64)}}},Ae={class:"w-full flex flex-col gap-y-5 p-2"},Be={class:"h-[30vh] overflow-y-auto flex flex-col gap-y-2"},De={key:0,class:"flex w-full"},Ne={class:"w-1/2 flex py-1 px-3 rounded-md items-center justify-between bg-sky-100"},_e={class:"flex flex-col"},Fe={class:"text-lg font-bold first-letter:uppercase"},Te={class:"italic text-xs"},Ee={key:1,class:"flex w-full"},Le={class:"w-1/2 flex py-1 px-3 rounded-md items-center border justify-between bg-gray-300"},Ie={class:"flex flex-col"},Ue={class:"text-lg font-bold first-letter:uppercase"},Me={class:"italic text-xs"},Re={key:0,class:"flex justify-center items-center"},Pe={key:0,class:"flex justify-center flex-col items-center"},He={class:"flex gap-x-2 px-2"},Ze={__name:"Notas",props:E({todayActivity:Boolean,notes:Array,note:String,service:Array},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const x=L(s,"modelValue"),y=s,p=w(y.notes),C=w(!1),b=w(null),r=w(!1),c=w(""),B=()=>{_.post(route("notes.store"),{note:c.value,booking_service_id:y.service.id}).then(f=>{c.value="",S()})},$=f=>{c.value=f.note,C.value=!0,b.value=f},D=()=>{_.put(route("notes.update",b.value.id),{note:c.value}).then(f=>{S(),c.value="",C.value=!1,b.value=null})},S=()=>{r.value=!0,_.get(route("notes.index",{booking_service_id:y.service.id})).then(f=>{p.value=f.data.notes,r.value=!1})};return W(()=>{S()}),(f,u)=>{const i=U;return a(),d(O,null,[u[6]||(u[6]=z(" asndlands ")),n(M,{modelValue:x.value,"onUpdate:modelValue":u[1]||(u[1]=e=>x.value=e),"close-on-escape":"",title:"Notas",width:"60vw"},{default:g(()=>[t("div",Ae,[u[5]||(u[5]=t("h3",{class:"text-xl font-bold"},"Notas de la Actividad",-1)),t("div",Be,[(a(!0),d(O,null,I(p.value,e=>(a(),d("div",{class:"flex p-2 rounded-md items-center justify-between w-full",key:e.id},[e.user_id==f.$page.props.auth.user.id?(a(),d("div",De,[u[2]||(u[2]=t("div",{class:"w-1/2"},null,-1)),t("div",Ne,[t("span",_e,[t("p",Fe,o(e.note),1),t("p",Te,o(new Date(e.created_at).toISOString().split("T")[0]),1)]),t("div",null,[n(i,{icon:"fa-solid fa-pencil",text:"",severity:"info",onClick:v=>$(e)},null,8,["onClick"]),n(i,{icon:"fa-solid fa-trash",text:"",severity:"danger",onClick:v=>f.eliminar(e)},null,8,["onClick"])])])])):(a(),d("div",Ee,[t("div",Le,[t("span",Ie,[t("p",Ue,o(e.note),1),t("p",Me,o(e.user.name)+" - "+o(new Date(e.created_at).toISOString().split("T")[0]),1)])]),u[3]||(u[3]=t("div",{class:"w-1/2"},null,-1))]))]))),128)),r.value?(a(),d("div",Re,[n(X)])):(a(),d(O,{key:1},[p.value.length==0?(a(),d("div",Pe,[n(Q),u[4]||(u[4]=t("p",{class:"font-semibold text-xl"},"Serivicio sin notas",-1))])):j("",!0)],64))]),t("div",He,[n(A,{type:"textarea",class:"w-full",rowsTextarea:2,modelValue:c.value,"onUpdate:modelValue":u[0]||(u[0]=e=>c.value=e)},null,8,["modelValue"]),C.value?(a(),T(i,{key:1,label:"Editar",severity:"info",icon:"pi pi-send",class:"!h-12",onClick:D})):(a(),T(i,{key:0,label:"Guardar",severity:"success",class:"!h-12",icon:"pi pi-send",onClick:B}))])])]),_:1},8,["modelValue"])],64)}}};export{Ze as _,Ye as a};
