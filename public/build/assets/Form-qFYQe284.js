import{s as I}from"./index-CkxCeojy.js";import{d as r,x as T,q as k,f as y,o as v,a as s,g as b,b as d,c as P,u as c,A as B,y as _}from"./app-DvS-x4yA.js";import{a as F}from"./toasts-Bf1FAz7R.js";import{_ as f}from"./Input-3EZayuC9.js";import R from"./DetailsTypeReserva-6z8Cg4Dd.js";import{a as U}from"./useCommonUtilities-EmANIG9p.js";import"./index-D5EHCXqx.js";import"./index-B7oTyUuF.js";import"./index-vmS0vH3c.js";import"./index-CT1dAqzq.js";import"./index-Bl132nJv.js";import"./index-DKLyAeP_.js";import"./index-DdfLK9sH.js";import"./index-fRPTXPYw.js";import"./index-Bo0JYF98.js";import"./index-XWtOfBli.js";import"./index-DNKVZa3z.js";import"./sweetalert2.esm.all-DV3w3JmD.js";import"./index-asXF38sJ.js";import"./index-jKPLdZC-.js";import"./index-C4bGEdR2.js";import"./index-CDhetmFm.js";import"./index-C5tOrwJZ.js";import"./index-BZIQWmMB.js";import"./filepond-plugin-image-preview.min-BRBlECre.js";import"./index-BZCJjOLm.js";import"./postcss-Xp2RZDmu.js";import"./index-Bo4NByPG.js";import"./ItemDetailTypeReserva-Cdmxzh6_.js";const N={class:"gap-y-2 flex flex-col"},M={class:"flex flex-col md:flex-row gap-x-2 items-center"},j={class:"flex flex-col w-full justify-between font-bold"},H={key:0,class:"flex flex-col gap-y-2"},L={class:"flex flex-col w-full justify-between font-bold"},z={class:"grid grid-cols-1 md:grid-cols-3 gap-x-4"},$={class:"flex justify-end gap-x-2"},q=["loading"],we={__name:"Form",props:{payments:Array},setup(W){const g=r(!1),{toast:D}=F(),i=r(!1),a=T({date:new Date,startDate:new Date,endDate:new Date,amount:0,proveedor_id:"",file:"",description:""}),V=r([]),u=r([new Date,new Date]),n=r(),w=r([]),l=r(),x=r(null),p=r(0),A=()=>{B.get(route("get.booking.time.range"),{params:{start_date:new Date(u.value[0]).toISOString().split("T")[0],end_date:new Date(u.value[1]).toISOString().split("T")[0]}}).then(o=>{V.value=o.data.proveedores,n.value=o.data.bookingTimeRange.filter(e=>{let m=l.value;return e.proveedors.map(E=>E.proveedor_id).includes(m)}),p.value=U(n.value,l.value),w.value=[{name:"RESERVADO",value:n.value.filter(e=>e.status=="RESERVADO"),color:"bg-blue-200"},{name:"COMPLETADA",value:n.value.filter(e=>e.status=="COMPLETADA"),color:"bg-green-200"},{name:"CANCELADA",value:n.value.filter(e=>e.status=="CANCELADA"),color:"bg-red-200"},{name:"NO SHOW",value:n.value.filter(e=>e.status=="NO SHOW"),color:"bg-yellow-200"},{name:"CAMBIO DE FECHA",value:n.value.filter(e=>e.status=="CAMBIO DE FECHA"),color:"bg-gray-200"},{name:"REUBICADO",value:n.value.filter(e=>e.status=="REUBICADO"),color:"bg-yellow-200"}]})};function O(o){a.file=o.target.files[0]}const S=()=>{i.value=!0;let o=new FormData;if(o.append("proveedor_id",l.value),o.append("amount",a.amount),o.append("comprobante",a.file),o.append("date",new Date(a.date).toISOString().split("T")[0]),o.append("startDate",new Date(u.value[0]).toISOString().split("T")[0]),o.append("endDate",new Date(u.value[1]).toISOString().split("T")[0]),o.append("description",a.description),x.value){_.post(route("paymentProveedors.update",x.value),o,{onSuccess:()=>{D("success","Pago Actualizado con exito"),i.value=!1,g.value=!1}});return}_.post(route("paymentProveedors.store"),o,{onSuccess:()=>{D("success","Pago Actualizado con exito"),i.value=!1,g.value=!1}})},C=k(()=>p.value-a.amount);return(o,e)=>{const m=I;return v(),y("div",N,[s("div",M,[s("div",j,[e[7]||(e[7]=s("p",null,"Fechas",-1)),d(m,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=t=>u.value=t),selectionMode:"range",dateFormat:"dd/mm/yy",class:"w-full h-9",manualInput:!1,onValueChange:A},null,8,["modelValue"])]),d(f,{label:"Proveedor",type:"dropdown","option-label":"proveedor","option-value":"proveedor_id",onValueChange:A,class:"w-full",modelValue:l.value,"onUpdate:modelValue":e[1]||(e[1]=t=>l.value=t),options:V.value},null,8,["modelValue","options"])]),l.value?(v(),y("div",H,[l.value?(v(),P(R,{key:0,reservasType:w.value,proveedor:l.value},null,8,["reservasType","proveedor"])):b("",!0),s("div",L,[e[8]||(e[8]=s("p",null,"Fecha en que realizÃ³ el pago",-1)),d(m,{modelValue:c(a).date,"onUpdate:modelValue":e[2]||(e[2]=t=>c(a).date=t),dateFormat:"dd/mm/yy",class:"w-full",manualInput:!1},null,8,["modelValue"])]),s("div",z,[d(f,{label:"Valor Pagado",type:"number",mode:"currency",modelValue:c(a).amount,"onUpdate:modelValue":e[3]||(e[3]=t=>c(a).amount=t)},null,8,["modelValue"]),d(f,{label:"Valor Total",type:"number",mode:"currency",modelValue:p.value,"onUpdate:modelValue":e[4]||(e[4]=t=>p.value=t),disabled:""},null,8,["modelValue"]),d(f,{label:"Diferencia",type:"number",mode:"currency",modelValue:C.value,"onUpdate:modelValue":e[5]||(e[5]=t=>C.value=t),disabled:""},null,8,["modelValue"])]),s("input",{type:"file",onChange:O,label:"Comprobante"},null,32)])):b("",!0),s("div",$,[s("button",{onClick:e[6]||(e[6]=t=>g.value=!1),class:"bg-red-500 text-white px-4 py-2 rounded-md"}," Cancelar "),l.value?(v(),y("button",{key:0,loading:i.value,onClick:S,class:"bg-green-500 text-white px-4 py-2 rounded-md"}," Guardar ",8,q)):b("",!0)])])}}};export{we as default};
