import{s as U}from"./index-DJae3Fo8.js";import{d as c,u as M,a0 as _,A as f,p as k,f as w,o as v,a as d,b as s,c as S,g as V,h as e,t as y,k as O}from"./app-DgFm554V.js";import{_ as n}from"./Input-ulbx02Oo.js";import{a as m,g as A}from"./Toats-CRqRGqmn.js";import{u as E}from"./useCommonUtilities-BgDhORlD.js";import{u as C}from"./Auth-BqEUqBsU.js";import{S as B}from"./Service-D6jA31AR.js";const{hasRole:F}=C(),{currencyFormat:x}=E();class P{loading=c(!1);statuesOptions=[{text:"RESERVADO",color:"blue"},{text:"COMPLETADA",color:"teal"},{text:"CAMBIO DE FECHA",color:"gray"},{text:"NO SHOW",color:"amber"},{text:"REUBICADO",color:"orange"},{text:"CANCELADA",color:"green"},{text:"SIN CONFIRMAR",color:"purple"},{text:"PROBLEMATICA",color:"red"}];channels=c([]);bookingService=c();form=M({id:"",service_id:"",date:"",adults:1,time_service:"",boys:0,cliente_name:"",cliente_phone:"",cliente_city:"",cliente_building:"",reserva:0,method_id:"",channel_id:F("vendedor")?"9d75e9d5-6e8f-48c1-9f56-276fd185297e":"9d99a95f-6c3d-48fd-aa7d-6ef4e6860123",saldo:0,total:0,total_real:0,percent_channel:0,observations:"",code_booking:""});formatDateTime(t,i){const[u,p,b]=t.split("-"),[g,r]=i.split(":");return`${u}-${p}-${b},${g}:${r}`}constructor(t){this.bookingService=t,t&&(Object.keys(this.form).forEach(i=>{t[i]!==void 0&&(this.form[i]=t[i])}),this.form.date=this.formatDateTime(t.date,t.hour))}async create(){if(!this.form.service_id)return m("Selecciona un Servicio");if(!this.form.date)return m("Selecciona una fecha");if(!this.form.channel_id)return m("Selecciona un canal");if(!this.form.cliente_name)return m("Ingresa el nombre del cliente");if(!this.form.cliente_phone)return m("Ingresa el telefono del cliente");if(!this.form.cliente_city)return m("Ingresa la ciudad del cliente");if(!this.form.cliente_building)return m("Ingresa el edificio del cliente");this.form.total_real=this.valorReal.value,this.form.percent_channel=this.channels.value.find(t=>t.id==this.form.channel_id).percent,this.loading.value=!0,this.form.post(route("BookingServices.store")),this.loading.value=!1}async update(){this.form.total_real=this.valorReal.value,this.form.percent_channel=this.channels.value.find(t=>t.id==this.form.channel_id).percent,this.loading.value=!0,this.form.put(route("BookingServices.update",this.bookingService.id)),A("Reserva actualizada Exitosamente"),this.loading.value=!1}async getChannels(){const{data:t}=await _.get(route("channels.index"));return this.channels.value=t,t}async getMethods(){const{data:t}=await _.get(route("paymentMethods.index"));return t}getColorStatus(){return this.statuesOptions.find(t=>t.text==this.bookingService.status.toUpperCase()).color}valorReal=f(()=>{let t=this.channels.value.find(u=>u.id==this.form.channel_id),i=t?t.percent/100:0;return this.form.total-this.form.total*i});valorRealFormat=f(()=>x(this.valorReal.value));valuePasajeros=f(()=>x(this.form.total/this.form.adults));valueCanalVenta=f(()=>{let t=this.channels.value.find(u=>u.id==this.form.channel_id),i=t?t.percent/100:0;return x(this.form.total*i)});submit(){return this.bookingService?this.update():this.create()}}const j={class:""},I={key:2,class:"flex justify-between w-full gap-x-4 col-span-2"},N={class:"p-2 border rounded-md shadow-md w-full text-center"},T={class:"text-xl font-bold"},D={class:"p-2 border rounded-md shadow-md w-full text-center"},H={class:"text-xl font-bold"},$={class:"p-2 border rounded-md shadow-md w-full text-center"},z={class:"text-xl font-bold"},L={__name:"FormFirst",props:{bookingService:Object},setup(h){const{hasRole:t}=C(),i=c([]),u=c([]),p=c([]),b=h,g=new B,r=new P(b.bookingService),o=r.form;return k(async()=>{i.value=await g.getServices(),u.value=await r.getChannels(),p.value=await r.getMethods(),console.log(u.value)}),(q,l)=>{const R=U;return v(),w("div",j,[d("form",{class:"grid grid-cols-1 md:grid-cols-2 gap-2 items-center",onSubmit:l[14]||(l[14]=O((...a)=>e(r).submit&&e(r).submit(...a),["prevent"]))},[s(n,{modelValue:e(o).service_id,"onUpdate:modelValue":l[0]||(l[0]=a=>e(o).service_id=a),class:"col-span-2",type:"dropdown",label:"Servicio","option-label":"title","option-value":"id",options:i.value},null,8,["modelValue","options"]),s(n,{label:"Fecha de Reserva",modelValue:e(o).date,"onUpdate:modelValue":l[1]||(l[1]=a=>e(o).date=a),enableTimePicker:!0,class:"w-full",type:"datetime"},null,8,["modelValue"]),s(n,{label:"Valor Total",type:"number",mode:"currency",required:!0,modelValue:e(o).total,"onUpdate:modelValue":l[2]||(l[2]=a=>e(o).total=a)},null,8,["modelValue"]),s(n,{label:"Tiempo del Servicio",type:"dropdown",modelValue:e(o).time_service,"onUpdate:modelValue":l[3]||(l[3]=a=>e(o).time_service=a),options:["20 Minutos","30 Minutos","40 Minutos","1 Hora","2 Horas","6 Horas","12 Horas","24 Horas"]},null,8,["modelValue"]),s(n,{label:"Pasajeros",type:"number",modelValue:e(o).adults,"onUpdate:modelValue":l[4]||(l[4]=a=>e(o).adults=a)},null,8,["modelValue"]),s(n,{label:"NiÃ±os",type:"number",modelValue:e(o).boys,"onUpdate:modelValue":l[5]||(l[5]=a=>e(o).boys=a)},null,8,["modelValue"]),s(n,{label:"Nombre del Pasajero",required:!0,modelValue:e(o).cliente_name,"onUpdate:modelValue":l[6]||(l[6]=a=>e(o).cliente_name=a),class:"w-full"},null,8,["modelValue"]),s(n,{label:"Telefono",class:"w-full",type:"number",modelValue:e(o).cliente_phone,"onUpdate:modelValue":l[7]||(l[7]=a=>e(o).cliente_phone=a)},null,8,["modelValue"]),s(n,{label:"Ciudad de donde Proviene",class:"w-full",modelValue:e(o).cliente_city,"onUpdate:modelValue":l[8]||(l[8]=a=>e(o).cliente_city=a)},null,8,["modelValue"]),s(n,{label:"Edificio u Hotel",class:"w-full",modelValue:e(o).cliente_building,"onUpdate:modelValue":l[9]||(l[9]=a=>e(o).cliente_building=a)},null,8,["modelValue"]),e(t)("vendedor")?V("",!0):(v(),S(n,{key:0,class:"w-full",type:"dropdown","option-label":"name","option-value":"id",options:p.value,modelValue:e(o).method_id,"onUpdate:modelValue":l[10]||(l[10]=a=>e(o).method_id=a),label:"Medio de Pago"},null,8,["options","modelValue"])),e(t)("vendedor")?V("",!0):(v(),S(n,{key:1,class:"w-full",type:"dropdown","option-label":"name","option-value":"id",options:u.value,modelValue:e(o).channel_id,"onUpdate:modelValue":l[11]||(l[11]=a=>e(o).channel_id=a),label:"Canal de Venta"},null,8,["options","modelValue"])),s(n,{class:"w-full",label:"Saldo a pagar en Sitio",type:"number",mode:"currency",modelValue:e(o).saldo,"onUpdate:modelValue":l[12]||(l[12]=a=>e(o).saldo=a),step:1e3,min:0,max:e(o).total},null,8,["modelValue","max"]),s(n,{class:"w-full col-span-1 md:col-span-2","rows-textarea":2,label:"Observaciones",modelValue:e(o).observations,"onUpdate:modelValue":l[13]||(l[13]=a=>e(o).observations=a),type:"textarea"},null,8,["modelValue"]),e(t)("vendedor")?V("",!0):(v(),w("div",I,[d("div",N,[l[15]||(l[15]=d("p",{class:"text-md font-extralight"},"Valor Pasajero",-1)),d("h1",T,y(e(r).valuePasajeros),1)]),d("div",D,[l[16]||(l[16]=d("p",{class:"text-md font-extralight"},"Comisiones Canal de venta",-1)),d("h1",H,y(e(r).valueCanalVenta),1)]),d("div",$,[l[17]||(l[17]=d("p",{class:"text-md font-extralight"},"Valor total Real",-1)),d("h1",z,y(e(r).valorRealFormat),1)])])),s(R,{class:"col-span-2",type:"submit",severity:"success",label:h.bookingService?"Actualizar Reserva":"Crear Reserva",loading:e(r).loading.value},null,8,["label","loading"])],32)])}}},Z=Object.freeze(Object.defineProperty({__proto__:null,default:L},Symbol.toStringTag,{value:"Module"}));export{P as B,Z as F,L as _};
