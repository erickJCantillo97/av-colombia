import{s as V}from"./index-B58lX-_G.js";import{s as B}from"./index-CbVYCAvC.js";import{s as x}from"./index-Bi-nM_5u.js";import{s as D}from"./index-BUIOyHLV.js";import{d as n,x as C,A as U,B as I,f as d,o as m,b as i,w as l,a as s,u as r,t as u,h as M,k as $}from"./app-DVDc2VVL.js";import{S as P}from"./Service-DUaW4sx-.js";import{g as j}from"./Toats-B8gGEYe4.js";import"./index-C-b9iog_.js";import"./index-Bj3SUI-e.js";import"./index-BzId_K-8.js";import"./index-S36_00bQ.js";import"./index-Cj8O1rHK.js";import"./index-B-0FB-YV.js";import"./index-eBtkqy6P.js";import"./index-C0eybmJC.js";import"./index-BLMMSzX1.js";import"./searchStore-Di2rJ9Ig.js";import"./sweetalert2.all-DPKCRGvl.js";class N{proveedors=n([]);loading=n(!1);bookingService=n();proveedorSelected=n();proveedorsByBookingService=n([]);constructor(a){this.bookingService.value=a,this.getProveedorByBookingService()}form=C({p:null,booking_service_id:null,proveedor_id:null,cost:0,concept:"",discount:0,percent_discount:0});async getProveedorByBookingService(){const{data:a}=await U.get(route("get.proveedor.by.booking.service",this.bookingService.value.id));this.proveedorsByBookingService.value=a.proveedors}calculateCost(){this.form.cost=this.form.p.pivot.value*this.bookingService.value.adults}async submit(){this.form.proveedor_id=this.form.p.id,this.form.booking_service_id=this.bookingService.value.id,this.form.concept=this.form.p.pivot.concept,this.form.p=null,this.form.post(route("BookingServiceProveedors.store"),{onSuccess:()=>{j("Proveedor agregado"),this.form.reset()}})}}const h={key:0},A={key:1},E={class:"flex gap-x-2"},ro={__name:"Form",props:{bookingService:Object},setup(f){const a=n(!0),b=n(!0),S=new P,v=f,g=n([]),t=new N(v.bookingService);I(async()=>{g.value=await S.getProveedorsByService(v.bookingService?.service_id)});function k(){t.form.cost!==0&&(t.form.percent_discount=t.form.discount/t.form.cost*100,a.value=!0)}function y(){t.form.cost!==0&&(t.form.discount=t.form.percent_discount*t.form.cost/100,b.value=!0)}return(F,o)=>{const w=D,p=x,c=B,_=V;return m(),d("form",{class:"w-full flex justify-between gap-x-4",onSubmit:o[7]||(o[7]=$((...e)=>r(t).submit&&r(t).submit(...e),["prevent"]))},[i(p,{class:"w-full"},{default:l(()=>[i(w,{options:g.value,inputId:"proveedor",onChange:o[0]||(o[0]=e=>r(t).calculateCost()),modelValue:r(t).form.p,"onUpdate:modelValue":o[1]||(o[1]=e=>r(t).form.p=e),variant:"filled",placeholder:"Selecciona un proveedor",class:"w-full","option-label":"nombre"},{value:l(e=>[e.value?(m(),d("span",h,u(e.value.nombre)+" - "+u(e.value.pivot.concept),1)):(m(),d("span",A,u(e.placeholder),1))]),option:l(e=>[s("div",E,[s("span",null,u(e.option.nombre)+" - ",1),s("span",null,u(e.option.pivot.concept)+" - ",1),s("span",null,u(e.option.pivot.value),1)])]),_:1},8,["options","modelValue"]),o[8]||(o[8]=s("label",{for:"proveedor"},"Proveedor - Concepto",-1))]),_:1}),i(p,{class:"w-full"},{default:l(()=>[i(c,{modelValue:r(t).form.cost,"onUpdate:modelValue":o[2]||(o[2]=e=>r(t).form.cost=e),inputId:"price_input",mode:"currency",currency:"USD",locale:"en-US",variant:"filled",class:"w-full"},null,8,["modelValue"]),o[9]||(o[9]=s("label",{for:"price_input"},"Costo",-1))]),_:1}),i(p,{class:"w-full"},{default:l(()=>[i(c,{modelValue:r(t).form.discount,"onUpdate:modelValue":o[3]||(o[3]=e=>r(t).form.discount=e),onValueChange:o[4]||(o[4]=e=>k()),inputId:"price_input",mode:"currency",currency:"USD",locale:"en-US",variant:"filled",class:"w-full"},null,8,["modelValue"]),o[10]||(o[10]=s("label",{for:"price_input"}," Descuento por pasajero ",-1))]),_:1}),i(p,{class:"w-full"},{default:l(()=>[i(c,{modelValue:r(t).form.percent_discount,"onUpdate:modelValue":o[5]||(o[5]=e=>r(t).form.percent_discount=e),onValueChange:o[6]||(o[6]=e=>y()),inputId:"discount_input",variant:"filled",class:"w-full",suffix:" %"},null,8,["modelValue"]),o[11]||(o[11]=s("label",{for:"discount_input"}," % Descuento por pasajero ",-1))]),_:1}),i(_,{type:"submit",severity:"success",class:"w-full"},{default:l(()=>o[12]||(o[12]=[s("i",{class:"fa-solid fa-plus"},null,-1),M(" Agregar ")])),_:1})],32)}}};export{ro as default};
