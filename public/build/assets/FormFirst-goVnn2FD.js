import{s as x}from"./index-DWsjGtP1.js";import{d as c,x as y,A as V,q as p,B as w,f as S,o as C,a as d,b as n,u as l,t as b,k as R}from"./app-DQXnwASi.js";import{_ as s}from"./Input-BNc608iU.js";import{a as m,g as U}from"./Toats-wr65v35B.js";import{u as M}from"./useCommonUtilities-BgDhORlD.js";import{S as O}from"./Service-DHXTdsRx.js";const{currencyFormat:g}=M();class A{loading=c(!1);statuesOptions=[{text:"RESERVADO",color:"blue"},{text:"COMPLETADA",color:"teal"},{text:"CAMBIO DE FECHA",color:"gray"},{text:"NO SHOW",color:"amber"},{text:"REUBICADO",color:"orange"},{text:"CANCELADA",color:"green"},{text:"SIN CONFIRMAR",color:"purple"},{text:"PROBLEMATICA",color:"red"}];channels=c([]);bookingService=c();form=y({id:"",service_id:"",date:"",adults:1,time_service:"",boys:0,cliente_name:"",cliente_phone:"",cliente_city:"",cliente_building:"",reserva:0,method_id:"",channel_id:"9d99a95f-6c3d-48fd-aa7d-6ef4e6860123",saldo:0,total:0,total_real:0,percent_channel:0,observations:"",code_booking:""});formatDateTime(a,i){const[u,h,v]=a.split("-"),[r,t]=i.split(":");return`${u}-${h}-${v},${r}:${t}`}constructor(a){this.bookingService=a,a&&(Object.keys(this.form).forEach(i=>{a[i]!==void 0&&(this.form[i]=a[i])}),this.form.date=this.formatDateTime(a.date,a.hour))}async create(){if(!this.form.service_id)return m("Selecciona un Servicio");if(!this.form.date)return m("Selecciona una fecha");if(!this.form.method_id)return m("Selecciona un metodo de pago");if(!this.form.channel_id)return m("Selecciona un canal");if(!this.form.cliente_name)return m("Ingresa el nombre del cliente");if(!this.form.cliente_phone)return m("Ingresa el telefono del cliente");if(!this.form.cliente_city)return m("Ingresa la ciudad del cliente");if(!this.form.cliente_building)return m("Ingresa el edificio del cliente");this.form.total_real=this.valorReal.value,this.form.percent_channel=this.channels.value.find(a=>a.id==this.form.channel_id).percent,this.loading.value=!0,this.form.post(route("BookingServices.store")),this.loading.value=!1}async update(){this.form.total_real=this.valorReal.value,this.form.percent_channel=this.channels.value.find(a=>a.id==this.form.channel_id).percent,this.loading.value=!0,this.form.put(route("BookingServices.update",this.bookingService.id)),U("Reserva actualizada Exitosamente"),this.loading.value=!1}async getChannels(){const{data:a}=await V.get(route("channels.index"));return this.channels.value=a,a}async getMethods(){const{data:a}=await V.get(route("paymentMethods.index"));return a}getColorStatus(){return this.statuesOptions.find(a=>a.text==this.bookingService.status.toUpperCase()).color}valorReal=p(()=>{let a=this.channels.value.find(u=>u.id==this.form.channel_id),i=a?a.percent/100:0;return this.form.total-this.form.total*i});valorRealFormat=p(()=>g(this.valorReal.value));valuePasajeros=p(()=>g(this.form.total/this.form.adults));valueCanalVenta=p(()=>{let a=this.channels.value.find(u=>u.id==this.form.channel_id),i=a?a.percent/100:0;return g(this.form.total*i)});submit(){return this.bookingService?this.update():this.create()}}const E={class:""},B={class:"flex justify-between w-full gap-x-4 col-span-2"},k={class:"p-2 border rounded-md shadow-md w-full text-center"},F={class:"text-xl font-bold"},P={class:"p-2 border rounded-md shadow-md w-full text-center"},j={class:"text-xl font-bold"},I={class:"p-2 border rounded-md shadow-md w-full text-center"},T={class:"text-xl font-bold"},D={__name:"FormFirst",props:{bookingService:Object},setup(f){const a=c([]),i=c([]),u=c([]),h=f,v=new O,r=new A(h.bookingService),t=r.form;return w(async()=>{a.value=await v.getServices(),i.value=await r.getChannels(),u.value=await r.getMethods()}),(H,e)=>{const _=x;return C(),S("div",E,[d("form",{class:"grid grid-cols-1 md:grid-cols-2 gap-2 items-center",onSubmit:e[14]||(e[14]=R((...o)=>l(r).submit&&l(r).submit(...o),["prevent"]))},[n(s,{modelValue:l(t).service_id,"onUpdate:modelValue":e[0]||(e[0]=o=>l(t).service_id=o),class:"col-span-2",type:"dropdown",label:"Servicio","option-label":"title","option-value":"id",options:a.value},null,8,["modelValue","options"]),n(s,{label:"Fecha de Reserva",modelValue:l(t).date,"onUpdate:modelValue":e[1]||(e[1]=o=>l(t).date=o),enableTimePicker:!0,class:"w-full",type:"datetime"},null,8,["modelValue"]),n(s,{label:"Valor Total",type:"number",mode:"currency",required:!0,modelValue:l(t).total,"onUpdate:modelValue":e[2]||(e[2]=o=>l(t).total=o)},null,8,["modelValue"]),n(s,{label:"Tiempo del Servicio",type:"dropdown",modelValue:l(t).time_service,"onUpdate:modelValue":e[3]||(e[3]=o=>l(t).time_service=o),options:["20 Minutos","30 Minutos","40 Minutos","1 Hora","2 Horas","6 Horas","12 Horas","24 Horas"]},null,8,["modelValue"]),n(s,{label:"Pasajeros",type:"number",modelValue:l(t).adults,"onUpdate:modelValue":e[4]||(e[4]=o=>l(t).adults=o)},null,8,["modelValue"]),n(s,{label:"NiÃ±os",type:"number",modelValue:l(t).boys,"onUpdate:modelValue":e[5]||(e[5]=o=>l(t).boys=o)},null,8,["modelValue"]),n(s,{label:"Nombre del Pasajero",required:!0,modelValue:l(t).cliente_name,"onUpdate:modelValue":e[6]||(e[6]=o=>l(t).cliente_name=o),class:"w-full"},null,8,["modelValue"]),n(s,{label:"Telefono",class:"w-full",type:"number",modelValue:l(t).cliente_phone,"onUpdate:modelValue":e[7]||(e[7]=o=>l(t).cliente_phone=o)},null,8,["modelValue"]),n(s,{label:"Ciudad de donde Proviene",class:"w-full",modelValue:l(t).cliente_city,"onUpdate:modelValue":e[8]||(e[8]=o=>l(t).cliente_city=o)},null,8,["modelValue"]),n(s,{label:"Edificio u Hotel",class:"w-full",modelValue:l(t).cliente_building,"onUpdate:modelValue":e[9]||(e[9]=o=>l(t).cliente_building=o)},null,8,["modelValue"]),n(s,{class:"w-full",type:"dropdown","option-label":"name","option-value":"id",options:u.value,modelValue:l(t).method_id,"onUpdate:modelValue":e[10]||(e[10]=o=>l(t).method_id=o),label:"Medio de Pago"},null,8,["options","modelValue"]),n(s,{class:"w-full",type:"dropdown","option-label":"name","option-value":"id",options:i.value,modelValue:l(t).channel_id,"onUpdate:modelValue":e[11]||(e[11]=o=>l(t).channel_id=o),label:"Canal de Venta"},null,8,["options","modelValue"]),n(s,{class:"w-full",label:"Saldo",type:"number",mode:"currency",modelValue:l(t).saldo,"onUpdate:modelValue":e[12]||(e[12]=o=>l(t).saldo=o)},null,8,["modelValue"]),n(s,{class:"w-full col-span-1 md:col-span-2","rows-textarea":2,label:"Observaciones",modelValue:l(t).observations,"onUpdate:modelValue":e[13]||(e[13]=o=>l(t).observations=o),type:"textarea"},null,8,["modelValue"]),d("div",B,[d("div",k,[e[15]||(e[15]=d("p",{class:"text-md font-extralight"},"Valor Pasajero",-1)),d("h1",F,b(l(r).valuePasajeros),1)]),d("div",P,[e[16]||(e[16]=d("p",{class:"text-md font-extralight"},"Comisiones Canal de venta",-1)),d("h1",j,b(l(r).valueCanalVenta),1)]),d("div",I,[e[17]||(e[17]=d("p",{class:"text-md font-extralight"},"Valor total Real",-1)),d("h1",T,b(l(r).valorRealFormat),1)])]),n(_,{class:"col-span-2",type:"submit",severity:"success",label:f.bookingService?"Actualizar Reserva":"Crear Reserva",loading:l(r).loading.value},null,8,["label","loading"])],32)])}}},G=Object.freeze(Object.defineProperty({__proto__:null,default:D},Symbol.toStringTag,{value:"Module"}));export{A as B,G as F,D as _};
