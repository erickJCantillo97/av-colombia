import{al as I,am as M,C as W,d as k,af as G,o as i,c as U,w as C,a as e,k as h,u as p,v as H,f as v,F as N,i as T,t as l,b as r,h as P,g as O,W as q,T as Q,A as F}from"./app-C2-9oWH2.js";import{s as X}from"./index-DjhWULyq.js";import{s as Y}from"./index-BzY0QnGA.js";import{s as R}from"./index-Ba-aQxTJ.js";import{S as E,a as Z}from"./toasts-CuGasqAw.js";import{a as L,_ as B}from"./Modal-mwJNMcHU.js";import{_ as ee}from"./logo-CIcCdeNl.js";import{_ as te}from"./Loading-FcfSmMgN.js";const oe={class:"p-2"},se={class:"mb-4 flex flex-col"},le={class:"grid grid-cols-5 border-y items-center border text-right gap-x-4"},ne={class:"col-span-1"},ae={class:"col-span-1 text-nowrap truncate"},ie={class:"col-span-1"},re={class:"col-span-1"},de=["onUpdate:modelValue"],ue={class:"flex justify-end p-6 space-x-4"},ce={__name:"ServiceCancel",props:I({service:Object},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const V=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}),m=M(s,"modelValue"),c=s,f=W({date:"",proveedors:[]}),x=k([]);G(()=>{x.value=c.service.proveedors.map(d=>{var o=d.proveedor;return{proveedor_id:d.id,concept:o.concept,proveedor:d,pasajeros:c.service.adults,cost:d.cost,proveedor_name:o.proveedor.nombre,costo_penalidad:o.proveedor.type_penalidad_cost=="Porcentaje"?o.proveedor.penalidad_cancelacion/100*d.cost:o.proveedor.penalidad_cancelacion*c.service.adults}})});const $=()=>{f.proveedors=x.value,f.post(route("cancelar.servicio",c.service.id),{onSuccess:()=>{m.value=!1,console.log("Cancelado")}})};return(d,o)=>{const n=R;return i(),U(L,{title:`Cancelar Servicio ${s.service.service}`,modelValue:m.value,"onUpdate:modelValue":o[2]||(o[2]=b=>m.value=b),width:"70vw",onClose:o[3]||(o[3]=b=>m.value=!1),"close-on-escape":""},{default:C(()=>[e("div",oe,[e("div",se,[o[4]||(o[4]=e("label",{for:"",class:"font-bold"},"Fecha de Cancelaci贸n",-1)),h(e("input",{label:"Fecha de Cancelaci贸n",type:"date",class:"rounded-lg shadow-sm border-gray-300 p-2","onUpdate:modelValue":o[0]||(o[0]=b=>p(f).date=b)},null,512),[[H,p(f).date]])]),o[5]||(o[5]=e("div",{class:"grid grid-cols-5 font-bold uppercase bg-gray-300 p-2 text-center"},[e("div",{class:"col-span-1"},"Proveedor"),e("div",{class:"col-span-1"},"Concepto"),e("div",{class:"col-span-1"},"Pasajeros"),e("div",{class:"col-span-1"},"Costo"),e("div",{class:"col-span-1"},"Penalidad Total")],-1)),(i(!0),v(N,null,T(x.value,b=>(i(),v("div",le,[e("div",ne,l(b.proveedor_name),1),e("div",ae,l(b.concept),1),e("div",ie,l(b.pasajeros),1),e("div",re,l(p(V).format(b.cost)),1),h(e("input",{class:"col-span-1 rounded-md border border-gray-300 p-2","onUpdate:modelValue":u=>b.costo_penalidad=u,type:"number",mode:"currency"},null,8,de),[[H,b.costo_penalidad]])]))),256))]),e("div",ue,[r(n,{onClick:o[1]||(o[1]=b=>m.value=!1)},{default:C(()=>o[6]||(o[6]=[P("No, Cerrar")])),_:1}),r(n,{severity:"danger",onClick:$},{default:C(()=>o[7]||(o[7]=[P("Si, Cancelar Servicio")])),_:1})])]),_:1},8,["title","modelValue"])}}},ve={class:"p-2"},pe={class:"mb-4 flex flex-col"},me={class:"font-extrabold text-2xl text-center",for:""},fe=["max"],be={class:"grid grid-cols-6 border-y items-center border text-right gap-x-4"},xe={class:"col-span-1"},ye={class:"col-span-1 text-nowrap truncate"},ge={class:"col-span-1"},we={class:"col-span-1"},Ce={class:"col-span-1"},Ve={class:"flex justify-end p-6 space-x-4"},$e={__name:"ServiceNoShow",props:I({service:Object},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const V=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}),m=M(s,"modelValue"),c=s,f=W({cantidad:c.service.adults,notes:"",proveedors:[]}),x=k([]);G(()=>{x.value=c.service.proveedors.map(o=>{var n=o.proveedor;return{proveedor_id:o.id,concept:n.concept,proveedor:o,pasajeros:c.service.adults,cost:o.cost,proveedor_name:n.proveedor.nombre,totalpayment:0,costo_penalidad:n.proveedor.type_penalidad_cost=="Porcentaje"?n.proveedor.penalidad_no_show/100*o.cost/c.service.adults:n.proveedor.penalidad_no_show}}),d()});const $=()=>{f.proveedors=x.value,f.post(route("noshow.servicio",c.service.id),{onSuccess:()=>{m.value=!1,console.log("No show")}})},d=()=>{x.value.forEach(o=>{o.total_no_show=o.costo_penalidad*f.cantidad})};return(o,n)=>{const b=R;return i(),U(L,{title:`Marcar como No SHOW ${s.service.service}`,modelValue:m.value,"onUpdate:modelValue":n[3]||(n[3]=u=>m.value=u),width:"70vw",onClose:n[4]||(n[4]=u=>m.value=!1),"close-on-escape":""},{default:C(()=>[e("div",ve,[e("div",pe,[e("h1",me,l(s.service.cliente_name),1),n[5]||(n[5]=e("label",{for:"",class:"font-bold"},"Cuantos no se presentaron?",-1)),h(e("input",{type:"number",min:1,onInput:d,max:s.service.adults,class:"rounded-lg border-gray-300","onUpdate:modelValue":n[0]||(n[0]=u=>p(f).cantidad=u)},null,40,fe),[[H,p(f).cantidad]])]),r(B,{type:"textarea",modelValue:p(f).notes,"onUpdate:modelValue":n[1]||(n[1]=u=>p(f).notes=u),label:"驴Porque no se presentaron?",class:"text-red-500"},null,8,["modelValue"]),n[6]||(n[6]=e("div",{class:"grid grid-cols-6 font-bold uppercase bg-gray-300 p-2 text-center"},[e("div",{class:"col-span-1"},"Proveedor"),e("div",{class:"col-span-1"},"Concepto"),e("div",{class:"col-span-1"},"Pasajeros"),e("div",{class:"col-span-1"},"Costo Servicio"),e("div",{class:"col-span-1"},"Pago Sugerido No Show"),e("div",{class:"col-span-1"},"Pago Total al proveedor")],-1)),(i(!0),v(N,null,T(x.value,u=>(i(),v("div",be,[e("div",xe,l(u.proveedor_name),1),e("div",ye,l(u.concept),1),e("div",ge,l(u.pasajeros),1),e("div",we,l(p(V).format(u.cost)),1),e("div",Ce,l(p(V).format(u.total_no_show)),1),r(B,{class:"col-span-1 rounded-md border-gray-300 p-2",modelValue:u.totalpayment,"onUpdate:modelValue":j=>u.totalpayment=j,type:"number",mode:"currency"},null,8,["modelValue","onUpdate:modelValue"])]))),256))]),e("div",Ve,[r(b,{onClick:n[2]||(n[2]=u=>m.value=!1)},{default:C(()=>n[7]||(n[7]=[P("No, Cerrar")])),_:1}),r(b,{severity:"warn",onClick:$},{default:C(()=>n[8]||(n[8]=[P("Si, Servicio No show")])),_:1})])]),_:1},8,["title","modelValue"])}}},_e={class:"flex items-center gap-2"},ke={class:"font-bold text-lg"},Se={class:"flex flex-col gap-y-1.5 text-sm"},he={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},je={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Oe={key:0,class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Ne={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},De={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Ae={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Be={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Ue=["href"],Pe={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Fe={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Ee={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Ie={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Me={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Te={key:1,class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Re={key:2,class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},Le={key:3,class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},He={class:"flex flex-col border py-1 bg-white/30 rounded-md px-2"},We={class:"text-lg flex w-full justify-between items-center mt-2"},Ge={class:"rounded-full bg-green-800 text-white px-1.5 py-0.5 text-xs fles items-center justify-center"},ze={class:"flex justify-between border py-1 bg-white/30 rounded-md px-2"},qe={class:"flex flex-col items-center"},Je={class:"grid grid-cols-3 md:grid-cols-6 gap-2"},Ke={class:"flex flex-col gap-y-2"},Qe={class:"flex flex-col gap-y-1"},Xe={key:0,class:"flex items-center gap-x-2"},Ye={key:1},Ze={class:"flex items-center gap-2"},et={class:"flex justify-end gap-2"},_t={__name:"viewBooking",props:I({service:Object,proveedors:Array},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const{toast:V}=Z(),m=s,c=k(null),f=M(s,"modelValue"),x=k(!1),$=k(!1),d=k(!1),o=W({service:m.service.id,current_id:"",new_id:"",state:"REUBICAR",note:"",terminated:!0,value:""}),n=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}),b=()=>{x.value=!0},u=(g,t)=>{E.fire({title:g,text:"Estas seguro de realizar esta acci贸n?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si"}).then(S=>{S.isConfirmed&&(E.fire({title:g,text:"Esta reserva ha sido "+g+".",icon:"success"}),q.post(route("set.states"),{service:m.service.id,state:g,terminated:t},{onSuccess:()=>{V("success","Reserva "+g)}}))})},j=()=>{E.fire({title:"Cambio de Fecha",input:"date",inputLabel:"Nueva Fecha",showCancelButton:!0,confirmButtonText:"Cambiar Fecha",showLoaderOnConfirm:!0,preConfirm:async g=>{await q.post(route("set.states"),{service:m.service.id,state:"CAMBIO DE FECHA",date:g,terminated:!1})},allowOutsideClick:()=>!E.isLoading()}).then(g=>{g.isConfirmed&&V("success","Fecha Cambiada")})},_=g=>{if(g==null||g==null)return"Sin definir";var t=new Date(new Date(g).getTime()+new Date(g).getTimezoneOffset()*6e4).toLocaleString("es-CO",{day:"2-digit",month:"2-digit",year:"numeric"});return t=="30/11/2"?"INDEFINIDO":t},y=()=>{if(!c.value||!o.new_id||!o.value)return V("error","Rellene todos los Campos"),0;o.current_id=c.value.id,o.state="REUBICADO",o.terminated=!0,o.post(route("set.states"),{onSuccess:()=>{d.value=!1,o.reset(),V("success","Servicio REUBICADO")}}),console.log(o.current_id)},D=()=>{o.reset(),d.value=!0},w={reservado:"blue","CAMBIO DE FECHA":"gray","NO SHOW":"amber",REUBICADO:"orange",CANCELADA:"green"};return(g,t)=>{const S=R,J=Y,K=X,A=Q;return i(),v(N,null,[r(J,{visible:f.value,"onUpdate:visible":t[6]||(t[6]=a=>f.value=a),"pt:root:class":`!bg-${w[s.service.status]}-200`,header:"Detalles de la actividad",position:"right"},{header:C(()=>[e("div",_e,[e("span",ke,l(s.service.service),1)])]),footer:C(()=>[e("div",qe,[e("div",Je,[h(r(S,{onClick:t[0]||(t[0]=a=>u("reservado",!0)),icon:"fa-solid fa-circle-check",severity:"info"},null,512),[[A,"Reservada",void 0,{top:!0}]]),h(r(S,{onClick:t[1]||(t[1]=a=>$.value=!0),icon:"fa-solid fa-eye-slash",class:"!text-white !bg-yellow-600"},null,512),[[A,"Servicio No show",void 0,{top:!0}]]),h(r(S,{onClick:t[2]||(t[2]=a=>j()),icon:"fa-solid fa-calendar-week",class:"!bg-gray-600 !text-white"},null,512),[[A,"Cambio de Fecha",void 0,{top:!0}]]),h(r(S,{onClick:t[3]||(t[3]=a=>D()),icon:"fa-solid fa-people-arrows",severity:"warn"},null,512),[[A,"Cambio de proveedor",void 0,{top:!0}]]),h(r(S,{onClick:t[4]||(t[4]=a=>b()),icon:"fa-solid fa-xmark-circle",severity:"danger"},null,512),[[A,"Cancelar Servicio",void 0,{top:!0}]]),h(r(S,{onClick:t[5]||(t[5]=a=>u("PROBLEMATICA",!1)),icon:"fa-solid fa-person-dress-burst",class:"flex-auto",severity:"danger"},null,512),[[A,"Servicio Problematico",void 0,{top:!0}]])])])]),default:C(()=>{var a;return[e("div",Se,[e("div",he,[t[16]||(t[16]=e("strong",null,"Fecha del Servicio:",-1)),e("p",null,l(_(s.service.date)),1)]),e("div",je,[t[17]||(t[17]=e("strong",null,"Hora del Servicio:",-1)),e("p",null,l(s.service.hour),1)]),s.service.time_service?(i(),v("div",Oe,[t[18]||(t[18]=e("strong",null,"Duraci贸n del Servicio:",-1)),e("p",null,l(s.service.time_service),1)])):O("",!0),e("div",Ne,[t[19]||(t[19]=e("strong",null,"Canal de Venta:",-1)),e("p",null,l(s.service.channel.name),1)]),e("div",De,[t[20]||(t[20]=e("strong",null,"Cliente:",-1)),e("p",null,l(s.service.cliente_name),1)]),e("div",Ae,[t[21]||(t[21]=e("strong",null,"Ciudad:",-1)),e("p",null,l(s.service.cliente_city),1)]),e("div",Be,[t[22]||(t[22]=e("strong",null,"Telelfono:",-1)),e("a",{target:"_blank",href:`https://wa.me/${s.service.cliente_phone}?text=Hola%20,%20mi%20nombre%20es%20*Sandra Gil*,%20Le%20escribo%20desde%20*AV%20COLOMBIA*`},l(s.service.cliente_phone),9,Ue)]),e("div",Pe,[t[23]||(t[23]=e("strong",null,"Edificio:",-1)),e("p",null,l(s.service.cliente_building),1)]),e("div",Fe,[t[24]||(t[24]=e("strong",null,"Adultos:",-1)),e("p",null,l(s.service.adults),1)]),e("div",Ee,[t[25]||(t[25]=e("strong",null,"Ni帽os:",-1)),e("p",null,l(s.service.boys),1)]),e("div",Ie,[t[26]||(t[26]=e("strong",null,"Total:",-1)),e("p",null,l(p(n).format(s.service.total)),1)]),e("div",Me,[t[27]||(t[27]=e("strong",null,"Total Real:",-1)),e("p",null,l(p(n).format(s.service.total_real)),1)]),s.service.user?(i(),v("div",Te,[t[28]||(t[28]=e("strong",null,"Usuario:",-1)),e("p",null,l((a=s.service.user)==null?void 0:a.name),1)])):O("",!0),s.service.user?(i(),v("div",Re,[t[29]||(t[29]=e("strong",null,"Fecha de reserva:",-1)),e("p",null,l(new Date(s.service.created_at).toLocaleDateString("es-CO")),1)])):O("",!0),s.service.fecha_cancelacion?(i(),v("div",Le,[t[30]||(t[30]=e("strong",null,"Fecha de Cancelaci贸n:",-1)),e("p",null,l(new Date(s.service.fecha_cancelacion).toLocaleDateString("es-CO")),1)])):O("",!0),e("div",He,[t[31]||(t[31]=e("strong",null,"Observacion:",-1)),e("p",null,l(s.service.observations),1)]),e("div",We,[t[32]||(t[32]=e("p",{class:"font-bold"},"Proveedores",-1)),e("p",Ge,l(s.service.proveedors.length),1)]),(i(!0),v(N,null,T(s.service.proveedors,z=>(i(),v("div",ze,[e("p",null,l(z.proveedor.proveedor.nombre),1),e("p",null,l(p(n).format(z.cost)),1)]))),256))])]}),_:1},8,["visible","pt:root:class"]),r(L,{modelValue:d.value,"onUpdate:modelValue":t[13]||(t[13]=a=>d.value=a),title:"Cambio de proveedor","close-on-escape":""},{default:C(()=>[e("div",Ke,[e("span",Qe,[t[35]||(t[35]=e("label",{for:"",class:"font-bold"}," Proveedor Actual",-1)),r(K,{placeholder:"Proveedor Actual",options:s.service.proveedors,label:"Proveedor Actual",modelValue:c.value,"onUpdate:modelValue":t[7]||(t[7]=a=>c.value=a),"option-label":"proveedor.name"},{value:C(a=>[a.value?(i(),v("div",Xe,[e("div",null,l(c.value.proveedor.proveedor.nombre),1),t[33]||(t[33]=e("span",null,"-",-1)),e("div",null,l(p(n).format(c.value.cost)),1)])):(i(),v("span",Ye,l(a.placeholder),1))]),option:C(({option:a})=>[e("div",Ze,[e("span",null,l(a.proveedor.proveedor.nombre),1),t[34]||(t[34]=e("span",null,"-",-1)),e("span",null,l(p(n).format(a.cost)),1)])]),_:1},8,["options","modelValue"])]),r(B,{"option-label":"nombre",type:"dropdown",label:"Nuevo Proveedor",modelValue:p(o).new_id,"onUpdate:modelValue":t[8]||(t[8]=a=>p(o).new_id=a),options:s.proveedors},null,8,["modelValue","options"]),r(B,{label:"Valor",modelValue:p(o).value,"onUpdate:modelValue":t[9]||(t[9]=a=>p(o).value=a),type:"number",mode:"currency"},null,8,["modelValue"]),r(B,{label:"Nota",modelValue:p(o).note,"onUpdate:modelValue":t[10]||(t[10]=a=>p(o).note=a),type:"textarea",mode:"currency"},null,8,["modelValue"]),e("div",et,[r(S,{onClick:t[11]||(t[11]=a=>d.value=!1),label:"Cancelar",severity:"danger",icon:"fa-solid fa-xmark"}),r(S,{onClick:t[12]||(t[12]=a=>y()),label:"Guardar",severity:"success",icon:"fa-solid fa-save"})])])]),_:1},8,["modelValue"]),x.value?(i(),U(ce,{key:0,modelValue:x.value,"onUpdate:modelValue":t[14]||(t[14]=a=>x.value=a),service:s.service},null,8,["modelValue","service"])):O("",!0),$.value?(i(),U($e,{key:1,modelValue:$.value,"onUpdate:modelValue":t[15]||(t[15]=a=>$.value=a),service:s.service},null,8,["modelValue","service"])):O("",!0)],64)}}},tt={class:"w-full flex flex-col gap-y-5 p-2"},ot={class:"h-[30vh] overflow-y-auto flex flex-col gap-y-2"},st={key:0,class:"flex w-full"},lt={class:"w-1/2 flex py-1 px-3 rounded-md items-center justify-between bg-sky-100"},nt={class:"flex flex-col"},at={class:"text-lg font-bold first-letter:uppercase"},it={class:"italic text-xs"},rt={key:1,class:"flex w-full"},dt={class:"w-1/2 flex py-1 px-3 rounded-md items-center border justify-between bg-gray-300"},ut={class:"flex flex-col"},ct={class:"text-lg font-bold first-letter:uppercase"},vt={class:"italic text-xs"},pt={key:0,class:"flex justify-center items-center"},mt={key:0,class:"flex justify-center flex-col items-center"},ft={class:"flex gap-x-2 px-2"},kt={__name:"Notas",props:I({todayActivity:Boolean,notes:Array,note:String,service:Array},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(s){const V=M(s,"modelValue"),m=s,c=k(m.notes),f=k(!1),x=k(null),$=k(!1),d=k(""),o=()=>{F.post(route("notes.store"),{note:d.value,booking_service_id:m.service.id}).then(_=>{d.value="",j()})},n=_=>{F.delete(route("notes.destroy",_.id)).then(y=>{j()})},b=_=>{d.value=_.note,f.value=!0,x.value=_},u=()=>{F.put(route("notes.update",x.value.id),{note:d.value}).then(_=>{j(),d.value="",f.value=!1,x.value=null})},j=()=>{$.value=!0,F.get(route("notes.index",{booking_service_id:m.service.id})).then(_=>{c.value=_.data.notes,$.value=!1})};return G(()=>{j()}),(_,y)=>{const D=R;return i(),v(N,null,[y[6]||(y[6]=P(" asndlands ")),r(L,{modelValue:V.value,"onUpdate:modelValue":y[1]||(y[1]=w=>V.value=w),"close-on-escape":"",title:"Notas",width:"60vw"},{default:C(()=>[e("div",tt,[y[5]||(y[5]=e("h3",{class:"text-xl font-bold"},"Notas de la Actividad",-1)),e("div",ot,[(i(!0),v(N,null,T(c.value,w=>(i(),v("div",{class:"flex p-2 rounded-md items-center justify-between w-full",key:w.id},[w.user_id==_.$page.props.auth.user.id?(i(),v("div",st,[y[2]||(y[2]=e("div",{class:"w-1/2"},null,-1)),e("div",lt,[e("span",nt,[e("p",at,l(w.note),1),e("p",it,l(new Date(w.created_at).toISOString().split("T")[0]),1)]),e("div",null,[r(D,{icon:"fa-solid fa-pencil",text:"",severity:"info",onClick:g=>b(w)},null,8,["onClick"]),r(D,{icon:"fa-solid fa-trash",text:"",severity:"danger",onClick:g=>n(w)},null,8,["onClick"])])])])):(i(),v("div",rt,[e("div",dt,[e("span",ut,[e("p",ct,l(w.note),1),e("p",vt,l(w.user.name)+" - "+l(new Date(w.created_at).toISOString().split("T")[0]),1)])]),y[3]||(y[3]=e("div",{class:"w-1/2"},null,-1))]))]))),128)),$.value?(i(),v("div",pt,[r(te)])):(i(),v(N,{key:1},[c.value.length==0?(i(),v("div",mt,[r(ee),y[4]||(y[4]=e("p",{class:"font-semibold text-xl"},"Serivicio sin notas",-1))])):O("",!0)],64))]),e("div",ft,[r(B,{type:"textarea",class:"w-full",rowsTextarea:2,modelValue:d.value,"onUpdate:modelValue":y[0]||(y[0]=w=>d.value=w)},null,8,["modelValue"]),f.value?(i(),U(D,{key:1,label:"Editar",severity:"info",icon:"pi pi-send",class:"!h-12",onClick:u})):(i(),U(D,{key:0,label:"Guardar",severity:"success",class:"!h-12",icon:"pi pi-send",onClick:o}))])])]),_:1},8,["modelValue"])],64)}}};export{kt as _,_t as a};
