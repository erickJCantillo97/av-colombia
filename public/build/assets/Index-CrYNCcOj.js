import{_ as N}from"./Datatable-BaeW8CPU.js";import{e_ as z,z as B,d as x,x as D,q as T,f as a,o as l,a as o,b as c,w as p,u as r,g as y,F as _,i as C,n as U,t as u,h as q,y as F}from"./app-Ecou4AjU.js";import{s as G}from"./index-BCCtM-QC.js";import{_ as P}from"./Modal-DcrNi4I8.js";import{_ as S}from"./Input-BBMe-vne.js";import{s as w}from"./index-RI3qUlyS.js";import"./index-vQnQ5Kyt.js";import"./index-DAEr9CWS.js";import"./index-BalX16ag.js";import"./index-CQJ2djm5.js";import"./index-CpDzmI1Q.js";import"./index-BkI0zbvT.js";import"./index-B-6qqHsU.js";import"./index-5EU8ZVKB.js";import"./index-D90rq6Zp.js";import"./index-hBQiCpgb.js";import"./index-B-k3ijzR.js";import"./index-D4j0Z-jR.js";import"./postcss-B9xU5YA6.js";import"./postcss-DzRR26tZ.js";import"./index-BSEYT2kD.js";import"./index-BS6kjEQ2.js";import"./useCommonUtilities-BgDhORlD.js";import"./index-_mWtDgta.js";import"./index-IB_nUVup.js";import"./index-CKsvEGF_.js";import"./index-DSvnr7zH.js";import"./index-C0EYjaMa.js";const H={class:"h-[99vh]"},I={class:"text-xl font-bold white-space-nowrap"},J={key:0,class:"fa-solid fa-plus"},K={key:1,class:"fa-solid fa-pencil"},M={class:"flex gap-x-3 py-2"},O={class:"grid grid-cols-1 w-full shadow-2xl border rounded-md gap-4 p-6"},Q={class:"w-full"},R={class:"max-h-64 overflow-y-auto border border-gray-200 rounded-md p-2"},W={class:"grid grid-cols-1 gap-2"},X=["onClick"],Y={class:"flex items-center justify-between"},Z={class:"font-medium text-sm"},ee={key:0,class:"fa-solid fa-check text-blue-600"},se={key:0,class:"text-red-500 text-sm mt-1"},te={key:1,class:"mt-4"},ie={class:"text-sm font-medium text-gray-700 mb-2"},oe={class:"flex flex-wrap gap-2"},re=["onClick"],ze={__name:"Index",props:{ticketTypes:Array,services:Array},setup(h){const f=h,V=[{header:"Tipo de Ticket",field:"name",filter:!0},{header:"Servicios Asociados",field:"services_count",filter:!1,type:"html-custom",renderer:s=>{const e=s.services?s.services.length:0;return`<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                ${e} servicio${e!==1?"s":""}
              </span>`}},{header:"Servicios",field:"services_list",filter:!1,type:"html-custom",renderer:s=>{if(!s.services||s.services.length===0)return'<span class="text-gray-500 italic">Sin servicios</span>';const e=s.services.map(g=>g.title).join(", "),i=e.length>50?e.substring(0,50)+"...":e;return`<span class="text-sm" title="${e}">${i}</span>`}}],v=z(),$=B(),d=x(!1),n=x(!1),m=x(""),t=D({id:null,name:"",services:[]}),j={action:()=>{t.reset(),d.value=!1,n.value=!0}},A=[{action:s=>{t.reset(),n.value=!0,d.value=!0,t.id=s.id,t.name=s.name,t.services=s.services?s.services.map(e=>e.id):[]},severity:"secondary",icon:"fa-solid fa-pencil text-sm"},{action:(s,e)=>{$.require({target:e.currentTarget,message:"¿Seguro de eliminar el tipo de ticket "+s.name+"?",icon:"fa-solid fa-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined p-button-sm",acceptClass:"p-button-sm p-button-danger",rejectLabel:"Cancelar",acceptLabel:"Eliminar",accept:()=>{F.delete(route("ticketTypes.destroy",s.id),{onSuccess:()=>{v.add({severity:"error",icon:"fa-solid fa-trash-can",summary:"¡Acción realizada!",detail:"Tipo de ticket eliminado con éxito",group:"customTooltipDataTable",life:5e3})}})}})},severity:"danger",icon:"fa-regular fa-trash-can text-sm"}],L=T(()=>m.value?f.services.filter(s=>s.title.toLowerCase().includes(m.value.toLowerCase())):f.services),b=T(()=>f.services.filter(s=>t.services.includes(s.id))),k=s=>{t.services.includes(s)?t.services=t.services.filter(e=>e!==s):t.services.push(s)},E=()=>{d.value?t.put(route("ticketTypes.update",t.id),{onSuccess:()=>{n.value=!1,v.add({severity:"success",icon:"fa-solid fa-check",summary:"¡Éxito!",detail:"Tipo de ticket actualizado con éxito",group:"customTooltipDataTable",life:3e3})}}):t.post(route("ticketTypes.store"),{onSuccess:()=>{n.value=!1,v.add({severity:"success",icon:"fa-solid fa-check",summary:"¡Éxito!",detail:"Tipo de ticket creado con éxito",group:"customTooltipDataTable",life:3e3})}})};return(s,e)=>(l(),a(_,null,[o("div",H,[c(N,{columnas:V,add:j,data:h.ticketTypes,actions:A},null,8,["data"])]),c(P,{visible:n.value,"onUpdate:visible":e[3]||(e[3]=i=>n.value=i),width:"70vw","close-on-escape":""},{title:p(()=>[o("span",I,u(d.value?"Editar":"Agregar")+" Tipo de Ticket ",1)]),icon:p(()=>[d.value?(l(),a("i",K)):(l(),a("i",J))]),footer:p(()=>[c(r(w),{onClick:E,title:"Guardar",severity:"success",label:"Guardar",outlined:"",icon:"fa-solid fa-save",class:"!h-8",loading:r(t).processing},null,8,["loading"]),c(r(w),{onClick:e[2]||(e[2]=i=>n.value=!1),title:"Cancelar",severity:"danger",label:"Cancelar",outlined:"",icon:"fa-solid fa-times",class:"!h-8"})]),default:p(()=>[o("div",M,[o("div",O,[c(S,{label:"Nombre del Tipo de Ticket",modelValue:r(t).name,"onUpdate:modelValue":e[0]||(e[0]=i=>r(t).name=i),"error-message":r(t).errors.name,placeholder:"Ej: Ticket VIP, Ticket Estándar, etc."},null,8,["modelValue","error-message"]),o("div",Q,[e[5]||(e[5]=o("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Servicios Asociados ",-1)),c(S,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=i=>m.value=i),placeholder:"Buscar servicios...",class:"mb-3"},null,8,["modelValue"]),o("div",R,[o("div",W,[(l(!0),a(_,null,C(L.value,i=>(l(),a("div",{key:i.id,onClick:g=>k(i.id),class:U([{"bg-blue-100 border-blue-500":r(t).services.includes(i.id),"bg-gray-50 border-gray-200":!r(t).services.includes(i.id)},"p-3 rounded-md cursor-pointer border-2 hover:bg-blue-50 transition-colors duration-200"])},[o("div",Y,[o("span",Z,u(i.title),1),r(t).services.includes(i.id)?(l(),a("i",ee)):y("",!0)])],10,X))),128))])]),r(t).errors.services?(l(),a("div",se,u(r(t).errors.services),1)):y("",!0),b.value.length>0?(l(),a("div",te,[o("h4",ie," Servicios Seleccionados ("+u(b.value.length)+") ",1),o("div",oe,[(l(!0),a(_,null,C(b.value,i=>(l(),a("span",{key:i.id,class:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},[q(u(i.title)+" ",1),o("button",{onClick:g=>k(i.id),class:"ml-2 inline-flex items-center justify-center w-4 h-4 rounded-full bg-blue-200 hover:bg-blue-300"},e[4]||(e[4]=[o("i",{class:"fa-solid fa-times text-xs"},null,-1)]),8,re)]))),128))])])):y("",!0)])])])]),_:1},8,["visible"]),c(r(G))],64))}};export{ze as default};
