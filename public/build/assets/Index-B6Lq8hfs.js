import{G as M,H as F,d as a,I as J,q as K,f as y,o as m,a as o,b as _,w as T,g as V,u as E,F as B,i as L,n as P,t as k,A as H,J as Q,K as Z,L as X,y as R,M as O,e as ee,c as N,m as I,T as te}from"./app-CFt-ib-s.js";import{_ as se}from"./Datatable-CvTNHrRB.js";import{_ as oe}from"./AppLayout-E29DIPp_.js";import{a as ae}from"./toasts-C1OsSOkw.js";import{S as re}from"./sweetalert2.all-CDfjvhwa.js";import{_ as le,a as ne}from"./Notas-BDdB96fG.js";import{_ as ie}from"./Modal-sjNFOpyh.js";import{_ as ue}from"./Input-BVLjzbUh.js";import{_ as ce}from"./logo-3CTnfu2w.js";import"./index-CEWpWX_u.js";import"./index-ab6zeLIs.js";import"./index-BPUZ2R0U.js";import"./index-CQVsu-9_.js";import"./index-Bvrv5lf9.js";import"./index-DUmZa4IX.js";import"./index-D_57e_TZ.js";import"./index-DXeE62vo.js";import"./index-hqAp1ld7.js";import"./index-DkBDVGzr.js";import"./index-CXT8joFC.js";import"./index-BM4qCsPz.js";import"./index-CdROcrNj.js";import"./postcss-bNS4p6LU.js";import"./postcss-DguyADY8.js";import"./index-CMIE8gfo.js";import"./index-D3T1oQV3.js";import"./useCommonUtilities-BgDhORlD.js";import"./index-B6FDwg95.js";import"./Service-Y552SPIl.js";import"./Toats-b3G-hlnV.js";import"./searchStore-DwY7j4U7.js";import"./Loading-DVSD8v9I.js";import"./index-BedCTQrz.js";import"./index-CSwpq5nP.js";import"./index-CU5SD16V.js";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const de=()=>{};function me(h,u,v){let c;M(v)?c={evaluating:v}:c={};const{lazy:C=!1,evaluating:l=void 0,shallow:n=!0,onError:r=de}=c,A=F(!C),b=n?F(u):a(u);let d=0;return J(async x=>{if(!A.value)return;d++;const S=d;let f=!1;l&&Promise.resolve().then(()=>{l.value=!0});try{const p=await h(D=>{x(()=>{l&&(l.value=!1),f||D()})});S===d&&(b.value=p)}catch(p){r(p)}finally{l&&S===d&&(l.value=!1),f=!0}}),C?K(()=>(A.value=!0,b.value)):b}const ve={key:0,class:"items-center justify-center flex flex-col"},fe={class:"flex flex-col gap-y-3 h-[60vh] overflow-y-auto"},pe={class:"shadow-lg pr-4 rounded-md flex items-center justify-between"},ge={class:"text-xl font-bold"},be={class:"font-bold text-sm"},xe={__name:"Changes",setup(h){const u=a(!1),v=a(),c=me(async()=>{var{data:l}=await H.get(route("get.states.change",{date:v.value}));return l.status}),C={reservado:"blue","CAMBIO DE FECHA":"gray","NO SHOW":"amber",REUBICADO:"orange",CANCELADA:"green",PROBLEMATICA:"red"};return(l,n)=>(m(),y(B,null,[o("span",{onClick:n[0]||(n[0]=r=>u.value=!0),class:"text-xs font-bold text-blue-800 cursor-pointer"},"Listado de Cambios"),_(ie,{title:"Historial de Cambios",modelValue:u.value,"onUpdate:modelValue":n[2]||(n[2]=r=>u.value=r),"close-on-escape":""},{default:T(()=>[_(ue,{"max-date":new Date,type:"date",class:"my-2",modelValue:v.value,"onUpdate:modelValue":n[1]||(n[1]=r=>v.value=r),dateFormat:"dd/mm/yy"},null,8,["max-date","modelValue"]),E(c)&&E(c).length==0?(m(),y("div",ve,[_(ce),n[3]||(n[3]=o("p",null,"Sin Cambio Registrados",-1))])):V("",!0),o("div",fe,[(m(!0),y(B,null,L(E(c),r=>(m(),y("div",pe,[o("div",{class:P(["rounded-l-md text-lg font-bold uppercase",`bg-${C[r.state]}-200 p-2`])},k(r.state),3),o("div",null,[o("p",ge,k(r.statable.service),1),o("span",be,k(r.user.name),1)])]))),256))])]),_:1},8,["modelValue"])],64))}},ye=Q("bookingService",()=>{const h=a([]),u=a(null);return{selectDate:h,statusFilter:u}},{persist:{storage:sessionStorage,paths:["selectDate","statusFilter"]}}),_e=[{field:"created_at",header:"Fecha Entrada",filter:!0,sortable:!0,type:"date"},{field:"cliente_name",header:"Nombre del pasajero",filter:!0,sortable:!0},{field:"adults",header:"Pasajeros",filter:!0,sortable:!0},{field:"cliente_building",header:"Edificio u Hotel",filter:!0,sortable:!0},{field:"service",header:"Actividad",filter:!0,sortable:!0},{field:"date",header:"Fecha de la Actividad",filter:!1,type:"date",sortable:!0},{field:"channel.name",header:"Canal de venta",filter:!0,sortable:!0},{field:"proveedors_names",header:"proveedores",class:"text-center font-semibold text-sm",filter:!0},{field:"status",header:"Estado",filter:!0,sortable:!0,type:"text",filtertype:"EQUALS",class:"text-center uppercase",severitys:[{text:"RESERVADO",severity:"info",class:""},{text:"CAMBIO DE FECHA",class:"bg-gray-200 font-bold"},{text:"COMPLETADA",severity:"success",class:""},{text:"NO SHOW",severity:"warn",class:""},{text:"REUBICADO",severity:"warn",class:""},{text:"CANCELADA",severity:"danger",class:"animate-pulse"},{text:"PROBLEMATICA",severity:"danger",class:"animate-pulse"},{text:"SIN CONFIRMAR",severity:"danger"}]}],he={class:"h-[92vh]"},Ce={class:"flex py-2 px-4 justify-between items-center"},Ae={class:"italic flex flex-col"},Ee={class:"flex gap-x-2"},$e=["onClick"],we={class:"text-xs font-bold uppercase"},it={__name:"Index",props:{bookingServices:Array},setup(h){const u=h,{toast:v}=ae(),c=a([]),C=a([]),l=a(!1),n=a(""),r=a([]),A=a(!1),b=a(null),d=a(!1),x=a(u.bookingServices),S=ye(),{selectDate:f,statusFilter:p}=Z(S),D=[{text:"RESERVADO",color:"blue"},{text:"CAMBIO DE FECHA",color:"gray"},{text:"NO SHOW",color:"amber"},{text:"REUBICADO",color:"orange"},{text:"CANCELADA",color:"green"},{text:"SIN CONFIRMAR",color:"red"}],U={action:()=>{R.get(route("BookingServices.create"))}},j=async e=>{const{data:t}=await H.get(route("get.all.booking.services.dates",{dates:e}));return t.bookingServices};X([f,p,l],async([e,t,w])=>{if(w){f.value=[new Date("2024-11-02"),new Date],l.value=!1;return}if(!e)x.value=u.bookingServices;else{const g=await j(e);x.value=g}t&&(x.value=x.value.filter(g=>g.status==t))},{immediate:!0});const W=e=>{p.value=e},z=[{label:"Detalles",action:async e=>{b.value=e,A.value=!0,await getProveedors()},icon:"fa-solid fa-circle-info text-sm",severity:"info"},{label:"Editar",action:async e=>{R.get(route("BookingServices.edit",e.id))},icon:"fa-solid fa-pencil text-sm",severity:"warn"},{label:"Notas",severity:"secondary",action:e=>{r.value=e,d.value=!0},icon:"fa-solid fa-note-sticky text-sm"},{label:"Eliminar",icon:"fa-solid fa-trash text-sm",severity:"danger",show:O().props.auth.user.rol=="admin"||O().props.auth.user.rol=="superadmin",action:e=>{re.fire({title:"Estas Seguro?",text:`Eliminar la reservaciÃ³n de ${e.cliente_name}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Si, Eliminar!"}).then(t=>{t.isConfirmed&&R.delete(route("BookingServices.destroy",e.id),{onSuccess:()=>{v("success","Reserva Eliminada")}})})}}],$=a([]),G=e=>{$.value=e},Y=e=>{const t=e[0].getDate(),w=e[0].getMonth()+1,g=e[0].getFullYear(),s=i=>i<10?`0${i}`:i;return`${s(t)}/${s(w)}/${g} - ${s(e[1].getDate())}/${s(e[1].getMonth()+1)}/${e[1].getFullYear()}`};return(e,t)=>{const w=ee("VueDatePicker"),g=te;return m(),y(B,null,[_(oe,{title:"Reservas"},{default:T(()=>[t[6]||(t[6]=o("div",{class:"hidden bg-amber-200 bg-orange-200 bg-blue-200 !bg-green-200 !bg-gray-200 !bg-orange-200 !bg-amber-200"},null,-1)),o("div",he,[o("div",Ce,[o("div",Ae,[t[4]||(t[4]=o("h1",{class:"text-2xl font-bold"},"Reservas",-1)),_(xe)]),o("div",Ee,[I((m(),y("div",{class:"p-2 bg-black text-white text-center rounded-lg cursor-pointer transition-all duration-300 scale-95 hover:scale-100 border-2",onClick:t[0]||(t[0]=s=>p.value=null)},t[5]||(t[5]=[o("p",{class:"text-sm font-bold uppercase"},"Todos",-1)]))),[[g,`${$.value.length} Reservas
                        ${$.value.reduce((s,i)=>s+i.adults,0)} Pasajeros
                        `,void 0,{bottom:!0}]]),(m(),y(B,null,L(D,s=>I(o("div",{onClick:i=>W(s.text),class:P(["flex items-center transition-all duration-300 py-1 px-4 rounded-lg cursor-pointer hover:scale-105 hover:border-b-4 hover:border-gray-800",[`bg-${s.color}-200`,E(p)==s.text?"border-b-4 scale-105 shadow-lg border-gray-800":""]])},[o("p",we,k(s.text),1)],10,$e),[[g,`${$.value.filter(i=>i.status==s.text).length} Reservas
                    ${$.value.filter(i=>i.status==s.text).reduce((i,q)=>i+q.adults,0)} Pasajeros
                    `,void 0,{bottom:!0}]])),64))]),o("div",null,[_(w,{"hide-offset-dates":"",modelValue:E(f),"onUpdate:modelValue":t[1]||(t[1]=s=>M(f)?f.value=s:null),teleport:!0,format:Y,"model-type":"yyyy-MM-dd",range:"","enable-time-picker":!1,locale:"es","multi-calendars":{solo:!0},timezone:"America/Bogota"},null,8,["modelValue"])])]),_(se,{actions:z,add:U,showButtonBar:"",columnas:E(_e),data:x.value,cacheName:"reservas",rowClass:!0,onFilterApply:G},null,8,["columnas","data"])]),b.value?(m(),N(le,{key:0,modelValue:A.value,"onUpdate:modelValue":t[2]||(t[2]=s=>A.value=s),service:b.value,proveedors:c.value},null,8,["modelValue","service","proveedors"])):V("",!0)]),_:1}),d.value?(m(),N(ne,{key:0,modelValue:d.value,"onUpdate:modelValue":t[3]||(t[3]=s=>d.value=s),notes:C.value,note:n.value,service:r.value},null,8,["modelValue","notes","note","service"])):V("",!0)],64)}}};export{it as default};
