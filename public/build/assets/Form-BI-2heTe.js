var x=Object.defineProperty;var D=(l,r,c)=>r in l?x(l,r,{enumerable:!0,configurable:!0,writable:!0,value:c}):l[r]=c;var a=(l,r,c)=>D(l,typeof r!="symbol"?r+"":r,c);import{s as C}from"./index-CH3WORGE.js";import{s as U}from"./index-D6LmgUKc.js";import{s as I}from"./index-C1COS3Hy.js";import{s as M}from"./index-DErPqvG2.js";import{d as u,x as $,A as P,B as j,f as g,o as b,b as s,w as p,a as n,u as i,t as d,h as N,k as h}from"./app-yl9nZsS-.js";import{S as A}from"./Service-DRziOGSb.js";import{g as E}from"./Toats-RcJDUpcK.js";import"./index-BAzHb43E.js";import"./index-WEUu9Js4.js";import"./index-BCfKfP7b.js";import"./index-UQKncvLq.js";import"./index-BXfujk3w.js";import"./index-BKJsDyWc.js";import"./index-CQ_QSPMx.js";import"./index-C1LpVKoi.js";import"./index-Dmun2gIf.js";import"./searchStore-DkQ7og9O.js";import"./sweetalert2.esm.all-DV3w3JmD.js";class F{constructor(r){a(this,"proveedors",u([]));a(this,"loading",u(!1));a(this,"bookingService",u());a(this,"proveedorSelected",u());a(this,"proveedorsByBookingService",u([]));a(this,"form",$({p:null,booking_service_id:null,proveedor_id:null,cost:0,concept:"",discount:0,percent_discount:0}));this.bookingService.value=r,this.getProveedorByBookingService()}async getProveedorByBookingService(){const{data:r}=await P.get(route("get.proveedor.by.booking.service",this.bookingService.value.id));this.proveedorsByBookingService.value=r.proveedors}calculateCost(){this.form.cost=this.form.p.pivot.value*this.bookingService.value.adults}async submit(){this.form.proveedor_id=this.form.p.id,this.form.booking_service_id=this.bookingService.value.id,this.form.concept=this.form.p.pivot.concept,this.form.p=null,this.form.post(route("BookingServiceProveedors.store"),{onSuccess:()=>{E("Proveedor agregado"),this.form.reset()}})}}const L={key:0},O={key:1},T={class:"flex gap-x-2"},lo={__name:"Form",props:{bookingService:Object},setup(l){const r=u(!0),c=u(!0),y=new A,S=l,k=u([]),t=new F(S.bookingService);j(async()=>{var f;k.value=await y.getProveedorsByService((f=S.bookingService)==null?void 0:f.service_id)});function w(){t.form.cost!==0&&(t.form.percent_discount=t.form.discount/t.form.cost*100,r.value=!0)}function _(){t.form.cost!==0&&(t.form.discount=t.form.percent_discount*t.form.cost/100,c.value=!0)}return(f,o)=>{const V=M,m=I,v=U,B=C;return b(),g("form",{class:"w-full flex justify-between gap-x-4",onSubmit:o[7]||(o[7]=h((...e)=>i(t).submit&&i(t).submit(...e),["prevent"]))},[s(m,{class:"w-full"},{default:p(()=>[s(V,{options:k.value,inputId:"proveedor",onChange:o[0]||(o[0]=e=>i(t).calculateCost()),modelValue:i(t).form.p,"onUpdate:modelValue":o[1]||(o[1]=e=>i(t).form.p=e),variant:"filled",placeholder:"Selecciona un proveedor",class:"w-full","option-label":"nombre"},{value:p(e=>[e.value?(b(),g("span",L,d(e.value.nombre)+" - "+d(e.value.pivot.concept),1)):(b(),g("span",O,d(e.placeholder),1))]),option:p(e=>[n("div",T,[n("span",null,d(e.option.nombre)+" - ",1),n("span",null,d(e.option.pivot.concept)+" - ",1),n("span",null,d(e.option.pivot.value),1)])]),_:1},8,["options","modelValue"]),o[8]||(o[8]=n("label",{for:"proveedor"},"Proveedor - Concepto",-1))]),_:1}),s(m,{class:"w-full"},{default:p(()=>[s(v,{modelValue:i(t).form.cost,"onUpdate:modelValue":o[2]||(o[2]=e=>i(t).form.cost=e),inputId:"price_input",mode:"currency",currency:"USD",locale:"en-US",variant:"filled",class:"w-full"},null,8,["modelValue"]),o[9]||(o[9]=n("label",{for:"price_input"},"Costo",-1))]),_:1}),s(m,{class:"w-full"},{default:p(()=>[s(v,{modelValue:i(t).form.discount,"onUpdate:modelValue":o[3]||(o[3]=e=>i(t).form.discount=e),onValueChange:o[4]||(o[4]=e=>w()),inputId:"price_input",mode:"currency",currency:"USD",locale:"en-US",variant:"filled",class:"w-full"},null,8,["modelValue"]),o[10]||(o[10]=n("label",{for:"price_input"}," Descuento por pasajero ",-1))]),_:1}),s(m,{class:"w-full"},{default:p(()=>[s(v,{modelValue:i(t).form.percent_discount,"onUpdate:modelValue":o[5]||(o[5]=e=>i(t).form.percent_discount=e),onValueChange:o[6]||(o[6]=e=>_()),inputId:"discount_input",variant:"filled",class:"w-full",suffix:" %"},null,8,["modelValue"]),o[11]||(o[11]=n("label",{for:"discount_input"}," % Descuento por pasajero ",-1))]),_:1}),s(B,{type:"submit",severity:"success",class:"w-full"},{default:p(()=>o[12]||(o[12]=[n("i",{class:"fa-solid fa-plus"},null,-1),N(" Agregar ")])),_:1})],32)}}};export{lo as default};
