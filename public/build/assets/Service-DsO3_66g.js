var g=Object.defineProperty;var h=(o,a,e)=>a in o?g(o,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[a]=e;var n=(o,a,e)=>h(o,typeof a!="symbol"?a+"":a,e);import{y as c,x as m,A as d}from"./app-BEX114WY.js";import{a as u,g as l}from"./Toats-RcJDUpcK.js";import{s as i}from"./searchStore-CLWbfYmb.js";class f{constructor(){n(this,"url",null)}assignMatchingKeys(a,e){Object.keys(a).forEach(t=>{t in e&&(e[t]=a[t])})}submit(a,e=null){return e?c.put(route(this.url+".update",e),a,{onSuccess:()=>{l("Actualizado Exitosamente")},onError:t=>{u(t.response.data.message||"Error al actualizar")}}):c.post(route(this.url+".store"),a,{onSuccess:()=>{l("Guardado Exitosamente")},onError:t=>{u(t.response.data.message||"Error al guardar")}})}delete(a){return c.delete(route(this.url+".destroy",a),{onSuccess:()=>{l("Eliminado Exitosamente")},onError:e=>{u(e.response.data.message||"Error al eliminar")}})}}class x extends f{constructor(e){super();n(this,"loading",!1);n(this,"service",[]);n(this,"portada",null);n(this,"form",m({title:"",description:"",features:[],boys_price:0,adults_price:0,code:"",includes:[],notIncludes:[],type:"TOUR",city:"Cartagena",problematic:0,duration_type:"",destinations:"",duration:0,duration_unit:"Dias",recogidas:[],puntos:[],capacidad_min:1,capacidad_max:1}));this.service=e,this.url="services",e&&(this.assignMatchingKeys(e,this.form),this.form.includes=JSON.parse(e.includes),this.form.notIncludes=JSON.parse(e.notIncludes),this.form.recogidas=JSON.parse(e.recogidas),this.form.puntos=JSON.parse(e.puntos))}async getProveedorsByService(e){const{data:t}=await d.get(route("get.proveedors.by.service",e));return t.proveedors}async getServices(){const{data:e}=await d.get(route("get.all.services"));return e.services}async getServicePagination(e=1,t=10){const s={page:e,location:i.location.value,type:i.type.value.value,checkin:i.checkin.value,checkout:i.checkout.value,guests:i.guests.value,perPage:t},{data:r}=await d.get(route("services.get.paginated"),{params:s});return r}async submit(){var s;const e=["includes","notIncludes","recogidas","puntos"],t={};e.forEach(r=>{t[r]=this.form[r],this.form[r]=JSON.stringify(this.form[r])}),super.submit(this.form,((s=this.service)==null?void 0:s.id)??null),e.forEach(r=>{this.form[r]=t[r]})}async setPortada(){c.post(route("set.portada",this.service.slug),{portada:this.portada},{onSuccess:()=>{l("Portada actualizada exitosamente")},onError:e=>{u("Error al actualizar la portada")}})}formatDate(e){const t=new Date(e),s=t.getFullYear(),r=String(t.getMonth()+1).padStart(2,"0"),p=String(t.getDate()).padStart(2,"0");return`${s}-${r}-${p}`}getPrice(){var t;const e=((t=this.service.availabilities.find(s=>this.formatDate(s.start_date)<=this.formatDate(i.checkin.value)&&this.formatDate(s.end_date)>=this.formatDate(i.checkout.value)))==null?void 0:t.precies)??[];return e.length?e.reduce((s,r)=>r.value>s.value?r:s,e[0]).value:0}}export{x as S};
