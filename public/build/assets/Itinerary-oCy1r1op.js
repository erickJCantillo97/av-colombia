import{s as S}from"./index-RI3qUlyS.js";import{s as U}from"./index-IB_nUVup.js";import{s as q}from"./index-C0EYjaMa.js";import{s as T}from"./index-CKsvEGF_.js";import{s as z}from"./index-5EU8ZVKB.js";import{d as _,fb as D,q as G,f as p,o as d,a as o,k as M,b as r,w as m,h as g,g as b,c as O,t as h,F as w,i as R,x as H}from"./app-Ecou4AjU.js";import"./index-vQnQ5Kyt.js";import"./index-DAEr9CWS.js";import"./index-BalX16ag.js";import"./index-BSEYT2kD.js";import"./index-B-6qqHsU.js";const J={class:"sm:grid sm:grid-cols-3 gap-4 mt-6"},K={class:"flex flex-col gap-2"},P={class:"flex flex-col gap-2"},Q={class:"card flex flex-col gap-6"},W=["src"],X={class:"flex gap-7"},Y={class:"col-span-2 bg-gray-300 p-2 rounded-md h-[600px] gap-3 flex flex-col overflow-y-auto"},Z={key:0,class:"flex items-center justify-center h-full"},ee={class:"w-full bg-white grid grid-cols-3 gap-3 p-5 rounded-lg shadow-md mb-3"},te=["src"],ie={class:"col-span-2 flex justify-center"},se={class:"w-full"},oe={class:"text-2xl font-bold"},le={class:"flex flex-col justify-end gap-2"},ae={class:"flex justify-center p-5"},xe={__name:"Itinerary",props:{service:Object,itineraries:Array},setup(V){const v=V,c=_(!1),y=_(-1),t=D({id:"",title:"",description:"",image:null,service_id:v.service.id,option:"create"}),l=_(v.itineraries.map(i=>({...i,image:i.images&&i.images.length>0?i.images[0].filepath:null,option:null}))),f=G(()=>l.value.filter(i=>i.option!=="delete"));function C(i){const e=i.files[0];if(!e)return;const s=new FileReader;s.onload=async a=>{t.image=a.target.result},s.readAsDataURL(e)}function E(){return!t.title||!t.title.trim()?(alert("El título es obligatorio"),!1):!t.description||!t.description.trim()?(alert("La descripción es obligatoria"),!1):t.image?!0:(alert("La imagen es obligatoria"),!1)}const j=()=>{if(E())if(c.value){const i=y.value;i>=0&&i<l.value.length&&(l.value[i].id&&(l.value[i].option="edit"),l.value[i].title=t.title,l.value[i].description=t.description,l.value[i].image=t.image,k())}else l.value.push({id:"",title:t.title,description:t.description,image:t.image,service_id:v.service.id,option:"create"}),I()};function I(){t.id="",t.title="",t.description="",t.image=null,t.option="create"}function k(){c.value=!1,y.value=-1,I()}function F(){const i=l.value.filter(s=>s.option!==null).map(s=>({id:s.id,title:s.title,description:s.description,image:s.image,service_id:s.service_id,option:s.option}));if(i.length===0){alert("No hay cambios para guardar");return}console.log("Itinerarios modificados:",i),H({itineraries:i}).post(route("itinerary.store"),{onSuccess:s=>{console.log("Guardado exitoso:",s),l.value=l.value.filter(a=>a.option!=="delete"),l.value.forEach(a=>a.option=null)},onError:s=>{console.error("Error al guardar:",s),alert("Ocurrió un error al guardar los cambios")}})}function N(i){const e=f.value[i];if(!e)return;const s=l.value.findIndex(a=>a.id===e.id&&a.title===e.title&&a.description===e.description);s>=0&&(c.value=!0,y.value=s,t.id=e.id||"",t.title=e.title,t.description=e.description,t.image=e.image)}function $(i){const e=f.value[i];if(!e)return;const s=l.value.findIndex(a=>a.id===e.id&&a.title===e.title&&a.description===e.description);s>=0&&(l.value[s].id?l.value[s].option="delete":l.value.splice(s,1))}return(i,e)=>{const s=z,a=T,A=q,B=U,u=S;return d(),p(w,null,[e[8]||(e[8]=o("div",{class:"flex flex-col gap-y-2"},[o("h4",{class:"text-2xl font-semibold text-green-800"},"Itinerario"),o("span",{class:"italic"},"Estos son los servicios que se incluirán en la reserva")],-1)),o("div",J,[o("form",{onSubmit:M(j,["prevent"]),class:"space-y-7 h-[600px] flex flex-col items-center justify-center"},[o("div",K,[e[3]||(e[3]=o("label",{for:"title"},"Título a mostrar",-1)),r(s,{id:"title",modelValue:t.title,"onUpdate:modelValue":e[0]||(e[0]=n=>t.title=n),"aria-describedby":"title-help",required:""},null,8,["modelValue"]),r(a,{size:"small",severity:"secondary",variant:"simple"},{default:m(()=>e[2]||(e[2]=[g(" El título a mostrar se mostrará en la página de detalle del servicio ")])),_:1})]),o("div",P,[e[5]||(e[5]=o("label",{for:"description"},"Descripción a mostrar",-1)),r(A,{id:"description",modelValue:t.description,"onUpdate:modelValue":e[1]||(e[1]=n=>t.description=n),required:"","aria-describedby":"description-help"},null,8,["modelValue"]),r(a,{size:"small",severity:"secondary",variant:"simple"},{default:m(()=>e[4]||(e[4]=[g(" La descripción a mostrar se mostrará en la página de detalle del servicio ")])),_:1})]),o("div",Q,[r(B,{mode:"basic","choose-label":"Agrega una imagen del itinerario",onSelect:C,customUpload:"",auto:"",severity:"secondary",class:"p-button-outlined w-full"}),t.image?(d(),p("img",{key:0,src:t.image,alt:"Image",class:"shadow-md rounded-xl w-full h-40 object-cover",style:{filter:"grayscale(100%)"}},null,8,W)):b("",!0)]),o("div",X,[r(u,{type:"submit",severity:"primary"},{default:m(()=>[g(h(c.value?"Actualizar":"Agregar"),1)]),_:1}),c.value?(d(),O(u,{key:0,type:"button",onClick:k,severity:"secondary"},{default:m(()=>e[6]||(e[6]=[g("Cancelar")])),_:1})):b("",!0)])],32),o("div",Y,[f.value.length===0?(d(),p("div",Z,e[7]||(e[7]=[o("p",{class:"text-gray-500 italic"},"No hay itinerarios agregados",-1)]))):b("",!0),(d(!0),p(w,null,R(f.value,(n,x)=>(d(),p("span",{key:x},[o("div",ee,[o("img",{src:n.image,alt:"Image",class:"w-full rounded-lg h-full object-cover"},null,8,te),o("div",ie,[o("span",se,[o("h2",oe,h(n.title),1),o("p",null,h(n.description),1)]),o("div",le,[r(u,{type:"button",onClick:L=>N(x),severity:"warn",icon:"fa-solid fa-pen"},null,8,["onClick"]),r(u,{type:"button",onClick:L=>$(x),severity:"danger",icon:"fa-solid fa-trash"},null,8,["onClick"])])])])]))),128))])]),o("div",ae,[r(u,{type:"button",onClick:F,icon:"fa-solid fa-save",label:"Guardar todo",severity:"primary"})])],64)}}};export{xe as default};
