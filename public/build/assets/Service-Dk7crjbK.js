var p=Object.defineProperty;var g=(s,r,e)=>r in s?p(s,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[r]=e;var n=(s,r,e)=>g(s,typeof r!="symbol"?r+"":r,e);import{y as c,x as h,A as d}from"./app-Bplphqrp.js";import{a as u,g as l}from"./Toats-RcJDUpcK.js";import{s as o}from"./searchStore-C3It-iKz.js";class f{constructor(){n(this,"url",null)}assignMatchingKeys(r,e){Object.keys(r).forEach(t=>{t in e&&(e[t]=r[t])})}submit(r,e=null){return e?c.put(route(this.url+".update",e),r,{onSuccess:()=>{l("Actualizado Exitosamente")},onError:t=>{u(t.response.data.message||"Error al actualizar")}}):c.post(route(this.url+".store"),r,{onSuccess:()=>{l("Guardado Exitosamente")},onError:t=>{u(t.response.data.message||"Error al guardar")}})}delete(r){return c.delete(route(this.url+".destroy",r),{onSuccess:()=>{l("Eliminado Exitosamente")},onError:e=>{u(e.response.data.message||"Error al eliminar")}})}}class x extends f{constructor(e){super();n(this,"loading",!1);n(this,"service",[]);n(this,"portada",null);n(this,"form",h({title:"",description:"",features:[],boys_price:0,adults_price:0,code:"",includes:[],notIncludes:[],type:"TOUR",city:"Cartagena",problematic:0,duration_type:"",destinations:"",duration:0,duration_unit:"Dias",capacidad_min:1,capacidad_max:1}));this.service=e,this.url="services",e&&(this.assignMatchingKeys(e,this.form),this.form.includes=JSON.parse(e.includes),this.form.notIncludes=JSON.parse(e.notIncludes))}async getProveedorsByService(e){const{data:t}=await d.get(route("get.proveedors.by.service",e));return t.proveedors}async getServices(){const{data:e}=await d.get(route("get.all.services"));return e.services}async getServicePagination(e=1,t=10){const a={page:e,location:o.location.value,type:o.type.value.value,checkin:o.checkin.value,checkout:o.checkout.value,guests:o.guests.value,perPage:t},{data:i}=await d.get(route("services.get.paginated"),{params:a});return i}async submit(){var a;let e=this.form.includes,t=this.form.notIncludes;this.form.notIncludes=JSON.stringify(this.form.notIncludes),this.form.includes=JSON.stringify(this.form.includes),super.submit(this.form,((a=this.service)==null?void 0:a.id)??null),this.form.includes=e,this.form.notIncludes=t}async setPortada(){c.post(route("set.portada",this.service.slug),{portada:this.portada},{onSuccess:()=>{l("Portada actualizada exitosamente")},onError:e=>{u("Error al actualizar la portada")}})}formatDate(e){const t=new Date(e),a=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),m=String(t.getDate()).padStart(2,"0");return`${a}-${i}-${m}`}getPrice(){var t;const e=((t=this.service.availabilities.find(a=>this.formatDate(a.start_date)<=this.formatDate(o.checkin.value)&&this.formatDate(a.end_date)>=this.formatDate(o.checkout.value)))==null?void 0:t.precies)??[];return e.length?e.reduce((a,i)=>i.value>a.value?i:a,e[0]).value:0}}export{x as S};
