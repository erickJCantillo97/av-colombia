import{K as N,d as O,u as S,A as b,p as U,B as F,c as R,o as u,w as $,a as e,i as c,t as l,b as r,h as a,f as p,k as B,g as k,V as I,F as A,j as H,n as z}from"./app-Bkmq6IjL.js";import{_ as M}from"./AppLayout-D2egXX6r.js";import{_}from"./Input-DkWzKbaZ.js";import{_ as w}from"./InputError-A-eoirKo.js";import{s as E}from"./index-DaANNUiK.js";import{s as G}from"./index-BRzBSlPy.js";import{b as K}from"./postcss-C08joEDO.js";import{s as L}from"./index-RsaUD5Xe.js";import"./marked.esm-BPgSS2IS.js";import"./Auth-BO5QB7ha.js";import"./index-BDEkOoTf.js";import"./index-CcP_lYt9.js";import"./index-BLqmo2gT.js";import"./index-4OYothAa.js";import"./index-DUCg-gIe.js";import"./index-CKTb4ZjY.js";import"./index-W7nZhAj4.js";import"./index-R9UnX9_e.js";import"./index-Nfd3bcJj.js";import"./index-CfbMPObl.js";import"./index-s9JRI-aI.js";import"./index-DXGaN_yB.js";import"./index-BpetVVTO.js";import"./index-CgfV6IMP.js";import"./index-DXym8dc4.js";import"./index-nj7zxik0.js";import"./index-Dhtgddix.js";import"./index-C7bdtJCW.js";import"./useCommonUtilities-BgDhORlD.js";import"./postcss-DXcLJQ9m.js";const J={class:"h-[90vh] md:h-[99vh] overflow-y-auto"},Q={class:"max-w-4xl mx-auto p-6"},W={class:"bg-white rounded-lg shadow-lg p-6 mb-6"},X={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Y={class:"font-semibold text-lg mb-2"},Z={class:"space-y-2 text-sm text-gray-600"},ee={class:"flex items-center"},se={class:"flex items-center"},te={class:"flex items-center"},ae={class:"h-32 bg-gray-200 rounded"},oe=["src","alt"],le={key:1,class:"w-full h-full bg-gray-300 flex items-center justify-center rounded"},ie={class:"bg-white rounded-lg shadow p-6"},re={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ne={key:0,class:"mt-4 p-3 bg-blue-50 rounded"},de={class:"text-sm text-blue-700"},ue={class:"bg-white rounded-lg shadow p-6"},ce={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},me={class:"bg-white rounded-lg shadow p-6"},pe={key:0,class:"text-center py-8"},fe={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ge=["onClick"],_e={class:"flex justify-between items-start mb-2"},ve={class:"font-semibold"},be={class:"text-sm text-gray-600 mb-3"},he={class:"space-y-1 text-sm"},ye={class:"flex justify-between"},xe={class:"flex justify-between"},ke={class:"flex justify-between font-semibold text-green-600"},we={key:0,class:"border-t pt-2 mt-2"},Ve={class:"flex justify-between font-bold"},je={class:"text-green-600"},Pe={class:"bg-white rounded-lg shadow p-6"},Ce={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ie={class:"bg-white rounded-lg shadow p-6"},Ee={key:0,class:"bg-white rounded-lg shadow p-6 border-l-4 border-green-500"},Te={class:"space-y-2"},qe={class:"flex justify-between"},De={class:"flex justify-between"},Ne={class:"flex justify-between"},Oe={class:"flex justify-between text-lg font-bold text-green-600"},Se={class:"flex justify-between space-x-4"},ms={__name:"Form",props:{accommodation:Object,rooms:Array,searchParams:{type:Object,default:()=>({})}},setup(m){const d=m,h=N(),f=O([]),t=S({accommodation_id:d.accommodation.id,room_id:null,check_in_date:null,check_out_date:null,guests_adults:2,guests_children:0,guest_name:"",guest_email:"",guest_phone:"",guest_document:"",special_requests:"",total_price:0}),T=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}),v=i=>T.format(i),n=b(()=>{if(!t.check_in_date||!t.check_out_date)return 0;const i=new Date(t.check_in_date),o=new Date(t.check_out_date).getTime()-i.getTime();return Math.ceil(o/(1e3*3600*24))}),x=b(()=>parseInt(t.guests_adults)+parseInt(t.guests_children)),g=b(()=>f.value.find(i=>i.id===t.room_id)),V=b(()=>!g.value||n.value<=0?0:g.value.price*n.value),j=b(()=>t.check_in_date&&t.check_out_date&&t.room_id&&t.guest_name&&t.guest_email&&t.guest_phone&&t.guest_document&&n.value>0);U(()=>{d.searchParams.check_in&&(t.check_in_date=new Date(d.searchParams.check_in)),d.searchParams.check_out&&(t.check_out_date=new Date(d.searchParams.check_out)),d.searchParams.adults&&(t.guests_adults=d.searchParams.adults),d.searchParams.children&&(t.guests_children=d.searchParams.children),f.value=d.rooms||[],t.check_in_date&&t.check_out_date&&P()});const P=async()=>{if(!(!t.check_in_date||!t.check_out_date))try{const i=await axios.get(route("api.accommodations.availability",d.accommodation.id),{params:{check_in:t.check_in_date.toISOString().split("T")[0],check_out:t.check_out_date.toISOString().split("T")[0],guests:x.value}});f.value=i.data.available_rooms||[],t.room_id&&!f.value.find(s=>s.id===t.room_id)&&(t.room_id=null)}catch(i){console.error("Error checking availability:",i),h.add({severity:"error",summary:"Error",detail:"Error al verificar disponibilidad",life:3e3})}},y=()=>{setTimeout(()=>{P()},100)},q=i=>{t.room_id=i.id};F(()=>V.value,i=>{t.total_price=i});const D=()=>{if(!j.value){h.add({severity:"warn",summary:"Datos Incompletos",detail:"Por favor completa todos los campos requeridos",life:3e3});return}t.post(route("booking-accommodations.store"),{onSuccess:()=>{h.add({severity:"success",summary:"Reserva Creada",detail:"Tu reserva ha sido confirmada exitosamente",life:5e3})},onError:()=>{h.add({severity:"error",summary:"Error",detail:"Error al crear la reserva. Verifica los datos e intenta nuevamente.",life:3e3})}})};return(i,s)=>(u(),R(M,{title:"Nueva Reserva"},{default:$(()=>[e("div",J,[e("div",Q,[s[31]||(s[31]=e("div",{class:"mb-6"},[e("h1",{class:"text-2xl font-bold mb-2"},"Nueva Reserva"),e("p",{class:"text-gray-600"},"Completa los datos para crear tu reserva")],-1)),e("div",W,[s[14]||(s[14]=e("h2",{class:"text-lg font-semibold mb-4 flex items-center"},[e("i",{class:"fa-solid fa-building mr-2"}),c(" Información del Alojamiento ")],-1)),e("div",X,[e("div",null,[e("h3",Y,l(m.accommodation.name),1),e("div",Z,[e("div",ee,[s[11]||(s[11]=e("i",{class:"fa-solid fa-map-marker-alt mr-2"},null,-1)),c(" "+l(m.accommodation.city)+", "+l(m.accommodation.country),1)]),e("div",se,[s[12]||(s[12]=e("i",{class:"fa-solid fa-tag mr-2"},null,-1)),c(" "+l(m.accommodation.type),1)]),e("div",te,[r(a(G),{"model-value":m.accommodation.star_rating,readonly:"",cancel:!1,class:"text-xs"},null,8,["model-value"])])])]),e("div",ae,[m.accommodation.photos?.[0]?(u(),p("img",{key:0,src:m.accommodation.photos[0].url,alt:m.accommodation.name,class:"w-full h-full object-cover rounded"},null,8,oe)):(u(),p("div",le,[...s[13]||(s[13]=[e("i",{class:"fa-solid fa-image text-gray-500 text-xl"},null,-1)])]))])])]),e("form",{onSubmit:B(D,["prevent"]),class:"space-y-6"},[e("div",ie,[s[18]||(s[18]=e("h3",{class:"text-lg font-semibold mb-4 flex items-center"},[e("i",{class:"fa-solid fa-calendar mr-2"}),c(" Fechas de Estadía ")],-1)),e("div",re,[e("div",null,[s[15]||(s[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Check-in",-1)),r(a(I),{modelValue:a(t).check_in_date,"onUpdate:modelValue":[s[0]||(s[0]=o=>a(t).check_in_date=o),y],"min-date":new Date,teleport:!0,"auto-apply":"","enable-time-picker":!1,timezone:"America/Bogota",placeholder:"Fecha de entrada"},null,8,["modelValue","min-date"]),r(w,{class:"mt-2",message:a(t).errors.check_in_date},null,8,["message"])]),e("div",null,[s[16]||(s[16]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Check-out",-1)),r(a(I),{modelValue:a(t).check_out_date,"onUpdate:modelValue":[s[1]||(s[1]=o=>a(t).check_out_date=o),y],"min-date":a(t).check_in_date||new Date,teleport:!0,"auto-apply":"","enable-time-picker":!1,timezone:"America/Bogota",placeholder:"Fecha de salida"},null,8,["modelValue","min-date"]),r(w,{class:"mt-2",message:a(t).errors.check_out_date},null,8,["message"])])]),n.value>0?(u(),p("div",ne,[e("div",de,[s[17]||(s[17]=e("i",{class:"fa-solid fa-info-circle mr-1"},null,-1)),c(" Estadía de "+l(n.value)+" "+l(n.value===1?"noche":"noches"),1)])])):k("",!0)]),e("div",ue,[s[19]||(s[19]=e("h3",{class:"text-lg font-semibold mb-4 flex items-center"},[e("i",{class:"fa-solid fa-users mr-2"}),c(" Número de Huéspedes ")],-1)),e("div",ce,[r(_,{label:"Adultos",modelValue:a(t).guests_adults,"onUpdate:modelValue":s[2]||(s[2]=o=>a(t).guests_adults=o),type:"number",min:"1",required:"",error:a(t).errors.guests_adults,onInput:y},null,8,["modelValue","error"]),r(_,{label:"Niños",modelValue:a(t).guests_children,"onUpdate:modelValue":s[3]||(s[3]=o=>a(t).guests_children=o),type:"number",min:"0",error:a(t).errors.guests_children,onInput:y},null,8,["modelValue","error"])])]),e("div",me,[s[24]||(s[24]=e("h3",{class:"text-lg font-semibold mb-4 flex items-center"},[e("i",{class:"fa-solid fa-bed mr-2"}),c(" Seleccionar Habitación ")],-1)),f.value.length===0?(u(),p("div",pe,[...s[20]||(s[20]=[e("div",{class:"text-gray-500 mb-2"},[e("i",{class:"fa-solid fa-exclamation-triangle text-2xl"})],-1),e("p",{class:"text-gray-600"},"No hay habitaciones disponibles para las fechas seleccionadas",-1)])])):(u(),p("div",fe,[(u(!0),p(A,null,H(f.value,o=>(u(),p("div",{key:o.id,class:z(["border rounded-lg p-4 cursor-pointer transition-all hover:shadow-md",a(t).room_id===o.id?"border-blue-500 bg-blue-50":"border-gray-200"]),onClick:C=>q(o)},[e("div",_e,[e("h4",ve,l(o.name),1),r(a(K),{modelValue:a(t).room_id,"onUpdate:modelValue":s[4]||(s[4]=C=>a(t).room_id=C),inputId:"room-"+o.id,value:o.id},null,8,["modelValue","inputId","value"])]),e("p",be,l(o.description),1),e("div",he,[e("div",ye,[s[21]||(s[21]=e("span",null,"Capacidad:",-1)),e("span",null,l(o.capacity)+" personas",1)]),e("div",xe,[s[22]||(s[22]=e("span",null,"Tipo:",-1)),e("span",null,l(o.type),1)]),e("div",ke,[s[23]||(s[23]=e("span",null,"Precio por noche:",-1)),e("span",null,l(v(o.price)),1)]),n.value>0&&a(t).room_id===o.id?(u(),p("div",we,[e("div",Ve,[e("span",null,"Total ("+l(n.value)+" "+l(n.value===1?"noche":"noches")+"):",1),e("span",je,l(v(o.price*n.value)),1)])])):k("",!0)])],10,ge))),128))])),r(w,{class:"mt-2",message:a(t).errors.room_id},null,8,["message"])]),e("div",Pe,[s[25]||(s[25]=e("h3",{class:"text-lg font-semibold mb-4 flex items-center"},[e("i",{class:"fa-solid fa-user mr-2"}),c(" Información del Huésped Principal ")],-1)),e("div",Ce,[r(_,{label:"Nombre Completo",modelValue:a(t).guest_name,"onUpdate:modelValue":s[5]||(s[5]=o=>a(t).guest_name=o),required:"",error:a(t).errors.guest_name},null,8,["modelValue","error"]),r(_,{label:"Correo Electrónico",modelValue:a(t).guest_email,"onUpdate:modelValue":s[6]||(s[6]=o=>a(t).guest_email=o),type:"email",required:"",error:a(t).errors.guest_email},null,8,["modelValue","error"]),r(_,{label:"Teléfono",modelValue:a(t).guest_phone,"onUpdate:modelValue":s[7]||(s[7]=o=>a(t).guest_phone=o),type:"tel",required:"",error:a(t).errors.guest_phone},null,8,["modelValue","error"]),r(_,{label:"Documento de Identificación",modelValue:a(t).guest_document,"onUpdate:modelValue":s[8]||(s[8]=o=>a(t).guest_document=o),required:"",error:a(t).errors.guest_document},null,8,["modelValue","error"])])]),e("div",Ie,[s[26]||(s[26]=e("h3",{class:"text-lg font-semibold mb-4 flex items-center"},[e("i",{class:"fa-solid fa-comment mr-2"}),c(" Solicitudes Especiales (Opcional) ")],-1)),r(a(L),{modelValue:a(t).special_requests,"onUpdate:modelValue":s[9]||(s[9]=o=>a(t).special_requests=o),placeholder:"Ej: Habitación en planta baja, cama extra, llegada tardía, etc.",rows:"3",class:"w-full",error:a(t).errors.special_requests},null,8,["modelValue","error"])]),g.value&&n.value>0?(u(),p("div",Ee,[s[30]||(s[30]=e("h3",{class:"text-lg font-semibold mb-4 flex items-center"},[e("i",{class:"fa-solid fa-calculator mr-2"}),c(" Resumen de la Reserva ")],-1)),e("div",Te,[e("div",qe,[e("span",null,l(g.value.name),1),e("span",null,l(v(g.value.price))+" / noche",1)]),e("div",De,[e("span",null,l(n.value)+" "+l(n.value===1?"noche":"noches"),1),e("span",null,l(v(g.value.price*n.value)),1)]),e("div",Ne,[e("span",null,l(x.value)+" "+l(x.value===1?"huésped":"huéspedes"),1),s[27]||(s[27]=e("span",null,"-",-1))]),s[29]||(s[29]=e("hr",null,null,-1)),e("div",Oe,[s[28]||(s[28]=e("span",null,"Total a Pagar:",-1)),e("span",null,l(v(V.value)),1)])])])):k("",!0),e("div",Se,[r(a(E),{onClick:s[10]||(s[10]=o=>i.$inertia.visit(i.route("booking-accommodations.search"))),icon:"fa-solid fa-arrow-left",label:"Volver a Búsqueda",severity:"secondary",type:"button"}),r(a(E),{type:"submit",icon:"fa-solid fa-calendar-check",label:"Confirmar Reserva",loading:a(t).processing,disabled:!j.value},null,8,["loading","disabled"])])],32)])])]),_:1}))}};export{ms as default};
