import{d,C as G,f as p,b as i,w as b,F as w,o as c,a as t,i as S,n as H,t as l,u as f,g as I,k as L,ad as O,T as W}from"./app-ym-dWMPh.js";import{s as q}from"./index-BTtp8UW_.js";import{s as M}from"./index-B5QJNlXa.js";import{_ as J}from"./Datatable-DEJ8lNBU.js";import{_ as K,a as $}from"./Modal-CY4uh8uz.js";import{_ as Q}from"./AppLayout-Cm84XYSd.js";import{a as X}from"./toasts-CuGasqAw.js";import"./index-XgJzv-ij.js";import"./postcss-3G9LjEEj.js";import"./index-DH2w7Cu3.js";import"./index-A2zd0AeM.js";import"./index-DhhVOrzA.js";import"./index-D9tnwjny.js";import"./index-BVd2RH7L.js";import"./index-BYO6yyfS.js";import"./index-Bf4KRM7G.js";import"./index-DdGzmQec.js";import"./index-Dgb-slap.js";import"./index-A5i8Iaev.js";import"./index-vUlJB6Ze.js";import"./index-CEepinY8.js";import"./index-8KZBiN12.js";import"./index-CubOxFnu.js";import"./useCommonUtilities-DO03hYfs.js";import"./moment-Cijl8gKs.js";import"./index-CSwQO6Io.js";import"./index-BG3HncdB.js";import"./index-CAPkyRTh.js";import"./index-BKFUm9Bu.js";const Y={class:"h-[99vh]"},Z={class:"gap-y-2 flex flex-col"},ee={class:"flex flex-col w-full justify-between font-bold"},te={key:0,class:"flex flex-col gap-y-2"},oe={class:"flex justify-between gap-x-4"},ae=["onClick"],le={class:"flex gap-2 divide-x-4 divide-white items-center"},se={class:"p-1"},re={class:"p-1 pl-3"},ne={class:"flex flex-col w-full justify-between font-bold"},de={class:"flex justify-end gap-x-2"},ie={class:"flex flex-col gap-4"},ue={class:"font-medium block mb-2"},pe={class:"flex flex-col gap-y-2 h-64 overflow-auto"},ce={class:"flex items-center gap-x-8 border-b shadow-md justify-between p-3 rounded-md hover:bg-gray-300"},me={class:"flex flex-col"},fe={class:"font-bold flex items-center gap-x-2"},ve={class:"text-xs"},_e={class:"text-xs"},ge={class:"flex flex-col"},he={class:"text-sm"},xe={class:"font-bold"},Ke={__name:"Index",props:{payments:Array},setup(T){const v=d(!1),{toast:N}=X(),D=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}),s=G({date:new Date,startDate:new Date,endDate:new Date,amount:0,proveedor_id:"",file:"",description:""}),C=d([]),m=d([new Date,new Date]),_=d(),V=d([]),n=d(),j={action:()=>{v.value=!0}},A=[{header:"Proveedor",field:"proveedor.nombre",filter:!0},{header:"Fecha de Pago",field:"date",type:"date",filter:!0},{header:"Valor",field:"amount",type:"currency"},{header:"Fecha Inicio",field:"startDate",field:"date",type:"date",filter:!0},{header:"Fecha Fin",field:"endDate",field:"date",type:"date",filter:!0},{header:"Comprobante",field:"comprobante",type:"html-custom",renderer:a=>`<a href="${a}" class="text-sky-600 underline" target="_blank">Ver Comprobante</a>`}],k=()=>{O.get(route("get.booking.time.range"),{params:{start_date:new Date(m.value[0]).toISOString().split("T")[0],end_date:new Date(m.value[1]).toISOString().split("T")[0]}}).then(a=>{C.value=a.data.proveedores,_.value=a.data.bookingTimeRange.filter(e=>{let u=n.value;return e.proveedors.map(x=>x.proveedor_id).includes(u)}),V.value=[{name:"Reservado",value:_.value.filter(e=>e.status=="reservado"),color:"bg-blue-200"},{name:"Completado",value:_.value.filter(e=>e.status=="completado"),color:"bg-green-200"},{name:"Cancelado",value:_.value.filter(e=>e.status=="CANCELADA"),color:"bg-red-200"},{name:"NO SHOW",value:_.value.filter(e=>e.status=="NO SHOW"),color:"bg-yellow-200"}]})},F=d(),h=d([]),U=(a,e)=>{console.log(e),h.value=e,F.value.toggle(a)},R=a=>{var e="";return a.map(u=>{e+=`${u.note} - (${u.user})
`}),e};function B(a){s.file=a.target.files[0]}const z=()=>{let a=new FormData;a.append("proveedor_id",n.value),a.append("amount",s.amount),a.append("comprobante",s.file),a.append("date",new Date(s.date).toISOString().split("T")[0]),a.append("startDate",new Date(m.value[0]).toISOString().split("T")[0]),a.append("endDate",new Date(m.value[1]).toISOString().split("T")[0]),a.append("description",s.description),O.post(route("paymentProveedors.store"),a,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{N("success","Pago Guardado con exito"),v.value=!1})};return(a,e)=>{const u=M,P=q,x=W;return c(),p(w,null,[i(Q,{title:"Pagos"},{default:b(()=>[t("div",Y,[i(J,{add:j,columnas:A,data:T.payments,title:"Pagos"},null,8,["data"])]),i(K,{modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=o=>v.value=o),title:"Añadir Pagos"},{default:b(()=>[t("div",Z,[t("div",ee,[e[6]||(e[6]=t("p",null,"Fechas",-1)),i(u,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=o=>m.value=o),selectionMode:"range",dateFormat:"dd/mm/yy",class:"w-full",manualInput:!1,onValueChange:k},null,8,["modelValue"])]),i($,{label:"Proveedor",type:"dropdown","option-label":"proveedor","option-value":"proveedor_id",onValueChange:k,modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=o=>n.value=o),options:C.value},null,8,["modelValue","options"]),n.value?(c(),p("div",te,[t("div",oe,[(c(!0),p(w,null,S(V.value,o=>(c(),p("div",{class:H([`${o.color} ${o.value.length>0?"cursor-pointer":"hidden"} `,"rounded-lg py-2 border w-full flex flex-col gap-y-1 items-center font-bold cursor-pointer scale-90 hover:scale-100 shadow-sm hover:shadow-lg transition-all duration-300"]),onClick:r=>U(r,o)},[t("h1",null,l(o.name),1),t("div",le,[t("p",se,l(o.value.length)+" Reservas",1),t("p",re,l(o.value.reduce((r,g)=>r+g.adults,0))+" Pasajeros ",1)]),t("p",null,l(f(D).format(o.value.reduce((r,g)=>r+g.proveedors.filter(y=>y.proveedor_id==n.value).reduce((y,E)=>y+E.cost,0),0))),1)],10,ae))),256))]),t("div",ne,[e[7]||(e[7]=t("p",null,"Fecha en que realizó el pago",-1)),i(u,{modelValue:f(s).date,"onUpdate:modelValue":e[2]||(e[2]=o=>f(s).date=o),dateFormat:"dd/mm/yy",class:"w-full",manualInput:!1},null,8,["modelValue"])]),i($,{label:"Valor",type:"number",mode:"currency",modelValue:f(s).amount,"onUpdate:modelValue":e[3]||(e[3]=o=>f(s).amount=o)},null,8,["modelValue"]),t("input",{type:"file",onChange:B,label:"Comprobante"},null,32)])):I("",!0),t("div",de,[t("button",{onClick:e[4]||(e[4]=o=>v.value=!1),class:"bg-red-500 text-white px-4 py-2 rounded-md"}," Cancelar "),n.value?(c(),p("button",{key:0,onClick:z,class:"bg-green-500 text-white px-4 py-2 rounded-md"}," Guardar ")):I("",!0)])])]),_:1},8,["modelValue"])]),_:1}),i(P,{ref_key:"op",ref:F},{default:b(()=>[t("div",ie,[t("div",null,[t("span",ue,l(h.value.name),1),t("div",pe,[(c(!0),p(w,null,S(h.value.value,o=>L((c(),p("div",ce,[t("div",me,[t("span",fe,[t("p",null,l(o.title),1)]),t("span",ve,l(o.cliente_name),1),t("span",_e,l(o.fecha),1)]),t("div",ge,[t("span",he,l(o.adults)+" Pasajeros",1),t("span",xe,l(f(D).format(o.proveedors.filter(r=>r.proveedor_id==n.value).reduce((r,g)=>r+g.cost,0))),1)])])),[[x,R(o.notas)]])),256))])])])]),_:1},512)],64)}}};export{Ke as default};
