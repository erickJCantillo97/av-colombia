import{e3 as N,d as _,o as i,f as a,l as B,b as l,n as U,u,w as v,a as r,F as S,i as E,t as C,g as F,G as A,T as M,C as G,h as Q}from"./app-BqGusQjJ.js";import{s as g,a as D}from"./index-CZ9tHN7S.js";import{_ as L}from"./Datatable-gXbnRjt6.js";import{a as j,_ as $}from"./Modal-BNIDD0Wt.js";import{_ as R}from"./AppLayout-ChV6ImyS.js";import{S as H,a as I}from"./toasts-BN-4G0DO.js";import{s as K}from"./index-C32wM1ut.js";import{s as P}from"./index-BV2jI8Hl.js";import"./index-CuFCSEvK.js";import"./index-D94gs5pH.js";import"./index-DzwVtRvf.js";import"./index-DdkYW1Hy.js";import"./index-CfeX_YS7.js";import"./index-oe_nwnLo.js";import"./index-Cwe7TD8f.js";import"./postcss-BLV8eH8z.js";import"./index-BKPTm-al.js";import"./index-B8wtcoay.js";import"./index-Dv7Iy5AX.js";import"./index-CC8VlOOr.js";import"./useCommonUtilities-DO03hYfs.js";import"./moment-Cijl8gKs.js";import"./index-SGIrc6AZ.js";import"./index-Cl5kOQg7.js";import"./index-CKfsUDV6.js";const q={class:"flex flex-wrap justify-content-between align-items-center flex-1 gap-2"},J={class:"flex gap-2"},O={key:0},W={class:"grid p-0 sm:p-1 gap-3"},X={class:"flex space-x-2 cursor-default"},Y={class:"w-24 h-14 flex items-center justify-center"},Z=["alt","src"],ee={key:1,class:"fa-solid fa-file-pdf text-6xl text-red-600"},te={key:2,class:"fa-regular fa-file-lines text-6xl text-gray-600"},oe={key:3,class:"fa-solid fa-file-excel text-6xl text-green-600"},le={key:4,class:"fa-solid fa-file-word text-6xl text-primary"},se={key:5,class:"fa-solid fa-file text-6xl text-gray-600"},ie={class:"font-semibold text-sm truncate w-[35rem]"},ae={class:"text-xs"},re={key:0,class:"w-full p-1 text-red-600"},ne={class:"max-h-32 overflow-y-auto"},ce={class:"flex space-x-2 items-center"},de={class:"flex items-center space-x-2"},ue={class:""},fe={__name:"CustomUpload",props:{labelButton:{type:String,default:null},iconButton:{type:String,default:"fa-solid fa-cloud-arrow-up"},severity:{type:String,default:"primary"},text:{type:Boolean,default:!1},outlined:{type:Boolean,default:!1},classButton:{type:String,default:""},titleModal:{type:String,default:"Subir archivo"},iconModal:{type:String,default:"fa-solid fa-cloud-arrow-up"},mode:{type:String,default:"basic"},accept:{type:String,default:null},maxFileSize:{type:Number,default:1e9},multiple:{type:Boolean,default:!1},url:{type:String,default:null},tooltip:{type:String,default:null}},setup(d){const x=N(),p=d,y=_(!1),V=(f,c,o)=>{c(o)},z=f=>{f()},k=f=>{const e=["B","KB","MB","GB"];if(f===0)return`0 ${e[0]}`;const m=Math.floor(Math.log(f)/Math.log(1024));return`${parseFloat((f/Math.pow(1024,m)).toFixed(3))} ${e[m]}`},b=_(),t=_(!1),T=f=>{t.value=!0;let c;c=p.multiple?f.files:f.files[0],A.post(p.url,{docs:c},{onSuccess:()=>{x.add({severity:"success",group:"customToast",text:"Archivo subido con exito",life:2e3}),t.value=!1,y.value=!1},onError:o=>{console.log(o),b.value=o,x.add({severity:"error",group:"customToast",text:"Error al guardar",life:2e3}),t.value=!1}})};return(f,c)=>{const o=M;return i(),a(S,null,[B(l(u(g),{class:U(d.classButton),outlined:d.outlined,severity:d.severity,label:d.labelButton,icon:d.iconButton,onClick:c[0]||(c[0]=e=>y.value=!0)},null,8,["class","outlined","severity","label","icon"]),[[o,d.tooltip,void 0,{left:!0}]]),l(j,{visible:y.value,"onUpdate:visible":c[1]||(c[1]=e=>y.value=e),width:"50rem",icon:d.iconModal,title:"Subir archivo"},{default:v(()=>[l(u(K),{mode:d.mode,accept:d.accept,maxFileSize:d.maxFileSize,multiple:d.multiple,customUpload:"",onUploader:T},{header:v(({chooseCallback:e,uploadCallback:m,clearCallback:s,files:n})=>[r("div",q,[r("div",J,[l(u(g),{onClick:h=>{e(),b.value=null},icon:"fa-solid fa-file-import",text:"",label:"Seleccionar"},null,8,["onClick"]),l(u(g),{onClick:h=>z(m),icon:"fa-solid fa-cloud-arrow-up",text:"",label:"Subir",severity:"success",disabled:!n||n.length===0},null,8,["onClick","disabled"]),l(u(g),{onClick:h=>s(),icon:"fa-solid fa-circle-xmark",text:"",severity:"danger",label:"Quitar todos",disabled:!n||n.length===0},null,8,["onClick","disabled"])])])]),content:v(({files:e,removeFileCallback:m})=>[e.length>0?(i(),a("div",O,[r("div",W,[(i(!0),a(S,null,E(e,(s,n)=>(i(),a("div",{key:s.name+s.type+s.size,class:"flex w-full justify-between items-center hover:bg-gray-100 p-1"},[B((i(),a("span",X,[r("span",Y,[s.type.includes("image")?(i(),a("img",{key:0,role:"presentation",alt:s.name,src:s.objectURL},null,8,Z)):s.type.includes("pdf")?(i(),a("i",ee)):s.type=="text/plain"?(i(),a("i",te)):s.type.includes("spreadsheet")||s.type.includes("excel")?(i(),a("i",oe)):s.type.includes("word")?(i(),a("i",le)):(i(),a("i",se))]),r("span",null,[r("p",ie,C(s.name),1),r("p",ae,C(k(s.size)),1),l(u(D),{value:"Pendiente",severity:"warning"})])])),[[o,s.name,void 0,{left:!0}]]),B(l(u(g),{icon:"fa-solid fa-trash-can",onClick:h=>V(s,m,n),text:"",severity:"danger"},null,8,["onClick"]),[[o,"Quitar de la cola",void 0,{rigth:!0}]])]))),128))])])):F("",!0)]),_:1},8,["mode","accept","maxFileSize","multiple"]),b.value?(i(),a("div",re,[c[3]||(c[3]=r("p",{class:"text-center font-bold"},"Hay errores en el archivo",-1)),r("div",ne,[(i(!0),a(S,null,E(b.value,e=>(i(),a("div",ce,[c[2]||(c[2]=r("i",{class:"fa-solid fa-triangle-exclamation"},null,-1)),r("p",null,C(e),1)]))),256))])])):F("",!0)]),_:1},8,["visible","icon"]),l(u(P),{position:"bottom-center",group:"customToast",pt:{content:"!py-1 !items-center !flex !justify-between !px-3 "}},{message:v(e=>[e.message.icon?(i(),a("i",{key:0,class:U(["text-3xl",e.message.icon])},null,2)):(i(),a("i",{key:1,class:U(["text-3xl",e.message.severity=="error"?"fa-solid fa-xmark":e.message.severity=="success"?"fa-solid fa-check":e.message.severity=="info"?"fa-solid fa-circle-info":e.message.severity=="warn"?"fa-solid fa-triangle-exclamation":null])},null,2)),r("div",de,[r("p",ue,C(e.message.text),1)])]),_:1})],64)}}},me={class:"flex gap-x-4 w-full"},pe={key:0,class:"mt-4 w-full col-sapn-1 md:col-span-3 border rounded-lg"},ve={class:"text-2xl font-mono font-semibold text-center bg-black rounded-t-lg text-white gap-x-3 p-2"},xe={class:"flex justify-between gap-x-4 px-2"},ye={class:"flex gap-x-2"},He={__name:"Index",props:{proveedores:Array},setup(d){const{toast:x}=I(),p=_(!1),y={action:()=>{p.value=!0,t.reset()}},V=[{action:o=>{p.value=!0,t.services=o.services.map(e=>e.pivot),t.id=o.id,t.nombre=o.nombre,t.direccion=o.direccion,t.telefono=o.telefono},severity:"info",icon:"fa-solid fa-pencil text-sm"},{action:o=>{H.fire({title:"Eliminar Proveedor",text:"Estas seguro de eliminar este proveedor?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si"}).then(e=>{e.isConfirmed&&t.delete(route("proveedors.destroy",o.id),{onSuccess:()=>{x("error","Proveedor Eliminado")}})})},severity:"danger",icon:"fa-solid fa-trash text-sm"}],z=[{field:"nombre",header:"Nombre",filter:!0},{field:"telefono",header:"Telefono",filter:!0}],k=_([]);(()=>{axios.get(route("get.services")).then(o=>{k.value=o.data.services})})();const t=G({id:null,nombre:"",direccion:"a.",telefono:"",services:[]}),T=()=>{t.services.push({service_id:"",value:""})},f=o=>{t.services.splice(o,1)},c=()=>{t.id?t.put(route("proveedors.update",t.id),{onSuccess:()=>{t.reset(),p.value=!1,x("success","Proveedor Actualizado")}}):t.post(route("proveedors.store"),{onSuccess:()=>{t.reset(),x("success","Proveedor Creado")}})};return(o,e)=>{const m=g,s=M;return i(),a(S,null,[l(R,null,{default:v(()=>[l(fe,{mode:"advanced",titleModal:"Subir Estructura de SAP","icon-button":"fa-solid fa-chart-bar",tooltip:"Subir Estructura",accept:".xlsx,.xls",url:o.route("upload.proveedors")},null,8,["url"]),l(L,{data:d.proveedores,actions:V,columnas:z,add:y,title:"proveedores"},null,8,["data"])]),_:1}),l(j,{visible:p.value,"onUpdate:visible":e[4]||(e[4]=n=>p.value=n),"close-on-escape":"true",title:"AÃ±adir Proveedor"},{footer:v(()=>[r("div",ye,[l(m,{severity:"success",label:"Guardar",onClick:c}),l(m,{severity:"danger",label:"Cancelar",onClick:e[3]||(e[3]=n=>p.value=!1)})])]),default:v(()=>[r("div",me,[l($,{label:"Nombre",class:"w-full",modelValue:u(t).nombre,"onUpdate:modelValue":e[0]||(e[0]=n=>u(t).nombre=n)},null,8,["modelValue"]),l($,{label:"Telefono",class:"w-full",modelValue:u(t).telefono,"onUpdate:modelValue":e[1]||(e[1]=n=>u(t).telefono=n)},null,8,["modelValue"])]),o.$page.props.auth.user.rol=="admin"?(i(),a("div",pe,[r("h1",ve,[e[5]||(e[5]=Q(" Servicios ")),l(m,{icon:"fa-solid fa-plus",outlined:"",severity:"success",class:"size-6",onClick:e[2]||(e[2]=n=>T())})]),e[6]||(e[6]=r("div",{class:"flex justify-between w-full font-bold px-2"},[r("label",{for:""},"Servicio"),r("label",{for:""},"Tarifa"),r("label",{for:""},".")],-1)),(i(!0),a(S,null,E(u(t).services,(n,h)=>(i(),a("div",xe,[l($,{type:"dropdown",modelValue:n.service_id,"onUpdate:modelValue":w=>n.service_id=w,"option-label":"title","option-value":"id",class:"w-full",options:k.value},null,8,["modelValue","onUpdate:modelValue","options"]),l($,{type:"number",mode:"currency",class:"w-full",modelValue:n.value,"onUpdate:modelValue":w=>n.value=w},null,8,["modelValue","onUpdate:modelValue"]),B(l(m,{icon:"fa-solid fa-xmark-circle",class:"w-full",text:"",severity:"danger",onClick:w=>f(h)},null,8,["onClick"]),[[s,"Quitar"]])]))),256))])):F("",!0)]),_:1},8,["visible"])],64)}}};export{He as default};
