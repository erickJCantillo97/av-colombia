import{D as H,E as T,d as a,G as K,q as Q,o as u,f as y,a as o,b as g,w as N,u as A,g as I,F as $,i as M,n as P,t as B,y as U,H as X,I as Y,J as Z,K as ee,W as O,L,c as V,k as F,T as te}from"./app-Zg0QXPRX.js";import{s as se}from"./index-0PAXs0Mz.js";import{s as oe}from"./index-CbxR0hcf.js";import{_ as ae}from"./Datatable-BlsuzwzN.js";import{_ as re}from"./AppLayout-DAZDJeIR.js";import{a as le}from"./toasts-DoW0LeUK.js";import{S as ne}from"./sweetalert2.esm.all-BkU8I-GU.js";import{_ as ie,a as ue}from"./Notas-BGIfomEi.js";import{_ as de}from"./Modal-KNaB6xsd.js";import{_ as ce}from"./Input-BrSXYm2j.js";import{_ as me}from"./logo-C0eP4_ZX.js";import"./index-BNV4NBTB.js";import"./index-CJFPlEPy.js";import"./index-DJN4i4Fo.js";import"./index-CVQZKks4.js";import"./index-BbnmfWXZ.js";import"./index-DHWgaigN.js";import"./index-t-WThdff.js";import"./index-CVlOU12E.js";import"./index-BG5RBYL2.js";import"./index-Id5ZUn2J.js";import"./index-CUlhAHjx.js";import"./index-MxSamq5J.js";import"./index-CL5VNTYA.js";import"./index-BPsYVJbc.js";import"./index-Bxlgpk0U.js";import"./index-D3xsdrpy.js";import"./index-iZ2kBKLV.js";import"./useCommonUtilities-hipAPSUL.js";import"./filepond-plugin-image-preview.min-BG10xqQy.js";import"./postcss-YzgOiR6c.js";import"./index-BEjZmk1Z.js";import"./Loading-bf24Rvey.js";import"./index-6SusQF3I.js";import"./index-Buvf0zCq.js";import"./index-Cnhb0vPe.js";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const fe=()=>{};function ve(_,i,f){let d;H(f)?d={evaluating:f}:d={};const{lazy:C=!1,evaluating:r=void 0,shallow:n=!0,onError:l=fe}=d,h=T(!C),b=n?T(i):a(i);let c=0;return K(async x=>{if(!h.value)return;c++;const k=c;let m=!1;r&&Promise.resolve().then(()=>{r.value=!0});try{const v=await _(D=>{x(()=>{r&&(r.value=!1),m||D()})});k===c&&(b.value=v)}catch(v){l(v)}finally{r&&k===c&&(r.value=!1),m=!0}}),C?Q(()=>(h.value=!0,b.value)):b}const pe={key:0,class:"items-center justify-center flex flex-col"},ge={class:"flex flex-col gap-y-3 h-[60vh] overflow-y-auto"},be={class:"shadow-lg pr-4 rounded-md flex items-center justify-between"},xe={class:"text-xl font-bold"},ye={class:"font-bold text-sm"},_e={__name:"Changes",setup(_){const i=a(!1),f=a(),d=ve(async()=>{var{data:r}=await U.get(route("get.states.change",{date:f.value}));return console.log(r.status),r.status}),C={reservado:"blue","CAMBIO DE FECHA":"gray","NO SHOW":"amber",REUBICADO:"orange",CANCELADA:"green",PROBLEMATICA:"red"};return(r,n)=>(u(),y($,null,[o("span",{onClick:n[0]||(n[0]=l=>i.value=!0),class:"text-xs font-bold text-blue-800 cursor-pointer"},"Listado de Cambios"),g(de,{title:"Historial de Cambios",modelValue:i.value,"onUpdate:modelValue":n[2]||(n[2]=l=>i.value=l),"close-on-escape":""},{default:N(()=>[g(ce,{"max-date":new Date,type:"date",class:"my-2",modelValue:f.value,"onUpdate:modelValue":n[1]||(n[1]=l=>f.value=l),dateFormat:"dd/mm/yy"},null,8,["max-date","modelValue"]),A(d)&&A(d).length==0?(u(),y("div",pe,[g(me),n[3]||(n[3]=o("p",null,"Sin Cambio Registrados",-1))])):I("",!0),o("div",ge,[(u(!0),y($,null,M(A(d),l=>(u(),y("div",be,[o("div",{class:P(["rounded-l-md text-lg font-bold uppercase",`bg-${C[l.state]}-200 p-2`])},B(l.state),3),o("div",null,[o("p",xe,B(l.statable.service),1),o("span",ye,B(l.user.name),1)])]))),256))])]),_:1},8,["modelValue"])],64))}},Ce=X("bookingService",()=>{const _=a([]),i=a(null);return{selectDate:_,statusFilter:i}},{persist:{storage:sessionStorage,paths:["selectDate","statusFilter"]}}),he=[{field:"created_at",header:"Fecha Entrada",filter:!0,sortable:!0,type:"date"},{field:"cliente_name",header:"Nombre del pasajero",filter:!0,sortable:!0},{field:"adults",header:"Pasajeros",filter:!0,sortable:!0},{field:"cliente_building",header:"Edificio u Hotel",filter:!0,sortable:!0},{field:"service",header:"Actividad",filter:!0,sortable:!0},{field:"date",header:"Fecha de la Actividad",filter:!1,type:"date",sortable:!0},{field:"channel.name",header:"Canal de venta",filter:!0,sortable:!0},{field:"proveedors_names",header:"proveedores",class:"text-center font-semibold text-sm",filter:!0},{field:"status",header:"Estado",filter:!0,sortable:!0,type:"tag",filtertype:"EQUALS",class:"text-center uppercase",severitys:[{text:"RESERVADO",severity:"info",class:""},{text:"CAMBIO DE FECHA",class:"bg-gray-200 font-bold"},{text:"COMPLETADA",severity:"success",class:""},{text:"NO SHOW",severity:"warn",class:""},{text:"REUBICADO",severity:"warn",class:""},{text:"CANCELADA",severity:"danger",class:"animate-pulse"},{text:"PROBLEMATICA",severity:"danger",class:"animate-pulse"},{text:"SIN CONFIRMAR",severity:"danger"}]}],Ae={class:"h-[92vh]"},Ee={class:"flex py-2 px-4 justify-between items-center"},we={class:"italic flex flex-col"},ke={class:"flex gap-x-2"},Se=["onClick"],Be={class:"text-xs font-bold uppercase"},$e={class:"w-full justify-between flex"},mt={__name:"Index",props:{bookingServices:Array},setup(_){const i=_;Y(1e3*20);const{toast:f}=le(),d=a([]),C=a([]),r=a(!1),n=a(""),l=a([]),h=a(!1),b=a(null),c=a(!1),x=a(i.bookingServices),k=Ce(),{selectDate:m,statusFilter:v}=Z(k),D=[{text:"RESERVADO",color:"blue"},{text:"CAMBIO DE FECHA",color:"gray"},{text:"NO SHOW",color:"amber"},{text:"REUBICADO",color:"orange"},{text:"CANCELADA",color:"green"},{text:"SIN CONFIRMAR",color:"red"}],j={action:()=>{O.get(route("BookingServices.create"))}},W=async t=>{const{data:e}=await U.get(route("get.all.booking.services.dates",{dates:t}));return e.bookingServices};ee([m,v,r],async([t,e,S])=>{if(S){m.value=[new Date("2024-11-02"),new Date],r.value=!1;return}if(!t[0]||!t[1])x.value=i.bookingServices;else{const w=await W(t);x.value=w}e&&(x.value=x.value.filter(w=>w.status==e))},{immediate:!0});const z=t=>{v.value=t},G=[{label:"Detalles",action:async t=>{b.value=t,h.value=!0,await getProveedors()},icon:"fa-solid fa-circle-info text-sm",severity:"info"},{label:"Editar",action:async t=>{O.get(route("BookingServices.edit",t.id))},icon:"fa-solid fa-pencil text-sm",severity:"warn"},{label:"Notas",severity:"secondary",action:t=>{l.value=t,c.value=!0},badge:t=>t.notes,icon:"fa-solid fa-note-sticky text-sm"},{label:"Eliminar",icon:"fa-solid fa-trash text-sm",severity:"danger",show:L().props.auth.user.rol=="admin"||L().props.auth.user.rol=="superadmin",action:t=>{ne.fire({title:"Estas Seguro?",text:`Eliminar la reservaciÃ³n de ${t.cliente_name}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:"Cancelar",confirmButtonText:"Si, Eliminar!"}).then(e=>{e.isConfirmed&&O.delete(route("BookingServices.destroy",t.id),{onSuccess:()=>{f("success","Reserva Eliminada")}})})}}],E=a([]),q=t=>{E.value=t};return(t,e)=>{const S=oe,w=se,R=te;return u(),y($,null,[g(re,{title:"Reservas"},{default:N(()=>[e[8]||(e[8]=o("div",{class:"hidden bg-amber-200 bg-orange-200 bg-blue-200 !bg-green-200 !bg-gray-200 !bg-orange-200 !bg-amber-200"},null,-1)),o("div",Ae,[o("div",Ee,[o("div",we,[e[6]||(e[6]=o("h1",{class:"text-2xl font-bold"},"Reservas",-1)),g(_e)]),o("div",ke,[F((u(),y("div",{class:"p-2 bg-black text-white text-center rounded-lg cursor-pointer transition-all duration-300 scale-95 hover:scale-100 border-2",onClick:e[0]||(e[0]=s=>v.value=null)},e[7]||(e[7]=[o("p",{class:"text-sm font-bold uppercase"},"Todos",-1)]))),[[R,`${E.value.length} Reservas
                        ${E.value.reduce((s,p)=>s+p.adults,0)} Pasajeros
                        `,void 0,{bottom:!0}]]),(u(),y($,null,M(D,s=>F(o("div",{onClick:p=>z(s.text),class:P(["flex items-center transition-all duration-300 py-1 px-4 rounded-lg cursor-pointer hover:scale-105 hover:border-b-4 hover:border-gray-800",[`bg-${s.color}-200`,A(v)==s.text?"border-b-4 scale-105 shadow-lg border-gray-800":""]])},[o("p",Be,B(s.text),1)],10,Se),[[R,`${E.value.filter(p=>p.status==s.text).length} Reservas
                    ${E.value.filter(p=>p.status==s.text).reduce((p,J)=>p+J.adults,0)} Pasajeros
                    `,void 0,{bottom:!0}]])),64))]),F((u(),V(w,{modelValue:A(m),"onUpdate:modelValue":e[3]||(e[3]=s=>H(m)?m.value=s:null),selectionMode:"range",manualInput:!1},{footer:N(()=>[o("div",$e,[g(S,{onClick:e[1]||(e[1]=s=>m.value=[]),label:"Clear",size:"small",severity:"danger"}),g(S,{onClick:e[2]||(e[2]=s=>r.value=!0),label:"Ver Todos",size:"small",severity:"success"})])]),_:1},8,["modelValue"])),[[R,"Filtrar fecha de Actividad",void 0,{bottom:!0}]])]),g(ae,{actions:G,add:j,showButtonBar:"",columnas:A(he),data:x.value,cacheName:"reservas",rowClass:!0,onFilterApply:q},null,8,["columnas","data"])]),b.value?(u(),V(ue,{key:0,modelValue:h.value,"onUpdate:modelValue":e[4]||(e[4]=s=>h.value=s),service:b.value,proveedors:d.value},null,8,["modelValue","service","proveedors"])):I("",!0)]),_:1}),c.value?(u(),V(ie,{key:0,modelValue:c.value,"onUpdate:modelValue":e[5]||(e[5]=s=>c.value=s),notes:C.value,note:n.value,service:l.value},null,8,["modelValue","notes","note","service"])):I("",!0)],64)}}};export{mt as default};
