import{s as F}from"./index-B_lfAMOA.js";import{d as n,u as P,A as B,p as R,f as w,o as f,a as u,g as V,b as p,c as U,h as g,Z as N,I as S}from"./app-Bkmq6IjL.js";import{a as M}from"./toasts-CAnEIL5D.js";import{_ as y}from"./Input-DkWzKbaZ.js";import h from"./DetailsTypeReserva-DH-abFzD.js";import{b as z}from"./useCommonUtilities-BgDhORlD.js";import"./index-CcP_lYt9.js";import"./index-BLqmo2gT.js";import"./index-BpetVVTO.js";import"./index-Gdm-lMEn.js";import"./index-CB7E2Eg0.js";import"./index-LolpuQTO.js";import"./index-DaANNUiK.js";import"./index-CfbMPObl.js";import"./index-CgfV6IMP.js";import"./index-DXym8dc4.js";import"./index-nj7zxik0.js";import"./index-DUCg-gIe.js";import"./sweetalert2.esm.all-Y6IUEg8t.js";import"./index-W7nZhAj4.js";import"./index-R9UnX9_e.js";import"./index-BDEkOoTf.js";import"./index-Nfd3bcJj.js";import"./index-s9JRI-aI.js";import"./index-DXGaN_yB.js";import"./postcss-C08joEDO.js";import"./postcss-DXcLJQ9m.js";import"./index-Dhtgddix.js";import"./index-RsaUD5Xe.js";import"./index-C7bdtJCW.js";import"./index-DBdH5XrO.js";import"./index-4OYothAa.js";import"./ItemDetailTypeReserva-Ct2p6scU.js";const H={class:"gap-y-2 flex flex-col"},L={class:"flex flex-col md:flex-row gap-x-2 items-center"},j={class:"flex flex-col w-full justify-between font-bold"},$={key:0,class:"flex flex-col gap-y-2"},W={class:"flex flex-col w-full justify-between font-bold"},q={class:"grid grid-cols-1 md:grid-cols-3 gap-x-4"},G={class:"flex justify-end gap-x-2"},Z=["loading"],Ee={__name:"Form",props:{payment:Array},setup(E){const A=n(!1),{toast:_}=M(),l=E,i=t=>{if(t==null||t==null)return"Sin definir";var e=new Date(new Date(t).getTime()+new Date(t).getTimezoneOffset()*6e4);return e},m=n(!1),a=P({date:new Date,startDate:new Date,endDate:new Date,amount:0,proveedor_id:"",file:"",description:""}),x=n([]),d=n([new Date,new Date]),s=n(),C=n([]),r=n(),D=n(null),v=n(0),b=()=>{N.get(route("get.booking.time.range"),{params:{start_date:new Date(d.value[0]).toISOString().split("T")[0],end_date:new Date(d.value[1]).toISOString().split("T")[0]}}).then(t=>{x.value=t.data.proveedores,s.value=t.data.bookingTimeRange.filter(e=>{let c=r.value;return e.proveedors.map(k=>k.proveedor_id).includes(c)}),v.value=z(s.value,r.value),C.value=[{name:"RESERVADO",value:s.value.filter(e=>e.status=="RESERVADO"),color:"bg-blue-200"},{name:"COMPLETADA",value:s.value.filter(e=>e.status=="COMPLETADA"),color:"bg-green-200"},{name:"CANCELADA",value:s.value.filter(e=>e.status=="CANCELADA"),color:"bg-red-200"},{name:"NO SHOW",value:s.value.filter(e=>e.status=="NO SHOW"),color:"bg-yellow-200"},{name:"CAMBIO DE FECHA",value:s.value.filter(e=>e.status=="CAMBIO DE FECHA"),color:"bg-gray-200"},{name:"REUBICADO",value:s.value.filter(e=>e.status=="REUBICADO"),color:"bg-yellow-200"}]})};function T(t){a.file=t.target.files[0]}const I=()=>{m.value=!0;let t=new FormData;if(t.append("proveedor_id",r.value),t.append("amount",a.amount),t.append("comprobante",a.file),t.append("date",new Date(a.date).toISOString().split("T")[0]),t.append("startDate",new Date(d.value[0]).toISOString().split("T")[0]),t.append("endDate",new Date(d.value[1]).toISOString().split("T")[0]),t.append("description",a.description),D.value){S.post(route("paymentProveedors.update",D.value),t,{onSuccess:()=>{_("success","Pago Actualizado con exito"),m.value=!1,A.value=!1}});return}S.post(route("paymentProveedors.store"),t,{onSuccess:()=>{_("success","Pago Actualizado con exito"),m.value=!1,A.value=!1}})},O=B(()=>v.value-a.amount);return R(()=>{l.payment&&(D.value=l.payment.id,a.date=i(l.payment.date),a.startDate=i(l.payment.startDate),a.endDate=i(l.payment.endDate),a.amount=l.payment.amount,a.proveedor_id=l.payment.proveedor_id,a.description=l.payment.description,d.value=[i(l.payment.startDate),i(l.payment.endDate)],r.value=l.payment.proveedor_id,b())}),(t,e)=>{const c=F;return f(),w("div",H,[u("div",L,[u("div",j,[e[6]||(e[6]=u("p",null,"Fechas",-1)),p(c,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=o=>d.value=o),selectionMode:"range",dateFormat:"dd/mm/yy",class:"w-full h-9",manualInput:!1,onValueChange:b},null,8,["modelValue"])]),p(y,{label:"Proveedor",type:"dropdown","option-label":"proveedor","option-value":"proveedor_id",onValueChange:b,class:"w-full",modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=o=>r.value=o),options:x.value},null,8,["modelValue","options"])]),r.value?(f(),w("div",$,[r.value?(f(),U(h,{key:0,reservasType:C.value,proveedor:r.value},null,8,["reservasType","proveedor"])):V("",!0),u("div",W,[e[7]||(e[7]=u("p",null,"Fecha en que realizÃ³ el pago",-1)),p(c,{modelValue:g(a).date,"onUpdate:modelValue":e[2]||(e[2]=o=>g(a).date=o),dateFormat:"dd/mm/yy",class:"w-full",manualInput:!1},null,8,["modelValue"])]),u("div",q,[p(y,{label:"Valor Pagado",type:"number",mode:"currency",modelValue:g(a).amount,"onUpdate:modelValue":e[3]||(e[3]=o=>g(a).amount=o)},null,8,["modelValue"]),p(y,{label:"Valor Total",type:"number",mode:"currency",modelValue:v.value,"onUpdate:modelValue":e[4]||(e[4]=o=>v.value=o),disabled:""},null,8,["modelValue"]),p(y,{label:"Diferencia",type:"number",mode:"currency",modelValue:O.value,"onUpdate:modelValue":e[5]||(e[5]=o=>O.value=o),disabled:""},null,8,["modelValue"])]),u("input",{type:"file",onChange:T,label:"Comprobante"},null,32)])):V("",!0),u("div",G,[t.$page.props.auth.user.rol=="superadmin"&&r.value?(f(),w("button",{key:0,loading:m.value,onClick:I,class:"bg-green-500 text-white px-4 py-2 rounded-md"}," Guardar ",8,Z)):V("",!0)])])}}};export{Ee as default};
