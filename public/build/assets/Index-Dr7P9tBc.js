import{d as n,C as H,f as p,b as i,w,F as D,o as c,a as t,i as I,n as L,t as l,u as f,g as O,k as W,A as $,T as q}from"./app-CtJqsG5v.js";import{s as M}from"./index-DLkb7AI7.js";import{s as J}from"./index-Bwnfh1um.js";import{_ as K}from"./Datatable-DL_mlJtE.js";import{a as Q,_ as T}from"./Modal-bmnaDNl-.js";import{_ as X}from"./AppLayout-CCJrJ-Kl.js";import{a as Y}from"./toasts-CuGasqAw.js";import"./index-D83ctD_5.js";import"./postcss-BWZ3lZs1.js";import"./index-DpA8bSet.js";import"./index-Bt9xIGjQ.js";import"./index-07jWboTj.js";import"./index-CqtNljuW.js";import"./index-zHN38yKc.js";import"./index-_uuo_Nbr.js";import"./index-D1hOtb9X.js";import"./index-Dd5c4k6G.js";import"./index-C6cTDUfp.js";import"./index-DgfmmUrt.js";import"./index-D6EXJ729.js";import"./index-DC2aYbnr.js";import"./index-KCh0ZGNa.js";import"./index-C9kEDa2v.js";import"./useCommonUtilities-DO03hYfs.js";import"./moment-Cijl8gKs.js";import"./index-DTJ9gs6S.js";import"./index-C0w561NQ.js";import"./index-8gfGUM7H.js";import"./index-CGth6ASS.js";const Z={class:"h-[99vh]"},ee={class:"gap-y-2 flex flex-col"},te={class:"flex flex-col w-full justify-between font-bold"},oe={key:0,class:"flex flex-col gap-y-2"},ae={class:"flex justify-between gap-x-4"},le=["onClick"],se={class:"flex gap-2 divide-x-4 divide-white items-center"},re={class:"p-1"},ne={class:"p-1 pl-3"},de={class:"flex flex-col w-full justify-between font-bold"},ie={class:"flex justify-end gap-x-2"},ue=["loading"],pe={class:"flex flex-col gap-4"},ce={class:"font-medium block mb-2"},me={class:"flex flex-col gap-y-2 h-64 overflow-auto"},fe={class:"flex items-center gap-x-8 border-b shadow-md justify-between p-3 rounded-md hover:bg-gray-300"},ve={class:"flex flex-col"},_e={class:"font-bold flex items-center gap-x-2"},ge={class:"text-xs"},he={class:"text-xs"},xe={class:"flex flex-col"},ye={class:"text-sm"},be={class:"font-bold"},Xe={__name:"Index",props:{payments:Array},setup(N){const v=n(!1),{toast:j}=Y(),C=new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP",maximumFractionDigits:0}),h=n(!1),s=H({date:new Date,startDate:new Date,endDate:new Date,amount:0,proveedor_id:"",file:"",description:""}),V=n([]),m=n([new Date,new Date]),_=n(),k=n([]),d=n(),A={action:()=>{v.value=!0}},U=[{header:"Proveedor",field:"proveedor.nombre",filter:!0},{header:"Fecha de Pago",field:"date",type:"date",filter:!0},{header:"Valor",field:"amount",type:"currency"},{header:"Fecha Inicio",field:"startDate",field:"date",type:"date",filter:!0},{header:"Fecha Fin",field:"endDate",field:"date",type:"date",filter:!0},{header:"Comprobante",field:"comprobante",type:"html-custom",renderer:a=>(console.log(a),`<a href="${a.comprobante}" class="text-sky-600 underline" target="_blank">Ver Comprobante</a>`)}],F=()=>{$.get(route("get.booking.time.range"),{params:{start_date:new Date(m.value[0]).toISOString().split("T")[0],end_date:new Date(m.value[1]).toISOString().split("T")[0]}}).then(a=>{V.value=a.data.proveedores,_.value=a.data.bookingTimeRange.filter(e=>{let u=d.value;return e.proveedors.map(y=>y.proveedor_id).includes(u)}),k.value=[{name:"Reservado",value:_.value.filter(e=>e.status=="reservado"),color:"bg-blue-200"},{name:"Completado",value:_.value.filter(e=>e.status=="completado"),color:"bg-green-200"},{name:"Cancelado",value:_.value.filter(e=>e.status=="CANCELADA"),color:"bg-red-200"},{name:"NO SHOW",value:_.value.filter(e=>e.status=="NO SHOW"),color:"bg-yellow-200"}]})},P=n(),x=n([]),R=(a,e)=>{console.log(e),x.value=e,P.value.toggle(a)},B=a=>{var e="";return a.map(u=>{e+=`${u.note} - (${u.user})
`}),e};function z(a){s.file=a.target.files[0]}const E=()=>{h.value=!0;let a=new FormData;a.append("proveedor_id",d.value),a.append("amount",s.amount),a.append("comprobante",s.file),a.append("date",new Date(s.date).toISOString().split("T")[0]),a.append("startDate",new Date(m.value[0]).toISOString().split("T")[0]),a.append("endDate",new Date(m.value[1]).toISOString().split("T")[0]),a.append("description",s.description),$.post(route("paymentProveedors.store"),a,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{j("success","Pago Guardado con exito"),h.value=!1,v.value=!1})};return(a,e)=>{const u=J,S=M,y=q;return c(),p(D,null,[i(X,{title:"Pagos"},{default:w(()=>[t("div",Z,[i(K,{add:A,columnas:U,data:N.payments,title:"Pagos"},null,8,["data"])]),i(Q,{modelValue:v.value,"onUpdate:modelValue":e[5]||(e[5]=o=>v.value=o),title:"Añadir Pagos"},{default:w(()=>[t("div",ee,[t("div",te,[e[6]||(e[6]=t("p",null,"Fechas",-1)),i(u,{modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=o=>m.value=o),selectionMode:"range",dateFormat:"dd/mm/yy",class:"w-full",manualInput:!1,onValueChange:F},null,8,["modelValue"])]),i(T,{label:"Proveedor",type:"dropdown","option-label":"proveedor","option-value":"proveedor_id",onValueChange:F,modelValue:d.value,"onUpdate:modelValue":e[1]||(e[1]=o=>d.value=o),options:V.value},null,8,["modelValue","options"]),d.value?(c(),p("div",oe,[t("div",ae,[(c(!0),p(D,null,I(k.value,o=>(c(),p("div",{class:L([`${o.color} ${o.value.length>0?"cursor-pointer":"hidden"} `,"rounded-lg py-2 border w-full flex flex-col gap-y-1 items-center font-bold cursor-pointer scale-90 hover:scale-100 shadow-sm hover:shadow-lg transition-all duration-300"]),onClick:r=>R(r,o)},[t("h1",null,l(o.name),1),t("div",se,[t("p",re,l(o.value.length)+" Reservas",1),t("p",ne,l(o.value.reduce((r,g)=>r+g.adults,0))+" Pasajeros ",1)]),t("p",null,l(f(C).format(o.value.reduce((r,g)=>r+g.proveedors.filter(b=>b.proveedor_id==d.value).reduce((b,G)=>b+G.cost,0),0))),1)],10,le))),256))]),t("div",de,[e[7]||(e[7]=t("p",null,"Fecha en que realizó el pago",-1)),i(u,{modelValue:f(s).date,"onUpdate:modelValue":e[2]||(e[2]=o=>f(s).date=o),dateFormat:"dd/mm/yy",class:"w-full",manualInput:!1},null,8,["modelValue"])]),i(T,{label:"Valor",type:"number",mode:"currency",modelValue:f(s).amount,"onUpdate:modelValue":e[3]||(e[3]=o=>f(s).amount=o)},null,8,["modelValue"]),t("input",{type:"file",onChange:z,label:"Comprobante"},null,32)])):O("",!0),t("div",ie,[t("button",{onClick:e[4]||(e[4]=o=>v.value=!1),class:"bg-red-500 text-white px-4 py-2 rounded-md"}," Cancelar "),d.value?(c(),p("button",{key:0,loading:h.value,onClick:E,class:"bg-green-500 text-white px-4 py-2 rounded-md"}," Guardar ",8,ue)):O("",!0)])])]),_:1},8,["modelValue"])]),_:1}),i(S,{ref_key:"op",ref:P},{default:w(()=>[t("div",pe,[t("div",null,[t("span",ce,l(x.value.name),1),t("div",me,[(c(!0),p(D,null,I(x.value.value,o=>W((c(),p("div",fe,[t("div",ve,[t("span",_e,[t("p",null,l(o.title),1)]),t("span",ge,l(o.cliente_name),1),t("span",he,l(o.fecha),1)]),t("div",xe,[t("span",ye,l(o.adults)+" Pasajeros",1),t("span",be,l(f(C).format(o.proveedors.filter(r=>r.proveedor_id==d.value).reduce((r,g)=>r+g.cost,0))),1)])])),[[y,B(o.notas)]])),256))])])])]),_:1},512)],64)}}};export{Xe as default};
