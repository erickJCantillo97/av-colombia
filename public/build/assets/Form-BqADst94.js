import{s as z}from"./index-Cm0bPytr.js";import{d as r,u as j,A as D,p as G,f as w,o as _,a as t,g as E,b as m,i as d,w as C,h as g,n as V,t as h,a0 as H,I as F}from"./app-BdstN28M.js";import{a as L}from"./toasts-CAnEIL5D.js";import{_ as A}from"./Input-BhEUnXfW.js";import $ from"./DetailsTypeReserva-NKtiZlZO.js";import{b as W}from"./useCommonUtilities-BgDhORlD.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-C9oeJx5C.js";import"./index-C9zAFRHi.js";import"./index-Bd_NKlS6.js";import"./index-Deuplzer.js";import"./index-CHGAFxkY.js";import"./index-CCdL8HIU.js";import"./index-n2-C6oSV.js";import"./index-CrrPkwrL.js";import"./index-D9MjH5ib.js";import"./index-D_dnNmX7.js";import"./index--0X7aZFL.js";import"./index-BlJbXZlF.js";import"./sweetalert2.esm.all-Y6IUEg8t.js";import"./index-CBj6VjRi.js";import"./index-xCqSnNia.js";import"./index-CM-gVynX.js";import"./index-DD8vdyn5.js";import"./index-B4sT1Gnr.js";import"./index-DRXr_N5d.js";import"./index-BXecLyWt.js";import"./index-BYnVgJjF.js";import"./index-D83TtICs.js";import"./index-e5_OWN5-.js";import"./postcss-DSwjbrNh.js";import"./postcss-BahFiIAq.js";import"./index-BsMRhQdx.js";import"./index-jOj3Frc8.js";import"./ItemDetailTypeReserva-DghJgWmp.js";const J={class:"space-y-6"},K={class:"bg-gradient-to-br from-slate-50 to-blue-50 rounded-xl p-6 border border-slate-200 shadow-sm"},Q={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},X={class:"flex flex-col"},Y={key:0,class:"space-y-6 animate-fade-in"},Z={class:"bg-white rounded-xl p-6 border border-slate-200 shadow-sm"},ee={class:"mb-6"},te={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},ae={class:"relative"},oe={class:"relative"},le={class:"relative"},se={class:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-2"},re={class:"mt-6"},ne={class:"relative"},ie={for:"file-upload",class:"flex items-center justify-center gap-3 w-full px-6 py-4 border-2 border-dashed border-slate-300 rounded-xl cursor-pointer hover:border-indigo-500 hover:bg-indigo-50 transition-all duration-300 group"},de={class:"text-center"},ue={class:"text-sm font-semibold text-slate-600 group-hover:text-indigo-600"},pe={class:"flex justify-end gap-3 pt-4 border-t border-slate-200"},me=["disabled"],ce={class:"flex items-center gap-2"},fe={__name:"Form",props:{payment:Array},setup(k){const S=r(!1),{toast:O}=L(),l=k,c=a=>{if(a==null||a==null)return"Sin definir";var e=new Date(new Date(a).getTime()+new Date(a).getTimezoneOffset()*6e4);return e},p=r(!1),o=j({date:new Date,startDate:new Date,endDate:new Date,amount:0,proveedor_id:"",file:"",description:""}),P=r([]),u=r([new Date,new Date]),i=r(),I=r([]),n=r(),b=r(null),f=r(0),x=()=>{H.get(route("get.booking.time.range"),{params:{start_date:new Date(u.value[0]).toISOString().split("T")[0],end_date:new Date(u.value[1]).toISOString().split("T")[0]}}).then(a=>{P.value=a.data.proveedores,i.value=a.data.bookingTimeRange.filter(e=>{let v=n.value;return e.proveedors.map(U=>U.proveedor_id).includes(v)}),f.value=W(i.value,n.value),I.value=[{name:"RESERVADO",value:i.value.filter(e=>e.status=="RESERVADO"),color:"bg-blue-200"},{name:"COMPLETADA",value:i.value.filter(e=>e.status=="COMPLETADA"),color:"bg-green-200"},{name:"CANCELADA",value:i.value.filter(e=>e.status=="CANCELADA"),color:"bg-red-200"},{name:"NO SHOW",value:i.value.filter(e=>e.status=="NO SHOW"),color:"bg-yellow-200"},{name:"CAMBIO DE FECHA",value:i.value.filter(e=>e.status=="CAMBIO DE FECHA"),color:"bg-gray-200"},{name:"REUBICADO",value:i.value.filter(e=>e.status=="REUBICADO"),color:"bg-yellow-200"}]})},N=()=>{p.value=!0;let a=new FormData;if(a.append("proveedor_id",n.value),a.append("amount",o.amount),a.append("comprobante",o.file),a.append("date",new Date(o.date).toISOString().split("T")[0]),a.append("startDate",new Date(u.value[0]).toISOString().split("T")[0]),a.append("endDate",new Date(u.value[1]).toISOString().split("T")[0]),a.append("description",o.description),b.value){F.post(route("paymentProveedors.update",b.value),a,{onSuccess:()=>{O("success","Pago Actualizado con exito"),p.value=!1,S.value=!1}});return}F.post(route("paymentProveedors.store"),a,{onSuccess:()=>{O("success","Pago Actualizado con exito"),p.value=!1,S.value=!1}})},y=D(()=>f.value-o.amount),R=D(()=>{const a=y.value;return a>0?"bg-red-50 border-red-300 text-red-700":a<0?"bg-green-50 border-green-300 text-green-700":"bg-slate-50 border-slate-300 text-slate-700"}),B=D(()=>{const a=y.value;return a>0?"text-red-500":a<0?"text-green-500":"text-slate-500"}),T=r("");function M(a){o.file=a.target.files[0],T.value=a.target.files[0]?.name||""}return G(()=>{l.payment&&(b.value=l.payment.id,o.date=c(l.payment.date),o.startDate=c(l.payment.startDate),o.endDate=c(l.payment.endDate),o.amount=l.payment.amount,o.proveedor_id=l.payment.proveedor_id,o.description=l.payment.description,u.value=[c(l.payment.startDate),c(l.payment.endDate)],n.value=l.payment.proveedor_id,x())}),(a,e)=>{const v=z;return _(),w("div",J,[t("div",K,[e[7]||(e[7]=t("div",{class:"flex items-center gap-2 mb-4"},[t("div",{class:"p-2 bg-blue-500 rounded-lg"},[t("i",{class:"fa-solid fa-filter text-white text-sm"})]),t("h3",{class:"text-lg font-bold text-slate-800"},"Filtros de Búsqueda")],-1)),t("div",Q,[t("div",X,[e[5]||(e[5]=t("label",{class:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-2"},[t("i",{class:"fa-solid fa-calendar-range text-blue-500"}),d(" Rango de Fechas ")],-1)),m(v,{modelValue:u.value,"onUpdate:modelValue":[e[0]||(e[0]=s=>u.value=s),x],selectionMode:"range",dateFormat:"dd/mm/yy",class:"w-full custom-datepicker",manualInput:!1,placeholder:"Seleccionar fechas..."},null,8,["modelValue"])]),m(A,{label:"Proveedor",type:"dropdown","option-label":"proveedor","option-value":"proveedor_id",onValueChange:x,class:"w-full",modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=s=>n.value=s),options:P.value,placeholder:"Seleccionar proveedor..."},{label:C(()=>[...e[6]||(e[6]=[t("label",{class:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-2"},[t("i",{class:"fa-solid fa-truck text-blue-500"}),d(" Proveedor ")],-1)])]),_:1},8,["modelValue","options"])])]),n.value?(_(),w("div",Y,[m($,{reservasType:I.value,proveedor:n.value},null,8,["reservasType","proveedor"]),t("div",Z,[e[15]||(e[15]=t("div",{class:"flex items-center gap-2 mb-6"},[t("div",{class:"p-2 bg-green-500 rounded-lg"},[t("i",{class:"fa-solid fa-money-bill-wave text-white text-sm"})]),t("h3",{class:"text-lg font-bold text-slate-800"},"Información del Pago")],-1)),t("div",ee,[e[8]||(e[8]=t("label",{class:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-2"},[t("i",{class:"fa-solid fa-calendar-check text-green-500"}),d(" Fecha de Realización del Pago ")],-1)),m(v,{modelValue:g(o).date,"onUpdate:modelValue":e[2]||(e[2]=s=>g(o).date=s),dateFormat:"dd/mm/yy",class:"w-full custom-datepicker",manualInput:!1,placeholder:"Seleccionar fecha..."},null,8,["modelValue"])]),t("div",te,[t("div",ae,[m(A,{label:"Valor Pagado",type:"number",mode:"currency",modelValue:g(o).amount,"onUpdate:modelValue":e[3]||(e[3]=s=>g(o).amount=s)},{label:C(()=>[...e[9]||(e[9]=[t("label",{class:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-2"},[t("i",{class:"fa-solid fa-hand-holding-dollar text-blue-500"}),d(" Valor Pagado ")],-1)])]),_:1},8,["modelValue"])]),t("div",oe,[m(A,{label:"Valor Total",type:"number",mode:"currency",modelValue:f.value,"onUpdate:modelValue":e[4]||(e[4]=s=>f.value=s),disabled:""},{label:C(()=>[...e[10]||(e[10]=[t("label",{class:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-2"},[t("i",{class:"fa-solid fa-calculator text-slate-500"}),d(" Valor Total ")],-1)])]),_:1},8,["modelValue"])]),t("div",le,[t("label",se,[t("i",{class:V(["fa-solid fa-scale-balanced",B.value])},null,2),e[11]||(e[11]=d(" Diferencia ",-1))]),t("div",{class:V(["w-full px-4 py-3 rounded-lg border-2 font-bold text-lg transition-all duration-300",R.value])},h(new Intl.NumberFormat("es-CO",{style:"currency",currency:"COP"}).format(y.value)),3)])]),t("div",re,[e[14]||(e[14]=t("label",{class:"flex items-center gap-2 text-sm font-semibold text-slate-700 mb-3"},[t("i",{class:"fa-solid fa-file-invoice text-indigo-500"}),d(" Comprobante de Pago ")],-1)),t("div",ne,[t("input",{type:"file",onChange:M,id:"file-upload",class:"hidden",accept:".pdf,.jpg,.jpeg,.png"},null,32),t("label",ie,[t("div",de,[e[12]||(e[12]=t("i",{class:"fa-solid fa-cloud-arrow-up text-3xl text-slate-400 group-hover:text-indigo-500 transition-colors mb-2"},null,-1)),t("p",ue,h(T.value||"Click para seleccionar archivo"),1),e[13]||(e[13]=t("p",{class:"text-xs text-slate-500 mt-1"},"PDF, JPG, PNG (Max. 10MB)",-1))])])])])])])):E("",!0),t("div",pe,[a.$page.props.auth.user.rol=="superadmin"&&n.value?(_(),w("button",{key:0,onClick:N,disabled:p.value,class:"group relative px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none"},[t("span",ce,[t("i",{class:V(["fa-solid",p.value?"fa-spinner fa-spin":"fa-save"])},null,2),d(" "+h(p.value?"Guardando...":"Guardar Pago"),1)]),e[16]||(e[16]=t("div",{class:"absolute inset-0 bg-white/20 rounded-xl opacity-0 group-hover:opacity-100 transition-opacity duration-300"},null,-1))],8,me)):E("",!0)])])}}},Qe=q(fe,[["__scopeId","data-v-156662ea"]]);export{Qe as default};
